{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/handling.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/assistant/chatStream.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/http.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/fetch.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/index.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/retries.js","webpack://excel-custom-functions-js/../../../node_modules/process/browser.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/config.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/normalizeUrl.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/request.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/base.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/debugLog.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/environment.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/index.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/convertKeys.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/utils.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/user-agent.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/utils/queryParamsStringify.js","webpack://excel-custom-functions-js/../../../node_modules/@pinecone-database/pinecone/dist/errors/validation.js","webpack://excel-custom-functions-js/webpack/bootstrap","webpack://excel-custom-functions-js/webpack/runtime/global","webpack://excel-custom-functions-js/webpack/runtime/hasOwnProperty shorthand","webpack://excel-custom-functions-js/webpack/runtime/publicPath","webpack://excel-custom-functions-js/webpack/runtime/jsonp chunk loading","webpack://excel-custom-functions-js/./src/taskpane/Validation.js","webpack://excel-custom-functions-js/./src/taskpane/CodeCollection.js","webpack://excel-custom-functions-js/./src/taskpane/IndexWorksheet.js","webpack://excel-custom-functions-js/./src/taskpane/AIcalls.js","webpack://excel-custom-functions-js/./src/taskpane/taskpane.js","webpack://excel-custom-functions-js/./src/taskpane/taskpane.html"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.handleApiError = void 0;\nconst utils_1 = require(\"./utils\");\nconst http_1 = require(\"./http\");\nconst request_1 = require(\"./request\");\n/** @internal */\nconst handleApiError = async (e, customMessage, url) => {\n    if (e instanceof Error && e.name === 'ResponseError') {\n        const responseError = e;\n        const rawMessage = await (0, utils_1.extractMessage)(responseError);\n        const statusCode = responseError.response.status;\n        const message = customMessage\n            ? await customMessage(statusCode, rawMessage)\n            : rawMessage;\n        return (0, http_1.mapHttpStatusError)({\n            status: responseError.response.status,\n            url: responseError.response.url || url,\n            message: message,\n        });\n    }\n    else if (e instanceof request_1.PineconeConnectionError) {\n        // If we've already wrapped this error, just return it\n        return e;\n    }\n    else {\n        // There seem to be some situations where \"e instanceof Error\" is erroneously\n        // false (perhaps the custom errors emitted by cross-fetch do not extend Error?)\n        // but we can still cast it to an Error type because all we're going to do\n        // with it is store off a reference to whatever it is under the \"cause\"\n        const err = e;\n        return new request_1.PineconeConnectionError(err);\n    }\n};\nexports.handleApiError = handleApiError;\n//# sourceMappingURL=handling.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChatStream = void 0;\nconst convertKeys_1 = require(\"../utils/convertKeys\");\n/**\n * Implements an async iterable that processes the readable stream of an assistant chat response.\n *\n * This class expects each chunk of data in the stream to begin with `data:` and be followed by a valid chunk of JSON.\n * If a chunk contains malformed JSON, it is skipped, and a debug message is logged.\n *\n * @template Item - The type of items yielded by the iterable.\n */\nclass ChatStream {\n    constructor(stream) {\n        this.stream = stream;\n    }\n    async *[Symbol.asyncIterator]() {\n        let buffer = '';\n        for await (const chunk of this.stream) {\n            buffer += chunk.toString();\n            let newlineIndex;\n            while ((newlineIndex = buffer.indexOf('\\n')) !== -1) {\n                const line = buffer.slice(0, newlineIndex).trim();\n                buffer = buffer.slice(newlineIndex + 1);\n                // each chunk of json should begin with 'data:'\n                if (line && line.startsWith('data:')) {\n                    const json = line.slice(5).trim();\n                    try {\n                        const parsedJson = JSON.parse(json);\n                        const convertedJson = (0, convertKeys_1.convertKeysToCamelCase)(parsedJson);\n                        yield convertedJson;\n                    }\n                    catch (err) {\n                        console.debug(`Skipping malformed JSON:${line}`);\n                        continue;\n                    }\n                }\n            }\n        }\n        if (buffer.trim()) {\n            try {\n                const parsedJson = JSON.parse(buffer);\n                const convertedJson = (0, convertKeys_1.convertKeysToCamelCase)(parsedJson);\n                yield convertedJson;\n            }\n            catch (err) {\n                console.debug(`Skipping malformed JSON:${buffer}`);\n            }\n        }\n    }\n}\nexports.ChatStream = ChatStream;\n//# sourceMappingURL=chatStream.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.mapHttpStatusError = exports.PineconeUnmappedHttpError = exports.PineconeNotImplementedError = exports.PineconeUnavailableError = exports.PineconeMaxRetriesExceededError = exports.PineconeInternalServerError = exports.PineconeConflictError = exports.PineconeNotFoundError = exports.PineconeAuthorizationError = exports.PineconeBadRequestError = void 0;\nconst base_1 = require(\"./base\");\nconst CONFIG_HELP = `You can find the configuration values for your project in the Pinecone developer console at https://app.pinecone.io`;\n/** This error is thrown when API requests return with status 400. Typically this is due to some aspect of the request being incorrect or invalid.\n *\n * Some examples when this error could occur:\n * - While attempting to create an index with no available quota in your project.\n * - While upserting records that do not match the `dimension` of your index\n * - While attempting to create an index using an invalid name (\"!@#$%\")\n */\nclass PineconeBadRequestError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { message } = failedRequest;\n        super(message);\n        this.name = 'PineconeBadRequestError';\n    }\n}\nexports.PineconeBadRequestError = PineconeBadRequestError;\n/**\n * This error occurs when API requests are attempted using invalid configurations such as a mispelled or revoked API key.\n *\n * Log in to https://app.pinecone.io to verify you have configured the { @link Pinecone }\n * client using the correct values.\n */\nclass PineconeAuthorizationError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url } = failedRequest;\n        if (url) {\n            super(`The API key you provided was rejected while calling ${url}. Please check your configuration values and try again. ${CONFIG_HELP}`);\n        }\n        else {\n            super(`The API key you provided was rejected. Please check your configuration values and try again. ${CONFIG_HELP}`);\n        }\n        this.name = 'PineconeAuthorizationError';\n    }\n}\nexports.PineconeAuthorizationError = PineconeAuthorizationError;\n/**\n * This error is thrown when interacting with a resource such as an index or collection\n * that cannot be found.\n */\nclass PineconeNotFoundError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url } = failedRequest;\n        if (url) {\n            super(`A call to ${url} returned HTTP status 404.`);\n        }\n        else {\n            super('The requested resource could not be found.');\n        }\n        this.name = 'PineconeNotFoundError';\n    }\n}\nexports.PineconeNotFoundError = PineconeNotFoundError;\n/**\n * This error is thrown when attempting to create a resource such as an index or\n * collection with a name that is already in use.\n * */\nclass PineconeConflictError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url, message } = failedRequest;\n        if (url) {\n            super(`A call to ${url} returned HTTP status 409. ${message ? message : ''}`);\n        }\n        else {\n            super('The resource you are attempting to create already exists.');\n        }\n        this.name = 'PineconeConflictError';\n    }\n}\nexports.PineconeConflictError = PineconeConflictError;\n/**\n * This error indicates API responses are returning with status 500 and\n * something is wrong with Pinecone. Check the [status page](https://status.pinecone.io/)\n * for information about current or recent outages.\n *\n * @see [Pinecone's status page](https://status.pinecone.io/)\n */\nclass PineconeInternalServerError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url, body, status } = failedRequest;\n        const intro = url\n            ? `An internal server error occurred while calling the ${url} endpoint.`\n            : '';\n        const help = `To see overall service health and learn whether this seems like a large-scale problem or one specific to your request, please go to https://status.pinecone.io/ to view our status page. If you believe the error reflects a problem with this client, please file a bug report in the github issue tracker at https://github.com/pinecone-io/pinecone-ts-client`;\n        const statusMessage = status ? `Status Code: ${status}.` : '';\n        const bodyMessage = body ? `Body: ${body}` : '';\n        super([intro, statusMessage, help, bodyMessage].join(' ').trim());\n        this.name = 'PineconeInternalServerError';\n    }\n}\nexports.PineconeInternalServerError = PineconeInternalServerError;\n/* We can choose to throw this error when we want to limit requests to the server. When instantiated, pass the\n number of retries the user has made already. */\nclass PineconeMaxRetriesExceededError extends base_1.BasePineconeError {\n    constructor(retries) {\n        const intro = `You have exceeded the max configured retries (${retries}). `;\n        const help = 'Increase the maxRetries field in the RetryOptions object to retry more times. If you believe the' +\n            ' error reflects a problem with this client, please file a bug report in the github issue tracker at https://github.com/pinecone-io/pinecone-ts-client';\n        super([intro, help].join(' ').trim());\n        this.name = 'PineconeMaxRetriesExceededError';\n    }\n}\nexports.PineconeMaxRetriesExceededError = PineconeMaxRetriesExceededError;\n/**\n * This error indicates API responses are returning with status 503 and\n * Pinecone itself is down. Check the [status page](https://status.pinecone.io/)\n * for information about current or recent outages.\n *\n * The difference between this error (503) and a PineconeInternalServerError (500) is that this error does NOT indicate\n * that the server is _unable_ to process the request, just that the server will not process the request.\n *\n * @see [Pinecone's status page](https://status.pinecone.io/)\n */\nclass PineconeUnavailableError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url, body, status } = failedRequest;\n        const intro = url\n            ? `The Pinecone service (${url}) is temporarily unavailable.`\n            : '';\n        const statusMessage = status ? `Status Code: ${status}.` : '';\n        const help = `To see overall service health and learn whether this seems like a large-scale problem or one specific to your request, please go to https://status.pinecone.io/ to view our status page. If you believe the error reflects a problem with this client, please file a bug report in the github issue tracker at https://github.com/pinecone-io/pinecone-ts-client`;\n        const bodyMessage = body ? `Body: ${body}` : '';\n        super([intro, statusMessage, help, bodyMessage].join(' ').trim());\n        this.name = 'PineconeUnavailableError';\n    }\n}\nexports.PineconeUnavailableError = PineconeUnavailableError;\n/**\n * This error is thrown when you are attempting to use a feature that is\n * not implemented or unavailable to you on your current plan. Free indexes\n * only support a subset of Pinecone's capabilities, and if you are seeing\n * these exceptions then you should consult the\n * [pricing page](https://www.pinecone.io/pricing/) to see whether upgrading\n * makes sense for your use case.\n */\nclass PineconeNotImplementedError extends base_1.BasePineconeError {\n    constructor(requestInfo) {\n        const { url, message } = requestInfo;\n        if (url) {\n            super(`A call to ${url} returned HTTP status 501. ${message ? message : ''}`);\n        }\n        else {\n            super();\n        }\n        this.name = 'PineconeNotImplementedError';\n    }\n}\nexports.PineconeNotImplementedError = PineconeNotImplementedError;\n/**\n * This catch-all exception is thrown when a request error that is not\n * specifically mapped to another exception is thrown.\n */\nclass PineconeUnmappedHttpError extends base_1.BasePineconeError {\n    constructor(failedRequest) {\n        const { url, status, body, message } = failedRequest;\n        const intro = url\n            ? `An unexpected error occured while calling the ${url} endpoint. `\n            : '';\n        const statusMsg = status ? `Status: ${status}. ` : '';\n        const bodyMsg = body ? `Body: ${body}` : '';\n        super([intro, message, statusMsg, bodyMsg].join(' ').trim());\n        this.name = 'PineconeUnmappedHttpError';\n    }\n}\nexports.PineconeUnmappedHttpError = PineconeUnmappedHttpError;\n/** @internal */\nconst mapHttpStatusError = (failedRequestInfo) => {\n    switch (failedRequestInfo.status) {\n        case 400:\n            return new PineconeBadRequestError(failedRequestInfo);\n        case 401:\n            return new PineconeAuthorizationError(failedRequestInfo);\n        case 403:\n            return new PineconeBadRequestError(failedRequestInfo);\n        case 404:\n            return new PineconeNotFoundError(failedRequestInfo);\n        case 409:\n            return new PineconeConflictError(failedRequestInfo);\n        case 500:\n            return new PineconeInternalServerError(failedRequestInfo);\n        case 501:\n            return new PineconeNotImplementedError(failedRequestInfo);\n        case 503:\n            return new PineconeUnavailableError(failedRequestInfo);\n        default:\n            throw new PineconeUnmappedHttpError(failedRequestInfo);\n    }\n};\nexports.mapHttpStatusError = mapHttpStatusError;\n//# sourceMappingURL=http.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getFetch = void 0;\nconst errors_1 = require(\"../errors\");\nconst getFetch = (config) => {\n    if (config.fetchApi) {\n        // User-provided fetch implementation, if any, takes precedence.\n        return config.fetchApi;\n    }\n    else if (global.fetch) {\n        // If a fetch implementation is present in the global scope (will work with native fetch in Node18+, Edge runtimes,\n        // etc.), use that. This should prevent confusing failures in\n        // Next.js projects where @vercel/fetch is mandated and\n        // other implementations are stubbed out.\n        return global.fetch;\n    }\n    else {\n        // If no fetch implementation is found, throw an error.\n        throw new errors_1.PineconeConfigurationError('No global or user-provided fetch implementations found. Please supply a fetch implementation.');\n    }\n};\nexports.getFetch = getFetch;\n//# sourceMappingURL=fetch.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ChatStream = exports.RetryOnServerFailure = exports.convertKeysToCamelCase = exports.getFetch = exports.buildUserAgent = exports.queryParamsStringify = exports.normalizeUrl = exports.debugLog = void 0;\nconst debugLog_1 = require(\"./debugLog\");\nObject.defineProperty(exports, \"debugLog\", { enumerable: true, get: function () { return debugLog_1.debugLog; } });\nconst normalizeUrl_1 = require(\"./normalizeUrl\");\nObject.defineProperty(exports, \"normalizeUrl\", { enumerable: true, get: function () { return normalizeUrl_1.normalizeUrl; } });\nconst queryParamsStringify_1 = require(\"./queryParamsStringify\");\nObject.defineProperty(exports, \"queryParamsStringify\", { enumerable: true, get: function () { return queryParamsStringify_1.queryParamsStringify; } });\nconst user_agent_1 = require(\"./user-agent\");\nObject.defineProperty(exports, \"buildUserAgent\", { enumerable: true, get: function () { return user_agent_1.buildUserAgent; } });\nconst fetch_1 = require(\"./fetch\");\nObject.defineProperty(exports, \"getFetch\", { enumerable: true, get: function () { return fetch_1.getFetch; } });\nconst retries_1 = require(\"./retries\");\nObject.defineProperty(exports, \"RetryOnServerFailure\", { enumerable: true, get: function () { return retries_1.RetryOnServerFailure; } });\nconst chatStream_1 = require(\"../assistant/chatStream\");\nObject.defineProperty(exports, \"ChatStream\", { enumerable: true, get: function () { return chatStream_1.ChatStream; } });\nconst convertKeys_1 = require(\"./convertKeys\");\nObject.defineProperty(exports, \"convertKeysToCamelCase\", { enumerable: true, get: function () { return convertKeys_1.convertKeysToCamelCase; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RetryOnServerFailure = void 0;\nconst errors_1 = require(\"../errors\");\n// TODO: Parameterize this class to allow for custom error handling (e.g. only retry 400 errors on Chat endpoint,\n//  but not globally\n/* Retry asynchronous operations.\n *\n * @param maxRetries - The maximum number of retries to attempt.\n * @param asyncFn - The asynchronous function to retry.\n */\nclass RetryOnServerFailure {\n    constructor(asyncFn, maxRetries) {\n        /*\n         * Calculate the delay time for retrying an operation.\n         *\n         * @param attempt: The # of times the operation has been attempted.\n         * @param baseDelay: The base delay time in milliseconds.\n         * @param maxDelay: The maximum delay time in milliseconds.\n         * @param jitterFactor: The magnitude of jitter relative to the delay.\n         */\n        this.calculateRetryDelay = (attempt, baseDelay = 200, maxDelay = 20000, jitterFactor = 0.25) => {\n            let delay = baseDelay * 2 ** attempt; // Exponential (baseDelay * 2^attempt)\n            // Apply jitter as a random percentage of the original delay; e.g.: if `jitterFactor` = 0.25 and `baseDelay` = 1000,\n            // then `jitter` is 25% of `baseDelay`\n            const jitter = delay * jitterFactor * (Math.random() - 0.5);\n            delay += jitter;\n            // Ensure delay is not negative or greater than maxDelay\n            return Math.min(maxDelay, Math.max(0, delay));\n        };\n        if (maxRetries) {\n            this.maxRetries = maxRetries;\n        }\n        else {\n            this.maxRetries = 3;\n        }\n        if (this.maxRetries > 10) {\n            throw new Error('Max retries cannot exceed 10');\n        }\n        this.asyncFn = asyncFn;\n    }\n    async execute(...args) {\n        if (this.maxRetries < 1) {\n            return this.asyncFn(...args);\n        }\n        for (let attempt = 0; attempt < this.maxRetries; attempt++) {\n            try {\n                const response = await this.asyncFn(...args);\n                // Return immediately if the response is not a retryable error\n                if (!this.isRetryError(response)) {\n                    return response;\n                }\n                throw response; // Will catch this in next line\n            }\n            catch (error) {\n                const mappedError = this.mapErrorIfNeeded(error);\n                // If the error is not retryable, throw it immediately\n                if (this.shouldStopRetrying(mappedError)) {\n                    throw mappedError;\n                }\n                // On the last retry, throw a MaxRetriesExceededError\n                if (attempt === this.maxRetries - 1) {\n                    throw new errors_1.PineconeMaxRetriesExceededError(this.maxRetries);\n                }\n                // Wait before retrying\n                await this.delay(attempt + 1);\n            }\n        }\n        // This fallback is unnecessary, but included for type safety\n        throw new errors_1.PineconeMaxRetriesExceededError(this.maxRetries);\n    }\n    isRetryError(response) {\n        if (!response) {\n            return false;\n        }\n        if (response) {\n            if (response.name &&\n                ['PineconeUnavailableError', 'PineconeInternalServerError'].includes(response.name)) {\n                return true;\n            }\n            if (response.status && response.status >= 500) {\n                return true;\n            }\n        }\n        return false;\n    }\n    async delay(attempt) {\n        const delayTime = this.calculateRetryDelay(attempt);\n        return new Promise((resolve) => setTimeout(resolve, delayTime));\n    }\n    mapErrorIfNeeded(error) {\n        if (error?.status) {\n            return (0, errors_1.mapHttpStatusError)(error);\n        }\n        return error; // Return original error if no mapping is needed\n    }\n    shouldStopRetrying(error) {\n        if (error.status) {\n            return error.status < 500;\n        }\n        if (error.name) {\n            return (error.name !== 'PineconeUnavailableError' &&\n                error.name !== 'PineconeInternalServerError');\n        }\n        return true;\n    }\n}\nexports.RetryOnServerFailure = RetryOnServerFailure;\n//# sourceMappingURL=retries.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PineconeUnableToResolveHostError = exports.PineconeEnvironmentVarsNotSupportedError = exports.PineconeUnexpectedResponseError = exports.PineconeConfigurationError = void 0;\nconst base_1 = require(\"./base\");\nconst CONFIG_HELP = `You can find the configuration values for your project in the Pinecone developer console at https://app.pinecone.io.`;\n/**\n * This exception indicates there is a problem with the configuration values\n * you have provided to the client. The error message should contain additional\n * context about what you are missing.\n *\n * @see {@link Pinecone} for information about initializing the client.\n */\nclass PineconeConfigurationError extends base_1.BasePineconeError {\n    constructor(message) {\n        super(`${message} ${CONFIG_HELP}`);\n        this.name = 'PineconeConfigurationError';\n    }\n}\nexports.PineconeConfigurationError = PineconeConfigurationError;\n/**\n * This exception indicates an API call that returned a response that was\n * unable to be parsed or that did not include expected fields. It's not\n * expected to ever occur.\n *\n * If you encounter this error, please [file an issue](https://github.com/pinecone-io/pinecone-ts-client/issues) so we can investigate.\n */\nclass PineconeUnexpectedResponseError extends base_1.BasePineconeError {\n    constructor(url, status, body, message) {\n        super(`Unexpected response while calling ${url}. ${message ? message + ' ' : ''}Status: ${status}. Body: ${body}`);\n        this.name = 'PineconeUnexpectedResponseError';\n    }\n}\nexports.PineconeUnexpectedResponseError = PineconeUnexpectedResponseError;\n/**\n * This error occurs when the client tries to read environment variables in\n * an environment that does not have access to the Node.js global `process.env`.\n *\n * If you are seeing this error, you will need to configure the client by passing\n * configuration values to the `Pinecone` constructor.\n *\n * ```typescript\n * import { Pinecone } from '@pinecone-database/pinecone';\n *\n * const pinecone = new Pinecone({\n *    apiKey: 'YOUR_API_KEY',\n * })\n * ```\n *\n * @see Instructions for configuring { @link Pinecone }\n */\nclass PineconeEnvironmentVarsNotSupportedError extends base_1.BasePineconeError {\n    constructor(message) {\n        super(message);\n        this.name = 'PineconeEnvironmentVarsNotSupportedError';\n    }\n}\nexports.PineconeEnvironmentVarsNotSupportedError = PineconeEnvironmentVarsNotSupportedError;\n/**\n * This error occurs when the client is unable to resolve the database host for a given\n * index. This is unexpected to occur unless there is a problem with the Pinecone service.\n *\n * If you encounter this error, please [file an issue](https://github.com/pinecone-io/pinecone-ts-client/issues) so we can investigate.\n */\nclass PineconeUnableToResolveHostError extends base_1.BasePineconeError {\n    constructor(message) {\n        super(message);\n        this.name = 'PineconeUnableToResolveHostError';\n    }\n}\nexports.PineconeUnableToResolveHostError = PineconeUnableToResolveHostError;\n//# sourceMappingURL=config.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.normalizeUrl = void 0;\nfunction normalizeUrl(url) {\n    if (!url || url.trim().length === 0) {\n        return;\n    }\n    if (!url.startsWith('http://') && !url.startsWith('https://')) {\n        return 'https://' + url;\n    }\n    return url;\n}\nexports.normalizeUrl = normalizeUrl;\n//# sourceMappingURL=normalizeUrl.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PineconeRequestError = exports.PineconeConnectionError = void 0;\nconst base_1 = require(\"./base\");\n/**\n * This error is thrown when the client attempts to make a\n * request and never receives any response.\n *\n * This could be due to:\n * - Network problems which prevent the request from being completed.\n * - An outage of Pinecone's APIs. See [Pinecone's status page](https://status.pinecone.io/) to find out whether there is an ongoing incident.\n *\n * The `cause` property will contain a reference to the underlying error. Inspect its value to find out more about the root cause of the error.\n * ```\n * import { Pinecone } from '@pinecone-database/pinecone';\n *\n * const p = new Pinecone({ apiKey: 'invalid-api-key-value' })\n *\n * try {\n *  await p.listIndexes();\n * } catch (e) {\n *  console.log(e.name); // PineconeConnectionError\n *  console.log(e.cause); // Error [FetchError]: The request failed and the interceptors did not return an alternative response\n *  console.log(e.cause.cause); // TypeError: fetch failed\n *  console.log(e.cause.cause.cause); // Error: getaddrinfo ENOTFOUND controller.wrong-environment.pinecone.io\n * }\n * ```\n *\n * @see [Pinecone's status page](https://status.pinecone.io/)\n * */\nclass PineconeConnectionError extends base_1.BasePineconeError {\n    constructor(e, url) {\n        let urlMessage = '';\n        if (url) {\n            urlMessage = ` while calling ${url}`;\n        }\n        super(`Request failed to reach Pinecone${urlMessage}. This can occur for reasons such as network problems that prevent the request from being completed, or a Pinecone API outage. Check your network connection, and visit https://status.pinecone.io/ to see whether any outages are ongoing.`, e);\n        this.name = 'PineconeConnectionError';\n    }\n}\nexports.PineconeConnectionError = PineconeConnectionError;\n/**\n * This error is thrown any time a request to the Pinecone API fails.\n *\n * The `cause` property will contain a reference to the underlying error. Inspect its value to find out more about the root cause.\n */\nclass PineconeRequestError extends base_1.BasePineconeError {\n    constructor(context) {\n        if (context.response) {\n            super(`Request failed during a call to ${context.init.method} ${context.url} with status ${context.response.status}`, context.error);\n        }\n        else {\n            super(`Request failed during a call to ${context.init.method} ${context.url}`, context.error);\n        }\n    }\n}\nexports.PineconeRequestError = PineconeRequestError;\n//# sourceMappingURL=request.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BasePineconeError = void 0;\nclass BasePineconeError extends Error {\n    constructor(message, cause) {\n        super(message);\n        // Set the prototype explicitly to ensure instanceof works correctly\n        Object.setPrototypeOf(this, new.target.prototype);\n        // Maintain a proper stack trace in V8 environments (Chrome and Node.js)\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, new.target);\n        }\n        this.name = this.constructor.name;\n        this.cause = cause;\n    }\n}\nexports.BasePineconeError = BasePineconeError;\n//# sourceMappingURL=base.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.debugLog = void 0;\nconst debugLog = (str) => {\n    if (typeof process !== 'undefined' &&\n        process &&\n        process.env &&\n        process.env.PINECONE_DEBUG) {\n        console.log(str);\n    }\n};\nexports.debugLog = debugLog;\n//# sourceMappingURL=debugLog.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isBrowser = exports.isEdge = void 0;\nconst isEdge = () => {\n    // This is the recommended way to detect\n    // running in the Edge Runtime according\n    // to Vercel docs.\n    return typeof EdgeRuntime === 'string';\n};\nexports.isEdge = isEdge;\nconst isBrowser = () => {\n    return typeof window !== 'undefined';\n};\nexports.isBrowser = isBrowser;\n//# sourceMappingURL=environment.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.handleApiError = exports.extractMessage = exports.PineconeArgumentError = exports.BasePineconeError = exports.PineconeRequestError = exports.PineconeConnectionError = exports.PineconeUnableToResolveHostError = exports.PineconeEnvironmentVarsNotSupportedError = exports.PineconeUnexpectedResponseError = exports.PineconeConfigurationError = void 0;\nvar config_1 = require(\"./config\");\nObject.defineProperty(exports, \"PineconeConfigurationError\", { enumerable: true, get: function () { return config_1.PineconeConfigurationError; } });\nObject.defineProperty(exports, \"PineconeUnexpectedResponseError\", { enumerable: true, get: function () { return config_1.PineconeUnexpectedResponseError; } });\nObject.defineProperty(exports, \"PineconeEnvironmentVarsNotSupportedError\", { enumerable: true, get: function () { return config_1.PineconeEnvironmentVarsNotSupportedError; } });\nObject.defineProperty(exports, \"PineconeUnableToResolveHostError\", { enumerable: true, get: function () { return config_1.PineconeUnableToResolveHostError; } });\n__exportStar(require(\"./http\"), exports);\nvar request_1 = require(\"./request\");\nObject.defineProperty(exports, \"PineconeConnectionError\", { enumerable: true, get: function () { return request_1.PineconeConnectionError; } });\nObject.defineProperty(exports, \"PineconeRequestError\", { enumerable: true, get: function () { return request_1.PineconeRequestError; } });\nvar base_1 = require(\"./base\");\nObject.defineProperty(exports, \"BasePineconeError\", { enumerable: true, get: function () { return base_1.BasePineconeError; } });\nvar validation_1 = require(\"./validation\");\nObject.defineProperty(exports, \"PineconeArgumentError\", { enumerable: true, get: function () { return validation_1.PineconeArgumentError; } });\nvar utils_1 = require(\"./utils\");\nObject.defineProperty(exports, \"extractMessage\", { enumerable: true, get: function () { return utils_1.extractMessage; } });\nvar handling_1 = require(\"./handling\");\nObject.defineProperty(exports, \"handleApiError\", { enumerable: true, get: function () { return handling_1.handleApiError; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.convertKeysToCamelCase = void 0;\n// converts keys of a json payload from snake_case to camelCase\nconst convertKeysToCamelCase = (object) => {\n    if (Array.isArray(object)) {\n        return object.map((item) => (0, exports.convertKeysToCamelCase)(item));\n    }\n    else if (object !== null && typeof object === 'object') {\n        return Object.entries(object).reduce((acc, [key, value]) => {\n            const camelKey = toCamelCase(key);\n            acc[camelKey] = (0, exports.convertKeysToCamelCase)(value);\n            return acc;\n        }, {});\n    }\n    return object; // return primitives as is\n};\nexports.convertKeysToCamelCase = convertKeysToCamelCase;\n// converts snake-case keys to camelCase\nconst toCamelCase = (str) => str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());\n//# sourceMappingURL=convertKeys.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.extractMessage = void 0;\n/** @internal */\nconst extractMessage = async (error) => {\n    let message = await error.response.text();\n    // Error response is sometimes the raw message, sometimes it's JSON\n    // so we will try to parse out the actual message text, but\n    // we wrap it in a try to avoid crashing in a way that obscures\n    // the actual error if the response format changes in the future.\n    try {\n        const messageJSON = JSON.parse(message);\n        if (messageJSON.message) {\n            message = messageJSON.message;\n        }\n    }\n    catch (e) {\n        // noop\n    }\n    return message;\n};\nexports.extractMessage = extractMessage;\n//# sourceMappingURL=utils.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildUserAgent = void 0;\nconst environment_1 = require(\"./environment\");\nconst packageInfo = __importStar(require(\"../version.json\"));\nconst buildUserAgent = (config) => {\n    // We always want to include the package name and version\n    // along with the langauge name to help distinguish these\n    // requests from those emitted by other clients\n    const userAgentParts = [\n        `${packageInfo.name} v${packageInfo.version}`,\n        'lang=typescript',\n    ];\n    if ((0, environment_1.isEdge)()) {\n        userAgentParts.push('Edge Runtime');\n    }\n    // If available, capture information about the Node.js version\n    if (typeof process !== 'undefined' && process && process.version) {\n        userAgentParts.push(`node ${process.version}`);\n    }\n    if (config.sourceTag) {\n        userAgentParts.push(`source_tag=${normalizeSourceTag(config.sourceTag)}`);\n    }\n    return userAgentParts.join('; ');\n};\nexports.buildUserAgent = buildUserAgent;\nconst normalizeSourceTag = (sourceTag) => {\n    if (!sourceTag) {\n        return;\n    }\n    /**\n     * normalize sourceTag\n     * 1. Lowercase\n     * 2. Limit charset to [a-z0-9_ :]\n     * 3. Trim left/right spaces\n     * 4. Condense multiple spaces to one, and replace with underscore\n     */\n    return sourceTag\n        .toLowerCase()\n        .replace(/[^a-z0-9_ :]/g, '')\n        .trim()\n        .replace(/[ ]+/g, '_');\n};\n//# sourceMappingURL=user-agent.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.queryParamsStringify = void 0;\n// Everything in this file is lifted from the generated openapi runtime.\n// I need to create a small modification of the generated queryParamStringify\n// function in order to fix an issue with array params.\n//\n// See https://github.com/pinecone-io/pinecone-ts-client/pull/74\nfunction queryParamsStringify(params, prefix = '') {\n    return Object.keys(params)\n        .map((key) => querystringSingleKey(key, params[key], prefix))\n        .filter((part) => part.length > 0)\n        .join('&');\n}\nexports.queryParamsStringify = queryParamsStringify;\nfunction querystringSingleKey(key, value, keyPrefix = '') {\n    const fullKey = keyPrefix + (keyPrefix.length ? `[${key}]` : key);\n    // This is a one line change from the default querystring implementation. Checking\n    // with `Array.isArray` instead of `value instanceof Array` allows us to get the\n    // the correct behavior when stringifying array params.\n    if (Array.isArray(value)) {\n        const multiValue = value\n            .map((singleValue) => encodeURIComponent(String(singleValue)))\n            .join(`&${encodeURIComponent(fullKey)}=`);\n        return `${encodeURIComponent(fullKey)}=${multiValue}`;\n    }\n    if (value instanceof Set) {\n        const valueAsArray = Array.from(value);\n        return querystringSingleKey(key, valueAsArray, keyPrefix);\n    }\n    if (value instanceof Date) {\n        return `${encodeURIComponent(fullKey)}=${encodeURIComponent(value.toISOString())}`;\n    }\n    if (value instanceof Object) {\n        return queryParamsStringify(value, fullKey);\n    }\n    return `${encodeURIComponent(fullKey)}=${encodeURIComponent(String(value))}`;\n}\n//# sourceMappingURL=queryParamsStringify.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PineconeArgumentError = void 0;\nconst base_1 = require(\"./base\");\n/**\n * This error is thrown when arguments passed to a Pinecone\n * client method fail a runtime validation.\n */\nclass PineconeArgumentError extends base_1.BasePineconeError {\n    constructor(message) {\n        super(`${message}`);\n        this.name = 'PineconeArgumentError';\n    }\n}\nexports.PineconeArgumentError = PineconeArgumentError;\n//# sourceMappingURL=validation.js.map","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// Remove all these imports as they're no longer needed\r\n// import { promises as fs } from 'fs';\r\n// import { join } from 'path';\r\n// import { fileURLToPath } from 'url';\r\n// import { dirname } from 'path';\r\n\r\nexport async function validateCodeStrings(inputCodeStrings) {\r\n    const errors = [];\r\n    const tabLabels = new Set();\r\n    const rowValues = new Set();\r\n    const codeTypes = new Set();\r\n    \r\n    // Clean up input strings by removing anything outside angle brackets\r\n    inputCodeStrings = inputCodeStrings.map(str => {\r\n        const match = str.match(/<[^>]+>/);\r\n        return match ? match[0] : str;\r\n    });\r\n\r\n    console.log(\"CleanedInput Code Strings:\", inputCodeStrings);\r\n\r\n    // Track codes by their suffixes\r\n    const vvCodes = new Set();  // codes ending in -VV\r\n    const vrCodes = new Set();  // codes ending in -VR\r\n    const rrCodes = new Set();  // codes ending in -RR\r\n    const rvCodes = new Set();  // codes ending in -RV\r\n    const evCodes = new Set();  // codes ending in -EV\r\n    const erCodes = new Set();  // codes ending in -ER\r\n\r\n    // Load valid codes from the correct location\r\n    let validCodes = new Set();\r\n    try {\r\n        const response = await fetch('../prompts/Codes.txt');\r\n        if (!response.ok) {\r\n            throw new Error('Failed to load Codes.txt file');\r\n        }\r\n        const fileContent = await response.text();\r\n        validCodes = new Set(fileContent.split('\\n')\r\n            .map(line => line.trim())\r\n            .filter(line => line.length > 0));\r\n    } catch (error) {\r\n        errors.push(`Error reading Codes.txt file: ${error.message}`);\r\n        return errors;\r\n    }\r\n\r\n    // First pass: collect all row values, code types, and suffixes\r\n    for (const codeString of inputCodeStrings) {\r\n        if (!codeString.startsWith('<') || !codeString.endsWith('>')) {\r\n            errors.push(`Invalid code string format: ${codeString}`);\r\n            continue;\r\n        }\r\n        // Extract and store row IDs\r\n        if (codeString.startsWith('<BR>')) {\r\n            // Skip extraction for BR tags\r\n            continue;\r\n        }\r\n\r\n        const rowMatches = codeString.match(/row\\d+\\s*=\\s*\"([^\"]*)\"/g);\r\n        if (rowMatches) {\r\n            rowMatches.forEach(match => {\r\n                const rowContent = match.match(/row\\d+\\s*=\\s*\"([^\"]*)\"/)[1];\r\n                // Handle spaces before/after the pipe delimiter\r\n                const parts = rowContent.split('|');\r\n                if (parts.length > 0) {\r\n                    // Extract all potential row IDs including those after asterisks\r\n                    parts.forEach(part => {\r\n                        const trimmedPart = part.trim();\r\n                        if (trimmedPart.startsWith('*')) {\r\n                            // Add the ID after the asterisk\r\n                            const afterAsterisk = trimmedPart.substring(1).trim();\r\n                            if (afterAsterisk) {\r\n                                rowValues.add(afterAsterisk);\r\n                            }\r\n                        } else if (trimmedPart) {\r\n                            // Add regular IDs\r\n                            rowValues.add(trimmedPart);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        \r\n        // console.log(rowMatches);\r\n        // Extract code type and suffix\r\n        const codeMatch = codeString.match(/<([^;]+);/);\r\n        if (codeMatch) {\r\n            const codeType = codeMatch[1].trim();\r\n            codeTypes.add(codeType);\r\n\r\n            // Check for suffixes and store them\r\n            if (codeType.endsWith('-VV')) vvCodes.add(codeType);\r\n            if (codeType.endsWith('-VR')) vrCodes.add(codeType);\r\n            if (codeType.endsWith('-RR')) rrCodes.add(codeType);\r\n            if (codeType.endsWith('-RV')) rvCodes.add(codeType);\r\n            if (codeType.endsWith('-EV')) evCodes.add(codeType);\r\n            if (codeType.endsWith('-ER')) erCodes.add(codeType);\r\n        }\r\n    }\r\n\r\n    // Validate suffix relationships\r\n    // Rule 1: -VV or -VR must have -EV or -RV\r\n    for (const code of [...vvCodes, ...vrCodes]) {\r\n        if (evCodes.size === 0 && rvCodes.size === 0) {\r\n            errors.push(`Code ${code} requires another code with suffix -EV or -RV. Fix by adding another code with the correct suffix or by change to the EV/ER version of the same code.`);\r\n        }\r\n    }\r\n\r\n    // Rule 2: -RR or -RV must have -ER or -VR\r\n    for (const code of [...rrCodes, ...rvCodes]) {\r\n        if (erCodes.size === 0 && vrCodes.size === 0) {\r\n            errors.push(`Code ${code} requires another code with suffix -ER or -VR`);\r\n        }\r\n    }\r\n\r\n// Second pass: detailed validation\r\nfor (const codeString of inputCodeStrings) {\r\n    // Skip BR tags completely\r\n    if (codeString === '<BR>') {\r\n        continue;\r\n    }\r\n    \r\n    const codeMatch = codeString.match(/<([^;]+);/);\r\n    if (!codeMatch) {\r\n        errors.push(`Cannot extract code type from: ${codeString}`);\r\n        continue;\r\n    }\r\n\r\n    const codeType = codeMatch[1].trim();\r\n    \r\n    // Validate code exists in description file\r\n    if (!validCodes.has(codeType)) {\r\n        errors.push(`Invalid code type: \"${codeType}\" not found in valid codes list`);\r\n    }\r\n\r\n\r\n\r\n        // Validate TAB labels\r\n        if (codeType === 'TAB') {\r\n            const labelMatch = codeString.match(/label\\d+=\"([^\"]*)\"/);\r\n            if (!labelMatch) {\r\n                errors.push('TAB code missing label parameter');\r\n                continue;\r\n            }\r\n\r\n            const label = labelMatch[1];\r\n            \r\n            if (label.length > 30) {\r\n                errors.push(`Tab label too long (max 30 chars): \"${label}\"`);\r\n            }\r\n            \r\n            if (/[&,\":;]/.test(label)) {\r\n                errors.push(`Tab label contains illegal characters (&,\":;): \"${label}\"`);\r\n            }\r\n            \r\n            if (tabLabels.has(label)) {\r\n                errors.push(`Duplicate tab label: \"${label}\"`);\r\n            }\r\n            tabLabels.add(label);\r\n        }\r\n\r\n        // Validate row format\r\n        const rowMatches = codeString.match(/row\\d+=\"([^\"]*)\"/g);\r\n        if (rowMatches) {\r\n            rowMatches.forEach(match => {\r\n                const rowContent = match.match(/row\\d+=\"([^\"]*)\"/)[1];\r\n                const parts = rowContent.split('|');\r\n                if (parts.length < 2) {\r\n                    errors.push(`Invalid row format (missing required fields): \"${rowContent}\"`);\r\n                }\r\n            });\r\n        }\r\n    } // <-- This is the end of the second pass loop\r\n\r\n    // Third pass: validate driver references after all row IDs are collected\r\n    for (const codeString of inputCodeStrings) {\r\n        const driverMatches = codeString.match(/driver\\d+\\s*=\\s*\"([^\"]*)\"/g);\r\n        if (driverMatches) {\r\n            driverMatches.forEach(match => {\r\n                const driverValue = match.match(/driver\\d+\\s*=\\s*\"([^\"]*)\"/)[1].trim();\r\n                if (!rowValues.has(driverValue)) {\r\n                    errors.push(`Driver value \"${driverValue}\" not found in any row`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Convert array of errors to a single string with line breaks\r\n    return errors.join('\\n');\r\n}\r\n\r\n// Modified export function\r\nexport async function runValidation(inputStrings) {\r\n    try {\r\n        const cleanedStrings = inputStrings\r\n            .map(line => line.trim())\r\n            .filter(line => line.length > 0)\r\n            .map(line => line.replace(/^'|',$|,$|^\"|\"$/g, ''));\r\n\r\n        const codeStrings = cleanedStrings.join(' ').match(/<[^>]+>/g) || [];\r\n\r\n        if (codeStrings.length === 0) {\r\n            console.error('Validation run with no codestrings - input is empty');\r\n            return ['No code strings found to validate'];\r\n        }\r\n\r\n        const validationErrors = await validateCodeStrings(codeStrings);\r\n        return validationErrors;\r\n    } catch (error) {\r\n        console.error('Validation failed:', error);\r\n        return [`Validation failed: ${error.message}`];\r\n    }\r\n}\r\n\r\n// >>> ADDED: New validation function for Run Codes flow (returns array)\r\nexport async function validateCodeStringsForRun(inputCodeStrings) {\r\n    const errors = [];\r\n    const tabLabels = new Set();\r\n    const rowValues = new Set();\r\n    const codeTypes = new Set();\r\n    \r\n    // Clean up input strings by removing anything outside angle brackets\r\n    inputCodeStrings = inputCodeStrings.map(str => {\r\n        const match = str.match(/<[^>]+>/);\r\n        return match ? match[0] : str;\r\n    });\r\n\r\n    console.log(\"[ValidateForRun] CleanedInput Code Strings:\", inputCodeStrings);\r\n\r\n    // Track codes by their suffixes (Same logic as original)\r\n    const vvCodes = new Set();\r\n    const vrCodes = new Set();\r\n    const rrCodes = new Set();\r\n    const rvCodes = new Set();\r\n    const evCodes = new Set();\r\n    const erCodes = new Set();\r\n\r\n    // Load valid codes (Same logic as original)\r\n    let validCodes = new Set();\r\n    try {\r\n        const response = await fetch('../prompts/Codes.txt');\r\n        if (!response.ok) {\r\n            throw new Error('Failed to load Codes.txt file');\r\n        }\r\n        const fileContent = await response.text();\r\n        validCodes = new Set(fileContent.split('\\n')\r\n            .map(line => line.trim())\r\n            .filter(line => line.length > 0));\r\n    } catch (error) {\r\n        errors.push(`Error reading Codes.txt file: ${error.message}`);\r\n        return errors; // Return array on critical error\r\n    }\r\n\r\n    // First pass: collect all row values, code types, and suffixes (Same logic as original)\r\n    for (const codeString of inputCodeStrings) {\r\n        if (!codeString.startsWith('<') || !codeString.endsWith('>')) {\r\n            errors.push(`Invalid code string format: ${codeString}`);\r\n            continue;\r\n        }\r\n        if (codeString.startsWith('<BR>')) {\r\n            continue;\r\n        }\r\n        const rowMatches = codeString.match(/row\\d+\\s*=\\s*\"([^\"]*)\"/g);\r\n        if (rowMatches) {\r\n            rowMatches.forEach(match => {\r\n                const rowContent = match.match(/row\\d+\\s*=\\s*\"([^\"]*)\"/)[1];\r\n                const parts = rowContent.split('|');\r\n                if (parts.length > 0) {\r\n                    parts.forEach(part => {\r\n                        const trimmedPart = part.trim();\r\n                        if (trimmedPart.startsWith('*')) {\r\n                            const afterAsterisk = trimmedPart.substring(1).trim();\r\n                            if (afterAsterisk) {\r\n                                rowValues.add(afterAsterisk);\r\n                            }\r\n                        } else if (trimmedPart) {\r\n                            rowValues.add(trimmedPart);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        }\r\n        const codeMatch = codeString.match(/<([^;]+);/);\r\n        if (codeMatch) {\r\n            const codeType = codeMatch[1].trim();\r\n            codeTypes.add(codeType);\r\n            if (codeType.endsWith('-VV')) vvCodes.add(codeType);\r\n            if (codeType.endsWith('-VR')) vrCodes.add(codeType);\r\n            if (codeType.endsWith('-RR')) rrCodes.add(codeType);\r\n            if (codeType.endsWith('-RV')) rvCodes.add(codeType);\r\n            if (codeType.endsWith('-EV')) evCodes.add(codeType);\r\n            if (codeType.endsWith('-ER')) erCodes.add(codeType);\r\n        }\r\n    }\r\n\r\n    // Validate suffix relationships (Same logic as original)\r\n    for (const code of [...vvCodes, ...vrCodes]) {\r\n        if (evCodes.size === 0 && rvCodes.size === 0) {\r\n            errors.push(`Code ${code} requires another code with suffix -EV or -RV. Fix by adding another code with the correct suffix or by change to the EV/ER version of the same code.`);\r\n        }\r\n    }\r\n    for (const code of [...rrCodes, ...rvCodes]) {\r\n        if (erCodes.size === 0 && vrCodes.size === 0) {\r\n            errors.push(`Code ${code} requires another code with suffix -ER or -VR`);\r\n        }\r\n    }\r\n\r\n    // Second pass: detailed validation (Same logic as original)\r\n    for (const codeString of inputCodeStrings) {\r\n        if (codeString === '<BR>') {\r\n            continue;\r\n        }\r\n        const codeMatch = codeString.match(/<([^;]+);/);\r\n        if (!codeMatch) {\r\n            errors.push(`Cannot extract code type from: ${codeString}`);\r\n            continue;\r\n        }\r\n        const codeType = codeMatch[1].trim();\r\n        if (!validCodes.has(codeType)) {\r\n            errors.push(`Invalid code type: \"${codeType}\" not found in valid codes list`);\r\n        }\r\n        if (codeType === 'TAB') {\r\n            const labelMatch = codeString.match(/label\\d+=\"([^\"]*)\"/);\r\n            if (!labelMatch) {\r\n                errors.push('TAB code missing label parameter');\r\n                continue;\r\n            }\r\n            const label = labelMatch[1];\r\n            if (label.length > 30) {\r\n                errors.push(`Tab label too long (max 30 chars): \"${label}\"`);\r\n            }\r\n            if (/[&,\":;]/.test(label)) {\r\n                errors.push(`Tab label contains illegal characters (&,\":;): \"${label}\"`);\r\n            }\r\n            if (tabLabels.has(label)) {\r\n                errors.push(`Duplicate tab label: \"${label}\"`);\r\n            }\r\n            tabLabels.add(label);\r\n        }\r\n        const rowMatches = codeString.match(/row\\d+=\"([^\"]*)\"/g);\r\n        if (rowMatches) {\r\n            rowMatches.forEach(match => {\r\n                const rowContent = match.match(/row\\d+=\"([^\"]*)\"/)[1];\r\n                const parts = rowContent.split('|');\r\n                if (parts.length < 2) {\r\n                    errors.push(`Invalid row format (missing required fields): \"${rowContent}\"`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Third pass: validate driver references (Same logic as original)\r\n    for (const codeString of inputCodeStrings) {\r\n        const driverMatches = codeString.match(/driver\\d+\\s*=\\s*\"([^\"]*)\"/g);\r\n        if (driverMatches) {\r\n            driverMatches.forEach(match => {\r\n                const driverValue = match.match(/driver\\d+\\s*=\\s*\"([^\"]*)\"/)[1].trim();\r\n                if (!rowValues.has(driverValue)) {\r\n                    errors.push(`Driver value \"${driverValue}\" not found in any row`);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Key Change: Return the array of errors directly\r\n    return errors;\r\n}\r\n// <<< END ADDED FUNCTION\r\n\r\n","/**\r\n * CodeCollection.js\r\n * Functions for processing and managing code collections\r\n */\r\n\r\nimport { convertKeysToCamelCase } from \"@pinecone-database/pinecone/dist/utils\";\r\n\r\n/**\r\n * Parses code strings and creates a code collection\r\n * @param {string} inputText - The input text containing code strings\r\n * @returns {Array} - An array of code objects with type and parameters\r\n */\r\nexport function populateCodeCollection(inputText) {\r\n    try {\r\n        console.log(\"Processing input text for code collection\");\r\n         \r\n        // Initialize an empty code collection\r\n        const codeCollection = [];\r\n        \r\n        // Split the input text by newlines (handles \\n and \\r\\n)\r\n        const lines = inputText.split(/\\r?\\n/);\r\n        \r\n        for (const line of lines) {\r\n            // Skip empty lines\r\n            if (!line.trim()) continue;\r\n            \r\n            // Extract the code type and parameters\r\n            const codeMatch = line.match(/<([^;>]+);(.*?)>/);\r\n            if (!codeMatch) continue;\r\n            \r\n            const codeType = codeMatch[1].trim();\r\n            // Remove potential leftover newline/carriage return characters from the params string\r\n            const paramsString = codeMatch[2].replace(/[\\r\\n]+/g, '').trim();\r\n            \r\n            // Parse parameters\r\n            const params = {};\r\n            \r\n            // Handle special case for row parameters with asterisks\r\n            // Use the cleaned paramsString\r\n            const rowMatches = paramsString.matchAll(/row(\\d+)\\s*=\\s*\"([^\"]*)\"/g);\r\n            for (const match of rowMatches) {\r\n                const rowNum = match[1];\r\n                const rowValue = match[2];\r\n                params[`row${rowNum}`] = rowValue;\r\n            }\r\n            \r\n            // Parse other parameters\r\n            // Use the cleaned paramsString\r\n            const paramMatches = paramsString.matchAll(/(\\w+)\\s*=\\s*\"([^\"]*)\"/g);\r\n            for (const match of paramMatches) {\r\n                const paramName = match[1].trim();\r\n                const paramValue = match[2].trim();\r\n                \r\n                // Skip row parameters as they're already handled\r\n                if (paramName.startsWith('row')) continue;\r\n                \r\n                params[paramName] = paramValue;\r\n            }\r\n            \r\n            // Add the code to the collection\r\n            codeCollection.push({\r\n                type: codeType,\r\n                params: params\r\n            });\r\n        }\r\n        \r\n        console.log(`Processed ${codeCollection.length} codes`);\r\n        return codeCollection;\r\n    } catch (error) {\r\n        console.error(\"Error in populateCodeCollection:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Exports a code collection to text format\r\n * @param {Array} codeCollection - The code collection to export\r\n * @returns {string} - A formatted text representation of the code collection\r\n */\r\nexport function exportCodeCollectionToText(codeCollection) {\r\n    try {\r\n        if (!codeCollection || !Array.isArray(codeCollection)) {\r\n            throw new Error(\"Invalid code collection\");\r\n        }\r\n        \r\n        let result = \"Code Collection:\\n\";\r\n        result += \"================\\n\\n\";\r\n        \r\n        codeCollection.forEach((code, index) => {\r\n            result += `Code ${index + 1}: ${code.type}\\n`;\r\n            result += \"Parameters:\\n\";\r\n            \r\n            // First display non-row parameters\r\n            for (const [key, value] of Object.entries(code.params)) {\r\n                if (!key.startsWith('row')) {\r\n                    result += `  ${key}: ${value}\\n`;\r\n                }\r\n            }\r\n            \r\n            // Then display row parameters\r\n            const rowParams = Object.entries(code.params)\r\n                .filter(([key]) => key.startsWith('row'))\r\n                .sort((a, b) => {\r\n                    const numA = parseInt(a[0].replace('row', ''));\r\n                    const numB = parseInt(b[0].replace('row', ''));\r\n                    return numA - numB;\r\n                });\r\n            \r\n            if (rowParams.length > 0) {\r\n                result += \"  Rows:\\n\";\r\n                for (const [key, value] of rowParams) {\r\n                    result += `    ${key}: ${value}\\n`;\r\n                }\r\n            }\r\n            \r\n            result += \"\\n\";\r\n        });\r\n        \r\n        return result;\r\n    } catch (error) {\r\n        console.error(\"Error in exportCodeCollectionToText:\", error);\r\n        throw error;\r\n    }\r\n} \r\n\r\n/**\r\n * Processes a code collection and performs operations based on code types\r\n * @param {Array} codeCollection - The code collection to process\r\n * @returns {Object} - Results of processing the code collection\r\n */\r\nexport async function runCodes(codeCollection) {\r\n    try {\r\n        console.log(\"Running code collection processing\");\r\n        \r\n        if (!codeCollection || !Array.isArray(codeCollection)) {\r\n            throw new Error(\"Invalid code collection\");\r\n        }\r\n        \r\n        // Initialize result object\r\n        const result = {\r\n            processedCodes: 0,\r\n            createdTabs: [],\r\n            errors: []\r\n        };\r\n        \r\n        // Initialize state variables (similar to VBA variables)\r\n        let currentWorksheetName = null;\r\n        const assumptionTabs = [];\r\n        \r\n        // Process each code in the collection\r\n        for (let i = 0; i < codeCollection.length; i++) {\r\n            const code = codeCollection[i];\r\n            const codeType = code.type;\r\n            \r\n            try {\r\n                // Handle MODEL code type\r\n                if (codeType === \"MODEL\") {\r\n                    // Skip for now as mentioned in the original VBA code\r\n                    console.log(\"MODEL code type encountered - skipping for now\");\r\n                    continue;\r\n                }\r\n                \r\n                // Handle TAB code type\r\n                if (codeType === \"TAB\") {\r\n                    // Accept both label1 and Label1 for backward compatibility\r\n                    const tabName = code.params.label1 || code.params.Label1 || `Tab_${i}`;\r\n                    \r\n                    // Check if worksheet exists and delete it\r\n                    await Excel.run(async (context) => {\r\n                        try {\r\n                            // Get all worksheets\r\n                            const sheets = context.workbook.worksheets;\r\n                            sheets.load(\"items/name\");\r\n                            console.log(\"sheets\", sheets);\r\n                            await context.sync();\r\n                            \r\n                            // Check if worksheet exists\r\n                            const existingSheet = sheets.items.find(sheet => sheet.name === tabName);\r\n                            console.log(\"existingSheet\", existingSheet);\r\n                            // if (existingSheet) {\r\n                            //     // Delete the worksheet if it exists\r\n                            //     existingSheet.delete();\r\n                            //     await context.sync();\r\n                            // }\r\n                            // console.log(\"existingSheet deleted\");\r\n                            \r\n                            // Get the Financials worksheet (needed for position and as fallback template)\r\n                            const financialsSheet = context.workbook.worksheets.getItem(\"Financials\");\r\n                            financialsSheet.load(\"position\"); // Load Financials sheet position\r\n                            await context.sync(); // Sync to get Financials position\r\n                            console.log(`Financials sheet is at position ${financialsSheet.position}`);\r\n                            \r\n                            // Check if the target tab already exists\r\n                            if (!existingSheet) {\r\n                                let newSheet;\r\n                                let sourceSheetName;\r\n\r\n                                // Try to get the Calcs worksheet\r\n                                try {\r\n                                    const sourceCalcsWS = context.workbook.worksheets.getItem(\"Calcs\");\r\n                                    await context.sync(); // Ensure it's loaded if found\r\n                                    console.log(\"Using Calcs worksheet as template.\");\r\n                                    newSheet = sourceCalcsWS.copy();\r\n                                    sourceSheetName = \"Calcs\";\r\n                                } catch (calcsError) {\r\n                                    // If Calcs doesn't exist, use Financials as the template\r\n                                    console.warn(\"Calcs worksheet not found. Using Financials as template.\");\r\n                                    newSheet = financialsSheet.copy();\r\n                                    sourceSheetName = \"Financials\";\r\n                                    // Sync needed *after* copy to reference the new sheet object reliably\r\n                                    await context.sync(); \r\n                                    \r\n                                    // --- Load name before accessing it ---\r\n                                    newSheet.load(\"name\");\r\n                                    await context.sync();\r\n                                    // --- End Load name ---\r\n                                    \r\n                                    // --- Clear rows 10 down if copied from Financials ---\r\n                                    console.log(`Clearing contents and formats from row 10 down in new sheet ${newSheet.name} copied from ${sourceSheetName}`);\r\n                                    // Use a reasonable large row number or get last row if needed, 10000 should suffice\r\n                                    const clearRange = newSheet.getRange(\"10:10000\"); \r\n                                    clearRange.clear(Excel.ClearApplyTo.all);\r\n                                    // Do NOT sync clear yet, batch with linking below\r\n\r\n                                    // --- Link non-empty cells in rows 1-8 back to Financials ---\r\n                                    console.log(`Linking header rows (1-8) in ${newSheet.name} back to Financials`);\r\n                                    // Get used range of the new sheet to find last column\r\n                                    const usedRange = newSheet.getUsedRange(true); // Use valuesOnly = true\r\n                                    usedRange.load([\"columnCount\", \"rowCount\"]);\r\n                                    // Sync to get the used range info *before* calculating link range address\r\n                                    await context.sync();\r\n\r\n                                    const lastColIndex = usedRange.columnCount > 0 ? usedRange.columnCount - 1 : 0; \r\n                                    const lastColLetter = columnIndexToLetter(lastColIndex);\r\n                                    // Process only up to row 8\r\n                                    const linkRangeAddress = `A1:${lastColLetter}8`;\r\n\r\n                                    console.log(`Processing header link range: ${linkRangeAddress}`);\r\n                                    const linkRange = newSheet.getRange(linkRangeAddress);\r\n                                    linkRange.load(\"values\");\r\n                                    // Sync to load the values *before* iterating and setting formulas\r\n                                    await context.sync();\r\n\r\n                                    const values = linkRange.values;\r\n                                    // Batch formula setting directly\r\n                                    for (let r = 0; r < values.length; r++) {\r\n                                        const rowNum = r + 1;\r\n                                        for (let c = 0; c < values[r].length; c++) {\r\n                                            const cellValue = values[r][c];\r\n                                            if (cellValue !== null && cellValue !== \"\") {\r\n                                                const colLetter = columnIndexToLetter(c);\r\n                                                const cellAddress = `${colLetter}${rowNum}`;\r\n                                                const formula = `=Financials!${cellAddress}`;\r\n                                                // Get the specific cell and queue the formula update\r\n                                                const targetCell = newSheet.getRange(cellAddress);\r\n                                                targetCell.formulas = [[formula]];\r\n                                                // console.log(`  Queueing formula for ${cellAddress} to ${formula}`); \r\n                                            }\r\n                                        }\r\n                                    }\r\n                                    // The sync for these formula changes will happen later, along with rename/position.\r\n                                    // --- End Link header rows ---\r\n\r\n                                    // --- Set font color for rows 2-8 ---\r\n                                    console.log(`Setting font color for rows 2-8 in ${newSheet.name}`);\r\n                                    const headerFormatRangeAddress = `A2:${lastColLetter}8`;\r\n                                    const headerFormatRange = newSheet.getRange(headerFormatRangeAddress);\r\n                                    headerFormatRange.format.font.color = \"#008000\"; // Green\r\n                                    // --- End Set font color ---\r\n\r\n                                    // --- Set tab color ---\r\n                                    console.log(`Setting tab color for ${newSheet.name}`);\r\n                                    newSheet.tabColor = \"#4472C4\"; // Blue\r\n                                    // --- End Set tab color ---\r\n                                }\r\n\r\n                                // Sync copy operation if not already synced (e.g., if Calcs was used)\r\n                                // If Financials was used, sync happened before clear. If Calcs was used, sync happens here.\r\n                                if (sourceSheetName === \"Calcs\") {\r\n                                     await context.sync();\r\n                                }\r\n\r\n                                console.log(`newSheet created by copying ${sourceSheetName} worksheet`);\r\n\r\n                                // Rename it\r\n                                newSheet.name = tabName;\r\n                                console.log(\"newSheet renamed to\", tabName);\r\n\r\n                                // <<< NEW: Set position relative to Financials sheet >>>\r\n                                newSheet.position = financialsSheet.position + 1;\r\n                                console.log(`Set position of ${tabName} to ${newSheet.position}`);\r\n                                // Add to assumption tabs collection\r\n                                assumptionTabs.push({\r\n                                    name: tabName,\r\n                                    worksheet: newSheet\r\n                                }); // <-- Added closing brace and semicolon here\r\n\r\n                                currentWorksheetName = tabName;\r\n\r\n                                await context.sync(); // Sync rename and position changes\r\n\r\n                                result.createdTabs.push(tabName);\r\n                                console.log(\"Tab created successfully:\", tabName);\r\n                            // }); <-- Removed this closing parenthesis, it belongs to Excel.run below\r\n\r\n                            }\r\n\r\n                            else {\r\n                                console.log(\"Worksheet already exists:\", tabName);\r\n                                assumptionTabs.push({\r\n                                    name: tabName,\r\n                                    worksheet: existingSheet\r\n                                });\r\n                                // Need to set currentWorksheetName here too if the sheet exists\r\n                                currentWorksheetName = tabName; \r\n                            }\r\n                      \r\n       \r\n                            \r\n                         \r\n                            \r\n                            // Set the current worksheet name <-- This comment is now redundant/misplaced\r\n                       \r\n                        } catch (error) {\r\n                            console.error(\"Detailed error in TAB processing:\", error);\r\n                            throw error;\r\n                        }\r\n                    }).catch(error => { // <-- This is the correct closing for Excel.run\r\n                        console.error(`Error processing TAB code: ${error.message}`);\r\n                        result.errors.push({\r\n                            codeIndex: i,\r\n                            codeType: codeType,\r\n                            error: error.message\r\n                        });\r\n                    });\r\n                    \r\n                    continue;\r\n                }\r\n                \r\n                // Handle non-TAB codes\r\n                if (codeType !== \"TAB\") {\r\n                    await Excel.run(async (context) => {\r\n                        try {\r\n                            // Get the Codes worksheet\r\n                            const codesWS = context.workbook.worksheets.getItem(\"Codes\");\r\n                            console.log(\"Got Codes worksheet\");\r\n                            \r\n                            // Get the used range of the Codes worksheet\r\n                            const usedRange = codesWS.getUsedRange();\r\n                            usedRange.load(\"rowCount\");\r\n                            usedRange.load(\"columnCount\");\r\n                            await context.sync();\r\n                            console.log(`Used range: ${usedRange.rowCount} rows x ${usedRange.columnCount} columns`);\r\n                            \r\n                            // Get the current worksheet\r\n                            const currentWS = context.workbook.worksheets.getItem(currentWorksheetName);\r\n                            console.log(\"Got current worksheet:\", currentWorksheetName);\r\n                            \r\n                            // Get the last row in the current worksheet\r\n                            const lastUsedRow = currentWS.getUsedRange().getLastRow();\r\n                            lastUsedRow.load(\"rowIndex\");\r\n                            await context.sync();\r\n                            const pasteRow = lastUsedRow.rowIndex + 2; // Adjusted to paste one row lower\r\n                            console.log(\"Paste row:\", pasteRow);\r\n                            \r\n                            // Search for the code type in column D (index 3)\r\n                            let firstRow = -1;\r\n                            let lastRow = -1;\r\n                            \r\n                            // Load the values of column D\r\n                            const columnD = codesWS.getRange(`D1:D${usedRange.rowCount}`);\r\n                            columnD.load(\"values\");\r\n                            await context.sync();\r\n                            \r\n                            console.log(\"Loaded column D values\");\r\n                            \r\n                            // Check if values are loaded properly\r\n                            if (!columnD.values) {\r\n                                console.error(\"columnD.values is null or undefined\");\r\n                                throw new Error(`Failed to load values from column D in Codes worksheet`);\r\n                            }\r\n                            \r\n                            console.log(`columnD.values length: ${columnD.values.length}`);\r\n                            \r\n                            // Debug print the first few values in column D\r\n                            console.log(\"First 10 values in column D:\");\r\n                            for (let i = 0; i < Math.min(10, columnD.values.length); i++) {\r\n                                console.log(`Row ${i+1}: ${columnD.values[i][0]}`);\r\n                            }\r\n                            \r\n                            // Find the first and last row with the code\r\n                            for (let row = 0; row < columnD.values.length; row++) {\r\n                                if (columnD.values[row][0] === codeType) {\r\n                                    if (firstRow === -1) {\r\n                                        firstRow = row + 1; // Excel rows are 1-indexed\r\n                                    }\r\n                                    lastRow = row + 1;\r\n                                }\r\n                            }\r\n                            \r\n                            // Check if the code type was found\r\n                            const codeTypeFound = firstRow !== -1 && lastRow !== -1;\r\n                            \r\n                            if (!codeTypeFound) {\r\n                                console.warn(`Code type ${codeType} not found in Codes worksheet. Skipping this code.`);\r\n                                result.errors.push({\r\n                                    codeIndex: i,\r\n                                    codeType: codeType,\r\n                                    error: `Code type ${codeType} not found in Codes worksheet`\r\n                                });\r\n                                // Skip to the next code\r\n                                result.processedCodes++;\r\n                            } else {\r\n                                console.log(`Found code type ${codeType} in rows ${firstRow} to ${lastRow}`);\r\n                                \r\n                                // Try the suggested approach to copy the range with all properties\r\n                                await Excel.run(async (context) => {\r\n                                    // Get the source range\r\n                                    const sourceRange = context.workbook.worksheets.getItem(\"Codes\").getRange(`A${firstRow}:CX${lastRow}`);\r\n                                    \r\n                                    // Get the destination range\r\n                                    const destinationRange = context.workbook.worksheets.getItem(currentWorksheetName).getRange(`A${pasteRow}`);\r\n                                    \r\n                                    // Copy the range with all properties\r\n                                    destinationRange.copyFrom(sourceRange, Excel.RangeCopyType.all);\r\n                                    \r\n                                    await context.sync();\r\n                                });\r\n                                \r\n                                await context.sync();\r\n                                \r\n                                // Apply the driver and assumption inputs function to the current worksheet\r\n                                try {\r\n                                    console.log(`Applying driver and assumption inputs to worksheet: ${currentWorksheetName}`);\r\n                                    \r\n                                    // Get the current worksheet and load its properties\r\n                                    const currentWorksheet = context.workbook.worksheets.getItem(currentWorksheetName);\r\n                                    currentWorksheet.load('name');\r\n                                    await context.sync();\r\n                                    \r\n                                    await driverAndAssumptionInputs(\r\n                                        currentWorksheet,\r\n                                        pasteRow,\r\n                                        code\r\n                                    );\r\n                                    console.log(`Successfully applied driver and assumption inputs to worksheet: ${currentWorksheetName}`);\r\n                                } catch (error) {\r\n                                    console.error(`Error applying driver and assumption inputs: ${error.message}`);\r\n                                    result.errors.push({\r\n                                        codeIndex: i,\r\n                                        codeType: codeType,\r\n                                        error: `Error applying driver and assumption inputs: ${error.message}`\r\n                                    });\r\n                                }\r\n                                \r\n                                result.processedCodes++;\r\n                            }\r\n                        } catch (error) {\r\n                            console.error(`Error processing code ${codeType}:`, error);\r\n                            throw error;\r\n                        }\r\n                    }).catch(error => {\r\n                        console.error(`Error processing code ${codeType}: ${error.message}`);\r\n                        result.errors.push({\r\n                            codeIndex: i,\r\n                            codeType: codeType,\r\n                            error: error.message\r\n                        });\r\n                    });\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error processing code ${i}:`, error);\r\n                result.errors.push({\r\n                    codeIndex: i,\r\n                    codeType: codeType,\r\n                    error: error.message\r\n                });\r\n            }\r\n        }\r\n        \r\n        // Prepare the final result object, including the names of assumption tabs\r\n        const finalResult = {\r\n            ...result, // Includes processedCodes, errors\r\n            assumptionTabs: assumptionTabs.map(tab => tab.name) // Return only the names\r\n        };\r\n\r\n        console.log(\"runCodes finished. Returning:\", finalResult);\r\n        return finalResult; // Return the modified result object\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in runCodes:\", error);\r\n        // Consider how to return errors. Throwing stops execution.\r\n        // Returning them in the result allows the caller to decide.\r\n        throw error; // Or return { errors: [error.message], assumptionTabs: [] }\r\n    }\r\n}\r\n\r\n/**\r\n * Helper function to update cell references in formulas when rows are inserted\r\n * @param {string} formula - The formula to update\r\n * @param {number} rowOffset - The number of rows to offset\r\n * @returns {string} - The updated formula\r\n */\r\nfunction updateFormulaReferences(formula, rowOffset) {\r\n    if (!formula || !formula.startsWith('=')) {\r\n        return formula;\r\n    }\r\n    \r\n    // Regular expression to match cell references (e.g., A1, B2, etc.)\r\n    const cellRefRegex = /([A-Z]+)([0-9]+)/g;\r\n    \r\n    // Replace each cell reference with an updated one\r\n    return formula.replace(cellRefRegex, (match, col, row) => {\r\n        const rowNum = parseInt(row);\r\n        return `${col}${rowNum + rowOffset}`;\r\n    });\r\n}\r\n\r\n/**\r\n * Tests if the active cell's fill color is #CCFFCC (light green)\r\n * @returns {Promise<boolean>} - True if the active cell is green, false otherwise\r\n */\r\nexport async function isActiveCellGreen() {\r\n    try {\r\n        console.log(\"Testing if cell B2 is green (#CCFFCC)\");\r\n        \r\n        return await Excel.run(async (context) => {\r\n            // Get cell B2 instead of the active cell\r\n            const cellB2 = context.workbook.worksheets.getActiveWorksheet().getRange(\"B2\");\r\n            \r\n            // Load the fill color property and address\r\n            cellB2.load([\"format/fill/color\", \"address\"]);\r\n            \r\n            // Execute the request\r\n            await context.sync();\r\n            \r\n            // Check if the color is #CCFFCC\r\n            const isGreen = cellB2.format.fill.color === \"#CCFFCC\";\r\n            \r\n            console.log(`Cell B2 address: ${cellB2.address}, color: ${cellB2.format.fill.color}, Is green: ${isGreen}`);\r\n            \r\n            return isGreen;\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Error in isActiveCellGreen:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Processes driver and assumption inputs for a worksheet based on code parameters,\r\n * replicating the logic from the VBA Driver_and_Assumption_Inputs function.\r\n * @param {Excel.Worksheet} worksheet - The initial Excel worksheet object.\r\n * @param {number} calcsPasteRow - The starting row for finding the code block.\r\n * @param {Object} code - The code object with type and parameters.\r\n * @returns {Promise<void>}\r\n */\r\nexport async function driverAndAssumptionInputs(worksheet, calcsPasteRow, code) {\r\n    try {\r\n        // --- Load worksheet name before calling helper ---\r\n        // This requires its own context if worksheet object might not have name loaded yet\r\n        let worksheetName = 'unknown';\r\n        try {\r\n             await Excel.run(async (context) => {\r\n                 worksheet.load('name');\r\n                 await context.sync();\r\n                 worksheetName = worksheet.name;\r\n                 \r\n             });\r\n         } catch(nameLoadError) {\r\n             console.error(\"Failed to load worksheet name before calling helper\", nameLoadError);\r\n             throw new Error(\"Cannot determine worksheet name to proceed.\");\r\n         }\r\n\r\n        // Define variable to store lastRow outside Excel.run scope so we can use it later\r\n        let lastRow = 1000; // Default value in case of failure\r\n\r\n        try {\r\n            // Get a fresh worksheet reference and find the last row within a proper Excel.run context\r\n            lastRow = await Excel.run(async (context) => {    \r\n                // Get worksheet reference within THIS context by name\r\n                const currentWorksheet = context.workbook.worksheets.getItem(worksheetName);\r\n                \r\n                // Get the used range of the worksheet\r\n                const usedRange = currentWorksheet.getUsedRange();\r\n\r\n                // Get the last row within the used range\r\n                const lastRowRange = usedRange.getLastRow();\r\n\r\n                // Load the rowIndex property of the last row\r\n                lastRowRange.load(\"rowIndex\");\r\n\r\n                // Synchronize the state with the Excel document\r\n                await context.sync();\r\n\r\n                // Calculate the 1-based index of the last row\r\n                const result = lastRowRange.rowIndex + 1;\r\n                console.log('lastRow', result);\r\n                \r\n                // Return the value so it's accessible outside this Excel.run\r\n                return result;\r\n            });\r\n        } catch(lastRowError) {\r\n            console.error(\"Failed to determine last row\", lastRowError);\r\n            throw new Error(\"Cannot determine last row to proceed.\");\r\n        }\r\n\r\n        // Ensure lastRow is a valid number (helper should return 1000 on error)\r\n        if (typeof lastRow !== 'number' || lastRow <= 0) {\r\n            console.error(`Last row determination failed or returned invalid value (${lastRow}). Cannot proceed safely.`);\r\n            throw new Error(\"Failed to determine a valid last row for processing.\");\r\n        }\r\n        // --- End Determine Last Row ---\r\n\r\n        // Now, proceed with the main logic within its own Excel.run\r\n        await Excel.run(async (context) => {\r\n            // Pass the determined lastRow into this context\r\n            const determinedLastRow = lastRow; \r\n            \r\n            // Get worksheet reference within THIS context by name\r\n            const currentWorksheet = context.workbook.worksheets.getItem(worksheetName);\r\n            \r\n            // USE calcsPasteRow in console log\r\n            console.log(`Processing driver/assumption inputs for worksheet: ${worksheetName}, Code: ${code.type}, Start Row: ${calcsPasteRow}, Using Last Row: ${determinedLastRow}`);\r\n\r\n            // NEW SECTION: Convert row references to absolute for columns >= AE\r\n            // First, load all formulas from columns AE to CX for the range of interest\r\n            console.log(\"Making row references absolute for cell references in columns >= AE before row insertion\");\r\n            \r\n            const START_ROW = 10;\r\n            const TARGET_COL = \"AE\";\r\n            const END_COL = \"CX\";\r\n            \r\n            // Define range to process\r\n            let processStartRow = Math.min(calcsPasteRow, START_ROW);\r\n            let processEndRow = determinedLastRow;\r\n            \r\n            const formulaRangeAddress = `${TARGET_COL}${processStartRow}:${END_COL}${processEndRow}`;\r\n            console.log(`Loading formulas from range: ${formulaRangeAddress}`);\r\n            \r\n            try {\r\n                const formulaRange = currentWorksheet.getRange(formulaRangeAddress);\r\n                formulaRange.load(\"formulas\");\r\n                await context.sync();\r\n                \r\n                // Calculate TARGET_COL index for reference comparisons\r\n                const targetColIndex = columnLetterToIndex(TARGET_COL);\r\n                console.log(`Target column ${TARGET_COL} has index ${targetColIndex}`);\r\n                \r\n                let formulasUpdated = false;\r\n                const origFormulas = formulaRange.formulas;\r\n                const newFormulas = [];\r\n                \r\n                // Process each formula in the range\r\n                for (let r = 0; r < origFormulas.length; r++) {\r\n                    const rowFormulas = [];\r\n                    \r\n                    for (let c = 0; c < origFormulas[r].length; c++) {\r\n                        let formula = origFormulas[r][c];\r\n                        \r\n                        // Only process string formulas\r\n                        if (typeof formula === 'string') {\r\n                            // Skip if it's not a formula\r\n                            if (!formula.startsWith('=')) {\r\n                                rowFormulas.push(formula);\r\n                                continue;\r\n                            }\r\n                            \r\n                            // Find cell references (e.g., A1, B2, AA34) but exclude already absolute refs (e.g., A$1, $A$1)\r\n                            // This regex captures: group 1 = column letter(s), group 2 = row number\r\n                            // It skips references that already have $ before the row number\r\n                            const cellRefRegex = /([A-Z]+)(\\d+)(?![^\\W_])/g;\r\n                            \r\n                            // Replace with absolute row references where needed\r\n                            const originalFormula = formula;\r\n                            formula = formula.replace(cellRefRegex, (match, col, row) => {\r\n                                // Get column index\r\n                                const colIndex = columnLetterToIndex(col);\r\n                                \r\n                                // If column index is >= target column index, make row reference absolute\r\n                                if (colIndex >= targetColIndex) {\r\n                                    return `${col}$${row}`;\r\n                                }\r\n                                return match; // Keep as is for columns before TARGET_COL\r\n                            });\r\n                            \r\n                            if (formula !== originalFormula) {\r\n                                formulasUpdated = true;\r\n                                //console.log(`  Row ${processStartRow + r}, Col ${columnIndexToLetter(c + targetColIndex)}: Formula changed from '${originalFormula}' to '${formula}'`);\r\n                            }\r\n                        }\r\n                        \r\n                        rowFormulas.push(formula);\r\n                    }\r\n                    \r\n                    newFormulas.push(rowFormulas);\r\n                }\r\n                \r\n                // Only update if changes were made\r\n                if (formulasUpdated) {\r\n                    console.log(`Updating formulas with absolute row references in range ${formulaRangeAddress}`);\r\n                    formulaRange.formulas = newFormulas;\r\n                    await context.sync();\r\n                    console.log(\"Formula updates completed\");\r\n                } else {\r\n                    console.log(\"No formulas needed absolute row reference updates\");\r\n                }\r\n            } catch (formulaError) {\r\n                console.error(`Error processing formulas for absolute row references: ${formulaError.message}`, formulaError);\r\n                // Continue with the function, don't let this conversion stop the flow\r\n            }\r\n            // END NEW SECTION\r\n\r\n            const columnSequence = ['A', 'B', 'C', 'G', 'H', 'I', 'K', 'L', 'M', 'N', 'O', 'P', 'R'];\r\n            \r\n            // Get the code value\r\n            const codeValue = code.type;\r\n\r\n            // Find the search row (first row >= calcsPasteRow where CodeValue is found in Col D)\r\n            // Note: Using determinedLastRow obtained from the helper function\r\n            let searchRow = -1; // 1-based index\r\n            let searchRange = null; \r\n            let searchRangeAddress = ''; \r\n\r\n            try {\r\n                // USE calcsPasteRow in console log\r\n                console.log(`Attempting to get searchRange. calcsPasteRow: ${calcsPasteRow}, determinedLastRow: ${determinedLastRow}`);\r\n                // USE calcsPasteRow in condition\r\n                if (typeof calcsPasteRow !== 'number' || typeof determinedLastRow !== 'number' || calcsPasteRow <= 0 || determinedLastRow < calcsPasteRow) {\r\n                     console.error(`Invalid range parameters for searchRange: calcsPasteRow=${calcsPasteRow}, determinedLastRow=${determinedLastRow}. Skipping search.`);\r\n                     searchRow = -1; \r\n                 } else {\r\n                     // USE calcsPasteRow for search range address\r\n                     searchRangeAddress = `D${calcsPasteRow}:D${determinedLastRow}`;\r\n                     console.log(`Creating searchRange with address: ${searchRangeAddress}`);\r\n                     // Need to use the worksheet object available in *this* context\r\n                     searchRange = currentWorksheet.getRange(searchRangeAddress);\r\n\r\n                     console.log(`Loading values for searchRange: ${searchRangeAddress}`);\r\n                     searchRange.load('values');\r\n                     await context.sync();\r\n                     console.log(`Successfully loaded values for searchRange: ${searchRangeAddress}`);\r\n                 }\r\n\r\n            } catch (loadError) {\r\n                 console.error(`Error loading/syncing searchRange (${searchRangeAddress}): ${loadError.message}`, loadError);\r\n                 searchRow = -1; \r\n            }\r\n\r\n            // Check if searchRange was successfully created and loaded before accessing .values\r\n            if (searchRange && searchRange.values) { // Check searchRange first!\r\n                 console.log(`SearchRange (${searchRangeAddress}) has loaded values. Searching for codeValue: ${codeValue}`);\r\n                 for (let i = 0; i < searchRange.values.length; i++) {\r\n                    if (searchRange.values[i][0] === codeValue) {\r\n                        // USE calcsPasteRow to calculate searchRow\r\n                        searchRow = calcsPasteRow + i; // Found the row (1-based)\r\n                        console.log(`Found codeValue '${codeValue}' at index ${i}, resulting searchRow: ${searchRow}`);\r\n                        break;\r\n                    }\r\n                }\r\n                 if (searchRow === -1) { // If loop finished without finding\r\n                     console.log(`CodeValue '${codeValue}' not found within the loaded values of searchRange (${searchRangeAddress}).`);\r\n                 }\r\n            } else if (searchRow !== -1) { // Only log warning if we didn't already hit the loadError or invalid params\r\n                 console.warn(`searchRange (${searchRangeAddress}) object exists but '.values' property is not available after sync. Search cannot be performed.`);\r\n                 searchRow = -1; // Ensure we trigger the \"not found\" logic\r\n            }\r\n\r\n            if (searchRow === -1) {\r\n                 console.warn(`Code type ${codeValue} not found or could not be searched for in column D (Range: ${searchRangeAddress || 'Invalid'}). Skipping inputs for this code.`);\r\n                 return; // Exit if code not found or search failed\r\n            }\r\n            console.log(`Found code ${codeValue} at search row: ${searchRow}`);\r\n\r\n\r\n            // Find the check row (first row >= searchrow where Col B is not light green #CCFFCC)\r\n            // VBA: Do While .Cells(checkrow, 2).Interior.Color = RGB(204, 255, 204)\r\n            let checkRow = searchRow;\r\n            let isGreen = true;\r\n            while (isGreen) {\r\n                const cellB = currentWorksheet.getRange(`B${checkRow}`);\r\n                cellB.load('format/fill/color');\r\n                await context.sync();\r\n                 // Handle potential errors if cell color can't be loaded\r\n                 if (cellB.format && cellB.format.fill) {\r\n                    isGreen = cellB.format.fill.color === '#CCFFCC';\r\n                 } else {\r\n                     console.warn(`Could not read fill color for cell B${checkRow}. Assuming not green.`);\r\n                     isGreen = false; // Assume not green if color cannot be determined\r\n                 }\r\n\r\n                if (isGreen) {\r\n                    checkRow++;\r\n                    // Add a safety break condition?\r\n                    if (checkRow > determinedLastRow + 50) { // Use determinedLastRow\r\n                         console.error(\"Check row exceeded expected limits. Breaking loop.\");\r\n                         throw new Error(\"Failed to find non-green check row within reasonable bounds.\");\r\n                    }\r\n                }\r\n            }\r\n            console.log(`Found check row (first non-green row in B at/after search row): ${checkRow}`);\r\n\r\n\r\n            // Process drivers, labels, and financialsdriver (relative to searchRow)\r\n            for (let k = 1; k <= 9; k++) {\r\n                const targetRow = searchRow + k - 1;\r\n                if (targetRow > determinedLastRow + 20) { // Safety check: Don't write way past the data\r\n                    console.warn(`Target row ${targetRow} seems too high. Skipping write for k=${k}.`);\r\n                    continue;\r\n                }\r\n\r\n                // Financials Driver (only for k=1)\r\n                if (k === 1 && code.params.financialsdriver) {\r\n                    const finDriverCell = currentWorksheet.getRange(`I${targetRow}`);\r\n                    finDriverCell.values = [[code.params.financialsdriver]];\r\n                    console.log(`Set financialsdriver at I${targetRow}: ${code.params.financialsdriver}`);\r\n                }\r\n\r\n                // Driver\r\n                const driverParam = code.params[`driver${k}`];\r\n                if (driverParam) {\r\n                    const driverCell = currentWorksheet.getRange(`F${targetRow}`);\r\n                    driverCell.values = [[driverParam]];\r\n                     console.log(`Set driver${k} at F${targetRow}: ${driverParam}`);\r\n                }\r\n\r\n                // Label\r\n                const labelParam = code.params[`label${k}`];\r\n                if (labelParam) {\r\n                    const labelCell = currentWorksheet.getRange(`B${targetRow}`);\r\n                    labelCell.values = [[labelParam]];\r\n                     console.log(`Set label${k} at B${targetRow}: ${labelParam}`);\r\n                }\r\n            }\r\n            await context.sync(); // Sync after loop for efficiency\r\n\r\n\r\n            // Process row items (inserting rows relative to checkRow)\r\n            let currentCheckRowForInserts = checkRow; // Use a separate variable to track cumulative insertions correctly\r\n            for (let g = 1; g <= 200; g++) { // Max 200 row parameters as in VBA\r\n                const rowParam = code.params[`row${g}`];\r\n                if (!rowParam) continue; // Skip if rowg parameter doesn't exist\r\n\r\n                 console.log(`Processing row${g}: ${rowParam}`);\r\n\r\n                const rowItems = rowParam.split('*');\r\n                const numNewRows = rowItems.length - 1; // Number of rows to insert\r\n\r\n                // Calculate the 1-based row number *before* potential insertions for this 'g' iteration\r\n                // This takes into account rows inserted by previous 'g' loops via currentCheckRowForInserts\r\n                const baseRowForThisG = currentCheckRowForInserts + g - 1;\r\n                console.log(`Base row for row${g}: ${baseRowForThisG}, numNewRows: ${numNewRows}`);\r\n\r\n                if (numNewRows > 0) {\r\n                    // Insert new rows below the baseRowForThisG\r\n                    const insertStartAddress = `${baseRowForThisG + 1}:${baseRowForThisG + numNewRows}`;\r\n                    console.log(`Inserting ${numNewRows} rows at ${insertStartAddress}`);\r\n                    const insertRange = currentWorksheet.getRange(insertStartAddress);\r\n                    insertRange.insert(Excel.InsertShiftDirection.down);\r\n                    await context.sync(); // Sync after insert\r\n\r\n                    // Sequentially copy formats and formulas from the previous row to the newly inserted ones\r\n                    // This helps ensure relative formulas are adjusted correctly step-by-step\r\n                    console.log(`Copying formats/formulas sequentially for inserted rows.`);\r\n                    for (let i = 0; i < numNewRows; i++) {\r\n                        const sourceRowNum = baseRowForThisG + i;\r\n                        const targetRowNum = baseRowForThisG + i + 1; // The newly inserted row\r\n                        const sourceRowRange = currentWorksheet.getRange(`${sourceRowNum}:${sourceRowNum}`);\r\n                        const targetRowRange = currentWorksheet.getRange(`${targetRowNum}:${targetRowNum}`);\r\n\r\n                        // Copy formats\r\n                        console.log(`  Copying formats from row ${sourceRowNum} to ${targetRowNum}`);\r\n                        targetRowRange.copyFrom(sourceRowRange, Excel.RangeCopyType.formats);\r\n\r\n                        // Copy formulas (should adjust relative references)\r\n                        console.log(`  Copying formulas from row ${sourceRowNum} to ${targetRowNum}`);\r\n                        targetRowRange.copyFrom(sourceRowRange, Excel.RangeCopyType.formulas);\r\n\r\n                        // We could use RangeCopyType.all, but separate copy ensures population step overrides values cleanly.\r\n                    }\r\n                    await context.sync(); // Sync after all copies for this 'g' group are done\r\n                    console.log(\"Finished sequential copy for inserted rows.\");\r\n                }\r\n\r\n                // Populate the row(s) (original row + inserted rows)\r\n                // This runs AFTER rows are inserted and structure (formats/formulas) is copied.\r\n                for (let yy = 0; yy <= numNewRows; yy++) {\r\n                    const currentRowNum = baseRowForThisG + yy; // 1-based row number to write to\r\n                    const splitArray = rowItems[yy].split('|');\r\n                    console.log(`Populating row ${currentRowNum} with items: ${rowItems[yy]}`);\r\n\r\n                    for (let x = 0; x < splitArray.length; x++) {\r\n                        // Check bounds for columnSequence\r\n                        if (x >= columnSequence.length) {\r\n                            console.warn(`Data item index ${x} exceeds columnSequence length (${columnSequence.length}). Skipping.`);\r\n                            continue;\r\n                        }\r\n\r\n                        const valueToWrite = splitArray[x];\r\n                        // VBA check: If splitArray(x) <> \"\" And splitArray(x) <> \"F\" Then\r\n                        // 'F' likely means \"Formula\", so we don't overwrite if the value is 'F'.\r\n                        if (valueToWrite && valueToWrite.toUpperCase() !== 'F') {\r\n                            const colLetter = columnSequence[x];\r\n                            const cellToWrite = currentWorksheet.getRange(`${colLetter}${currentRowNum}`);\r\n                            // Attempt to infer data type (basic number check)\r\n                            const numValue = Number(valueToWrite);\r\n                            if (!isNaN(numValue) && valueToWrite.trim() !== '') {\r\n                                cellToWrite.values = [[numValue]];\r\n                            } else {\r\n                                // Preserve existing value if empty string, otherwise write text\r\n                                if (valueToWrite.trim() !== '') {\r\n                                    cellToWrite.values = [[valueToWrite]];\r\n                                }\r\n                            }\r\n                            // console.log(`  Wrote '${valueToWrite}' to ${colLetter}${currentRowNum}`);\r\n                        }\r\n                    }\r\n                }\r\n                await context.sync(); // Sync after populating each 'g' group\r\n\r\n                // Adjust the base check row marker for subsequent 'g' iterations\r\n                // by adding the number of rows inserted in *this* iteration.\r\n                currentCheckRowForInserts += numNewRows;\r\n                console.log(`Finished processing row${g}. currentCheckRowForInserts is now ${currentCheckRowForInserts}`);\r\n\r\n            } // End for g loop\r\n\r\n            console.log(`Completed processing driver and assumption inputs for code ${codeValue} in worksheet ${worksheetName}`);\r\n        }); // End main Excel.run\r\n    } catch (error) {\r\n        console.error(`Error in driverAndAssumptionInputs MAIN CATCH for code '${code.type}' in worksheet '${worksheet?.name || 'unknown'}': ${error.message}`, error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Finds the last used row in a specific column of a worksheet.\r\n * @param {Excel.Worksheet} worksheet - The worksheet to search in.\r\n * @param {string} columnLetter - The column letter (e.g., \"B\").\r\n * @returns {Promise<number>} - The 1-based index of the last used row, or 0 if the column is empty or an error occurs.\r\n */\r\nasync function getLastUsedRow(worksheet, columnLetter) {\r\n    // Re-use worksheet object passed into the function within this Excel.run\r\n    // Need context from the caller's Excel.run or wrap this in its own\r\n    console.log(`Attempting to get last used row for column ${columnLetter} in sheet ${worksheet.name}`);\r\n    try {\r\n        // It's safer to re-get the worksheet by name if this is called outside the main loop's context\r\n        // However, if called within the loop's context, using the passed object is fine.\r\n        // For simplicity assuming it's called within a valid context for now.\r\n        const fullColumn = worksheet.getRange(`${columnLetter}:${columnLetter}`);\r\n        const usedRange = fullColumn.getUsedRange(true); // Use 'true' for valuesOnly parameter\r\n        const lastCell = usedRange.getLastCell();\r\n        lastCell.load(\"rowIndex\");\r\n        await worksheet.context.sync(); // Use the context associated with the worksheet object\r\n        const lastRowIndex = lastCell.rowIndex + 1; // Convert 0-based index to 1-based row number\r\n        console.log(`Last used row in column ${columnLetter} is ${lastRowIndex}`);\r\n        return lastRowIndex;\r\n    } catch (error) {\r\n        // Handle cases where the column might be completely empty or other errors\r\n        if (error.code === \"ItemNotFound\" || error.code === \"GeneralException\") {\r\n            console.warn(`Could not find used range or last cell in column ${columnLetter} of sheet ${worksheet.name}. Assuming empty or header only (returning 0).`);\r\n            return 0; // Return 0 if column is empty or error occurs\r\n        }\r\n        console.error(`Error in getLastUsedRow for column ${columnLetter} on sheet ${worksheet.name}:`, error);\r\n        // It's often better to let the caller handle the error if it's unexpected.\r\n        throw error; // Re-throw other errors\r\n    }\r\n    // Note: Removed the inner Excel.run as it complicates context management.\r\n    // This function now expects to be called *within* an existing Excel.run context.\r\n}\r\n\r\n/**\r\n * Adjusts driver references in column AE based on lookups in column A.\r\n * Replicates the core logic of VBA Adjust_Drivers.\r\n * @param {Excel.Worksheet} worksheet - The assumption worksheet (within an Excel.run context).\r\n * @param {number} lastRow - The last row to process (inclusive).\r\n */\r\nasync function adjustDriversJS(worksheet, lastRow) {\r\n    const START_ROW = 10; // <<< CHANGED FROM 9\r\n    const DRIVER_CODE_COL = \"F\"; // Column containing the driver code to look up\r\n    const LOOKUP_COL = \"A\";      // Column to search for the driver code\r\n    const TARGET_COL = \"AE\";     // Column where the result address string is written\r\n\r\n    console.log(`Running adjustDriversJS for sheet: ${worksheet.name} from row ${START_ROW} to ${lastRow}`);\r\n\r\n    // Ensure lastRow is valid before proceeding\r\n    if (lastRow < START_ROW) {\r\n        console.warn(`adjustDriversJS: lastRow (${lastRow}) is less than START_ROW (${START_ROW}). Skipping.`);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        // Define the ranges to load\r\n        const driverCodeRangeAddress = `${DRIVER_CODE_COL}${START_ROW}:${DRIVER_CODE_COL}${lastRow}`;\r\n        const lookupRangeAddress = `${LOOKUP_COL}${START_ROW}:${LOOKUP_COL}${lastRow}`;\r\n        const driverCodeRange = worksheet.getRange(driverCodeRangeAddress);\r\n        const lookupRange = worksheet.getRange(lookupRangeAddress);\r\n\r\n        // Load values from both columns\r\n        driverCodeRange.load(\"values\");\r\n        lookupRange.load(\"values\");\r\n        await worksheet.context.sync(); // Sync to get the values\r\n\r\n        const driverCodeValues = driverCodeRange.values;\r\n        const lookupValues = lookupRange.values;\r\n\r\n        // Create a map for efficient lookup: { lookupValue: rowIndex }\r\n        // Note: rowIndex here is the 1-based Excel row number\r\n        const lookupMap = new Map();\r\n        for (let i = 0; i < lookupValues.length; i++) {\r\n            const value = lookupValues[i][0];\r\n            // Only add non-empty values to the map. Handle potential duplicates?\r\n            // VBA's .Find typically finds the first match. Map naturally stores the last encountered.\r\n            if (value !== null && value !== \"\") {\r\n                 // The row number in Excel is START_ROW + index\r\n                lookupMap.set(value, START_ROW + i);\r\n            }\r\n        }\r\n        console.log(`Built lookup map from ${LOOKUP_COL}${START_ROW}:${LOOKUP_COL}${lastRow} with ${lookupMap.size} entries.`);\r\n\r\n        // Prepare the output values for the target column AE\r\n        // Initialize with nulls or empty strings to clear previous values potentially\r\n        const outputValues = []; // Array of arrays for Excel range: [[value1], [value2], ...]\r\n        let foundCount = 0;\r\n        let notFoundCount = 0;\r\n\r\n        for (let i = 0; i < driverCodeValues.length; i++) {\r\n            const driverCode = driverCodeValues[i][0];\r\n            const currentRow = START_ROW + i; // Current Excel row being processed\r\n\r\n            if (driverCode !== null && driverCode !== \"\") {\r\n                if (lookupMap.has(driverCode)) {\r\n                    const foundRow = lookupMap.get(driverCode);\r\n                    const targetAddress = `${TARGET_COL}${foundRow}`;\r\n                    outputValues.push([targetAddress]); // Store as [[value]] for range write\r\n                    foundCount++;\r\n                    // console.log(`Row ${currentRow} (${DRIVER_CODE_COL}): Found '${driverCode}' in ${LOOKUP_COL} at row ${foundRow}. Setting ${TARGET_COL}${currentRow} = '${targetAddress}'`);\r\n                } else {\r\n                    // Value in F not found in A\r\n                    console.warn(`adjustDriversJS: Driver code '${driverCode}' from cell ${DRIVER_CODE_COL}${currentRow} not found in range ${lookupRangeAddress}.`);\r\n                    outputValues.push([null]); // Or [\"\"] or keep existing? VBA doesn't explicitly clear. Using null.\r\n                    notFoundCount++;\r\n                }\r\n            } else {\r\n                // Empty cell in F, write null to corresponding AE cell\r\n                outputValues.push([null]);\r\n            }\r\n        }\r\n\r\n        // Write the results back to column AE\r\n        if (outputValues.length > 0) {\r\n            const targetRangeAddress = `${TARGET_COL}${START_ROW}:${TARGET_COL}${lastRow}`;\r\n            const targetRange = worksheet.getRange(targetRangeAddress);\r\n            console.log(`Writing ${foundCount} results (${notFoundCount} not found) to ${targetRangeAddress}`);\r\n            targetRange.values = outputValues;\r\n            // Sync will happen in the caller's context\r\n        } else {\r\n             console.log(`adjustDriversJS: No values to write to ${TARGET_COL}.`);\r\n        }\r\n\r\n    } catch (error) {\r\n        console.error(`Error in adjustDriversJS for sheet ${worksheet.name}:`, error);\r\n        // Decide if error should be re-thrown to stop the whole process\r\n        // throw error;\r\n    }\r\n    // No context.sync() here - it should be handled by the calling function (processAssumptionTabs)\r\n}\r\n\r\n/**\r\n * Replaces INDIRECT functions in a specified column range with their evaluated values.\r\n * Mimics the VBA Replace_Indirects logic using batched range value lookups.\r\n * @param {Excel.Worksheet} worksheet - The assumption worksheet (within an Excel.run context).\r\n * @param {number} lastRow - The last row to process.\r\n */\r\nasync function replaceIndirectsJS(worksheet, lastRow) {\r\n    const START_ROW = 10; // <<< CHANGED FROM 9\r\n    const TARGET_COL = \"AE\";\r\n\r\n    console.log(`Running replaceIndirectsJS for sheet: ${worksheet.name} from row ${START_ROW} to ${lastRow}`);\r\n\r\n    if (lastRow < START_ROW) {\r\n        console.warn(`replaceIndirectsJS: lastRow (${lastRow}) is less than START_ROW (${START_ROW}). Skipping.`);\r\n        return;\r\n    }\r\n\r\n    const targetRangeAddress = `${TARGET_COL}${START_ROW}:${TARGET_COL}${lastRow}`;\r\n    const targetRange = worksheet.getRange(targetRangeAddress);\r\n\r\n    try {\r\n        // 1. Load formulas from the target range\r\n        targetRange.load(\"formulas\");\r\n        await worksheet.context.sync();\r\n\r\n        const originalFormulas = targetRange.formulas; // 2D array [[f1], [f2], ...]\r\n        const referencesToLookup = new Map(); // Map<string, { range: Excel.Range | null, value: any }>\r\n        const formulaData = []; // Array<{ originalFormula: string, index: number }>\r\n\r\n        // 2. First Pass: Identify all unique INDIRECT arguments\r\n        console.log(\"Replace_Indirects: Pass 1 - Identifying INDIRECT arguments\");\r\n        for (let i = 0; i < originalFormulas.length; i++) {\r\n            let formula = originalFormulas[i][0];\r\n            formulaData.push({ originalFormula: formula, index: i }); // Store original formula and index\r\n\r\n            if (typeof formula === 'string') {\r\n                // Use a loop to find all INDIRECT occurrences in a single formula\r\n                let searchStartIndex = 0;\r\n                while (true) {\r\n                    const upperFormula = formula.toUpperCase();\r\n                    const indirectStartIndex = upperFormula.indexOf(\"INDIRECT(\", searchStartIndex);\r\n\r\n                    // Stop if no more INDIRECT found or if it might be part of INDEX\r\n                    if (indirectStartIndex === -1 || upperFormula.includes(\"INDEX(\")) {\r\n                        break;\r\n                    }\r\n\r\n                    // Find the matching closing parenthesis (simple approach)\r\n                    const parenStartIndex = indirectStartIndex + \"INDIRECT(\".length;\r\n                    const parenEndIndex = formula.indexOf(\")\", parenStartIndex);\r\n\r\n                    if (parenEndIndex === -1) {\r\n                        console.warn(`Row ${START_ROW + i}: Malformed INDIRECT found in formula: ${formula}`);\r\n                        break; // Cannot process this INDIRECT\r\n                    }\r\n\r\n                    const argString = formula.substring(parenStartIndex, parenEndIndex).trim();\r\n\r\n                    // Validate argString looks like a cell/range reference (basic check)\r\n                    // This helps avoid trying to load ranges like \"Sheet1!A:A\" which might fail or be slow\r\n                    if (argString && /^[A-Za-z0-9_!$:'\". ]+$/.test(argString) && !referencesToLookup.has(argString)) {\r\n                         console.log(`  Found reference to lookup: ${argString}`);\r\n                         referencesToLookup.set(argString, { range: null, value: undefined }); // Placeholder\r\n                    }\r\n\r\n                    // Continue searching after this INDIRECT\r\n                    searchStartIndex = parenEndIndex + 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        // 3. Batch Load Values for identified references\r\n        console.log(`Replace_Indirects: Loading values for ${referencesToLookup.size} unique references.`);\r\n        if (referencesToLookup.size > 0) {\r\n            for (const [refString, data] of referencesToLookup.entries()) {\r\n                try {\r\n                    // Attempt to get the range and load its value\r\n                    data.range = worksheet.getRange(refString);\r\n                    // Load values. Consider loading formulas too if INDIRECT might point to a formula cell.\r\n                    // Loading numberFormat might help distinguish between 0 and empty.\r\n                    data.range.load([\"values\", \"text\"]); // Load text to handle \"DELETE\" easily\r\n                } catch (rangeError) {\r\n                    console.warn(`Replace_Indirects: Error getting range for reference \"${refString}\". It might be invalid or on another sheet.`, rangeError.debugInfo || rangeError.message);\r\n                     // Keep data.range as null, will be handled later\r\n                    referencesToLookup.set(refString, { range: null, value: '#REF!' }); // Mark as error\r\n                }\r\n            }\r\n            await worksheet.context.sync(); // Sync all loaded values\r\n\r\n            // Populate the values in the map\r\n            for (const [refString, data] of referencesToLookup.entries()) {\r\n                 if (data.range) { // If range was successfully retrieved\r\n                     try {\r\n                         // Use .text to directly compare with \"DELETE\"\r\n                         // Use .values for the actual numeric/boolean value if not \"DELETE\"\r\n                        const cellText = data.range.text[0][0];\r\n                        if (cellText === \"DELETE\") {\r\n                            data.value = \"0\"; // Replace \"DELETE\" with \"0\" string as per VBA\r\n                        } else {\r\n                             // Use the actual value (could be string, number, boolean)\r\n                             // Prefer values[0][0] as it respects data types better than text\r\n                             data.value = data.range.values[0][0];\r\n                        }\r\n                     } catch (valueError) {\r\n                         console.warn(`Replace_Indirects: Error reading value for reference \"${refString}\" after sync.`, valueError.debugInfo || valueError.message);\r\n                         data.value = '#VALUE!'; // Or another suitable error indicator\r\n                     }\r\n                 }\r\n                 // If data.range was null or value fetch failed, data.value remains '#REF!' or '#VALUE!'\r\n            }\r\n             console.log(\"Replace_Indirects: Finished loading reference values.\");\r\n        }\r\n\r\n\r\n        // 4. Second Pass: Replace INDIRECT with looked-up values\r\n        console.log(\"Replace_Indirects: Pass 2 - Replacing INDIRECT calls.\");\r\n        const newFormulas = []; // Array of arrays: [[newF1], [newF2], ...]\r\n        \r\n        // Calculate TARGET_COL index for reference comparisons\r\n        const targetColIndex = columnLetterToIndex(TARGET_COL);\r\n        console.log(`Target column ${TARGET_COL} has index ${targetColIndex}`);\r\n        \r\n        for (const item of formulaData) {\r\n            let currentFormula = item.originalFormula;\r\n\r\n            if (typeof currentFormula === 'string') {\r\n                let loopCount = 0; // Safety break\r\n                const MAX_LOOPS = 20; // Prevent infinite loops for complex/circular cases\r\n\r\n                while (loopCount < MAX_LOOPS) {\r\n                    const upperFormula = currentFormula.toUpperCase();\r\n                    const indirectStartIndex = upperFormula.indexOf(\"INDIRECT(\");\r\n\r\n                    if (indirectStartIndex === -1 || upperFormula.includes(\"INDEX(\")) {\r\n                        break; // No more INDIRECTs (or INDEX present)\r\n                    }\r\n\r\n                    const parenStartIndex = indirectStartIndex + \"INDIRECT(\".length;\r\n                    const parenEndIndex = currentFormula.indexOf(\")\", parenStartIndex);\r\n\r\n                    if (parenEndIndex === -1) {\r\n                         // Already warned in pass 1, just break here\r\n                        break;\r\n                    }\r\n\r\n                    const indString = currentFormula.substring(indirectStartIndex, parenEndIndex + 1); // The full INDIRECT(...)\r\n                    const argString = currentFormula.substring(parenStartIndex, parenEndIndex).trim();\r\n\r\n                    let directRef = '#REF!'; // Default if lookup fails\r\n                     if (referencesToLookup.has(argString)) {\r\n                         directRef = referencesToLookup.get(argString).value;\r\n                     } else {\r\n                         // Argument wasn't identified/loaded (maybe invalid?)\r\n                         console.warn(`Row ${START_ROW + item.index}: INDIRECT argument \"${argString}\" not found in lookup map during replacement.`);\r\n                     }\r\n\r\n                    // Handle potential null/undefined values from lookup - treat as 0? VBA doesn't explicitly handle this.\r\n                    // Let's treat null/undefined as 0 for replacement to avoid inserting 'null' or 'undefined' into formulas.\r\n                     // Empty string \"\" should probably remain \"\" unless it was \"DELETE\".\r\n                     if (directRef === null || typeof directRef === 'undefined') {\r\n                         directRef = 0; // Replace null/undefined with numeric 0\r\n                     } else if (directRef === \"\") {\r\n                          // Keep empty string as empty string unless it was originally \"DELETE\"\r\n                          // The map handles \"DELETE\" -> \"0\" already\r\n                     } else if (typeof directRef === 'string') {\r\n                         // If the resolved value is a string, potentially needs quoting if replacing in a formula context?\r\n                         // VBA seems to just concatenate the value directly. Let's follow that.\r\n                         // Example: =SUM(INDIRECT(\"A1\")) where A1 contains \"B2\" becomes =SUM(B2)\r\n                         // Example: =CONCATENATE(\"Result: \",INDIRECT(\"A1\")) where A1 contains \"Success\" becomes =CONCATENATE(\"Result: \",\"Success\") - requires quotes?\r\n                         // VBA appears to handle this implicitly. JS replace won't add quotes.\r\n                         // Let's test behavior, may need adjustment if it breaks formulas expecting strings.\r\n                         // For now, direct replacement. Consider adding quotes if `directRef` is text AND the context requires it.\r\n                     } else if (typeof directRef === 'boolean') {\r\n                         directRef = directRef ? 'TRUE' : 'FALSE'; // Convert boolean to formula text\r\n                     }\r\n                     // Numeric values are fine as is.\r\n\r\n                    // Perform the replacement. Use replace directly on the found indString.\r\n                    currentFormula = currentFormula.replace(indString, String(directRef));\r\n                    loopCount++;\r\n\r\n                } // End while loop for single formula processing\r\n\r\n                if (loopCount === MAX_LOOPS) {\r\n                    console.warn(`Row ${START_ROW + item.index}: Max replacement loops reached for formula. Result might be incomplete: ${currentFormula}`);\r\n                }\r\n                \r\n                // NEW SECTION: Convert row references to absolute for columns >= TARGET_COL\r\n                if (typeof currentFormula === 'string') {\r\n                    console.log(`Making row references absolute for cell references in columns >= ${TARGET_COL} in row ${START_ROW + item.index}`);\r\n                    \r\n                    // Find cell references (e.g., A1, B2, AA34) but exclude already absolute refs (e.g., A$1, $A$1)\r\n                    // This regex captures: group 1 = column letter(s), group 2 = row number\r\n                    // It skips references that already have $ before the row number\r\n                    const cellRefRegex = /([A-Z]+)(\\d+)(?![^\\W_])/g;\r\n                    \r\n                    // Replace with absolute row references where needed\r\n                    currentFormula = currentFormula.replace(cellRefRegex, (match, col, row) => {\r\n                        // Get column index\r\n                        const colIndex = columnLetterToIndex(col);\r\n                        \r\n                        // If column index is >= target column index, make row reference absolute\r\n                        if (colIndex >= targetColIndex) {\r\n                            return `${col}$${row}`;\r\n                        }\r\n                        return match; // Keep as is for columns before TARGET_COL\r\n                    });\r\n                    \r\n                    console.log(`  Formula after converting to absolute row refs: ${currentFormula}`);\r\n                }\r\n                // END NEW SECTION\r\n            }\r\n            \r\n            // Add the processed formula (or original if not string/no INDIRECT) to the result array\r\n            newFormulas.push([currentFormula]);\r\n\r\n        } // End for loop processing all formulas\r\n\r\n        // 5. Write the modified formulas back to the range\r\n        console.log(`Replace_Indirects: Writing ${newFormulas.length} updated formulas back to ${targetRangeAddress}`);\r\n        targetRange.formulas = newFormulas;\r\n\r\n        // Sync is handled by the caller (processAssumptionTabs)\r\n\r\n    } catch (error) {\r\n        console.error(`Error in replaceIndirectsJS for sheet ${worksheet.name} range ${targetRangeAddress}:`, error.debugInfo || error);\r\n        // Re-throw the error to allow the calling function to handle it\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Placeholder for Populate_Financials VBA logic.\r\n * Populates the \"Financials\" sheet based on codes in the assumption sheet.\r\n * @param {Excel.Worksheet} worksheet - The assumption worksheet (within an Excel.run context).\r\n * @param {number} lastRow - The last row to process in the assumption sheet.\r\n * @param {Excel.Worksheet} financialsSheet - The \"Financials\" worksheet (within the same Excel.run context).\r\n */\r\nasync function populateFinancialsJS(worksheet, lastRow, financialsSheet) {\r\n    console.log(`Running populateFinancialsJS for sheet: ${worksheet.name} (lastRow: ${lastRow}) -> ${financialsSheet.name}`);\r\n    // This function MUST be called within an Excel.run context.\r\n\r\n    const CALCS_FIRST_ROW = 10; // <<< CHANGED FROM 9 // Same as START_ROW elsewhere\r\n    const ASSUMPTION_CODE_COL = \"C\"; // Column with code to lookup on assumption sheet\r\n    const ASSUMPTION_LINK_COL_B = \"B\";\r\n    const ASSUMPTION_LINK_COL_D = \"D\";\r\n    // Column on assumption sheet to link for monthly data\r\n    const ASSUMPTION_MONTHS_START_COL = \"AE\";\r\n\r\n    const FINANCIALS_CODE_COLUMN = \"I\"; // Column to search for code on Financials sheet\r\n    const FINANCIALS_TARGET_COL_B = \"B\";\r\n    const FINANCIALS_TARGET_COL_D = \"D\";\r\n    const FINANCIALS_ANNUALS_START_COL = \"J\"; // Annuals start here\r\n    const FINANCIALS_MONTHS_START_COL = \"AE\"; // Months start here\r\n\r\n    // --- Updated Column Definitions ---\r\n    const ANNUALS_END_COL = \"P\";       // Annuals end here\r\n    const MONTHS_END_COL = \"CX\";       // Months end here\r\n    // --- End Updated Column Definitions ---\r\n\r\n    // Formatting constants\r\n    // const PURPLE_COLOR = \"#800080\"; // RGB(128, 0, 128) - Removed as Actuals section is removed\r\n    const GREEN_COLOR = \"#008000\";  // RGB(0, 128, 0)\r\n    const CURRENCY_FORMAT = '_(* $#,##0_);_(* $(#,##0);_(* \"$\" -_);_(@_)';\r\n\r\n    // Ensure lastRow is valid\r\n    if (lastRow < CALCS_FIRST_ROW) {\r\n        console.warn(`populateFinancialsJS: lastRow (${lastRow}) is less than CALCS_FIRST_ROW (${CALCS_FIRST_ROW}). Skipping.`);\r\n        return;\r\n    }\r\n\r\n    try {\r\n        // 1. Load data from Assumption Sheet\r\n        console.log(`populateFinancialsJS: Loading assumption data up to row ${lastRow}`);\r\n        const assumptionCodeRange = worksheet.getRange(`${ASSUMPTION_CODE_COL}${CALCS_FIRST_ROW}:${ASSUMPTION_CODE_COL}${lastRow}`);\r\n        // No need to load B, D, AE addresses/values here anymore if only used for linking\r\n\r\n        assumptionCodeRange.load(\"values\");\r\n\r\n        // 2. Load data from Financials Sheet (Find last row in code column I)\r\n        const financialsSearchCol = financialsSheet.getRange(`${FINANCIALS_CODE_COLUMN}:${FINANCIALS_CODE_COLUMN}`);\r\n        const financialsUsedRange = financialsSearchCol.getUsedRange(true);\r\n        financialsUsedRange.load(\"rowCount\");\r\n        // It's okay to sync assumption and initial financials loads together\r\n        // await worksheet.context.sync(); // Removed intermediate sync\r\n\r\n        let financialsLastRow = 0;\r\n        // Sync financials rowCount load before calculating financialsLastRow\r\n        await worksheet.context.sync();\r\n        if (financialsUsedRange.rowCount > 0) {\r\n           try {\r\n              const lastCell = financialsUsedRange.getLastCell();\r\n              lastCell.load(\"rowIndex\");\r\n               await worksheet.context.sync();\r\n              financialsLastRow = lastCell.rowIndex + 1;\r\n           } catch(e) {\r\n               console.warn(`Could not get last cell directly for Financials col ${FINANCIALS_CODE_COLUMN}. Error: ${e.message}. Attempting fallback range loading.`);\r\n               try {\r\n                   // Use a potentially more reliable column like B for last row fallback\r\n                   const fallbackRange = financialsSheet.getRange(`${FINANCIALS_TARGET_COL_B}1:${FINANCIALS_TARGET_COL_B}10000`); // Check Col B\r\n                   fallbackRange.load(\"values\");\r\n                   await worksheet.context.sync();\r\n                   for (let i = fallbackRange.values.length - 1; i >= 0; i--) {\r\n                       if (fallbackRange.values[i][0] !== null && fallbackRange.values[i][0] !== \"\") {\r\n                           financialsLastRow = i + 1;\r\n                           break;\r\n                       }\r\n                   }\r\n                   if (financialsLastRow === 0) console.warn(`Fallback range load for Financials col ${FINANCIALS_TARGET_COL_B} also yielded no data.`);\r\n               } catch (fallbackError) {\r\n                    console.error(`Error during fallback range loading for Financials col ${FINANCIALS_TARGET_COL_B}:`, fallbackError);\r\n                    financialsLastRow = 0; // Keep it 0 if fallback fails\r\n               }\r\n           }\r\n        }\r\n        // Recalculate financialsLastRow based on Col B if it's potentially larger\r\n        try {\r\n            const lastRowB = await getLastUsedRow(financialsSheet, FINANCIALS_TARGET_COL_B);\r\n            financialsLastRow = Math.max(financialsLastRow, lastRowB);\r\n        } catch (lastRowBErr) {\r\n            console.warn(`Could not get last row from Col B: ${lastRowBErr.message}`);\r\n        }\r\n\r\n        console.log(`Financials last relevant row used for processing: ${financialsLastRow}`);\r\n\r\n\r\n        // 3. Create Map of Financials Codes (Col I) -> Row Number\r\n        // MODIFIED: Use a case-insensitive map for codes\r\n        const financialsCodeMap = new Map();\r\n        if (financialsLastRow > 0) {\r\n            const financialsCodeRange = financialsSheet.getRange(`${FINANCIALS_CODE_COLUMN}1:${FINANCIALS_CODE_COLUMN}${financialsLastRow}`);\r\n            financialsCodeRange.load(\"values\");\r\n            await worksheet.context.sync(); // Sync map data load\r\n            for (let i = 0; i < financialsCodeRange.values.length; i++) {\r\n                const code = financialsCodeRange.values[i][0];\r\n                if (code !== null && code !== \"\") {\r\n                    // Convert code to uppercase for case-insensitive comparison\r\n                    const upperCode = String(code).toUpperCase();\r\n                    // Only map the first occurrence of a code, like .Find would\r\n                    if (!financialsCodeMap.has(upperCode)) {\r\n                         financialsCodeMap.set(upperCode, i + 1);\r\n                    }\r\n                }\r\n            }\r\n            console.log(`Built Financials code map with ${financialsCodeMap.size} entries.`);\r\n        } else {\r\n            console.warn(`Financials sheet column ${FINANCIALS_CODE_COLUMN} appears empty or last row not found. No codes loaded for map.`);\r\n        }\r\n\r\n        // *** REMOVED: Logic for existingDataLinks Set ***\r\n        // const existingDataLinks = new Set();\r\n        // if (financialsLastRow > 0) {\r\n        //     ... load formulas from Financials Col B ...\r\n        //     ... populate existingDataLinks set ...\r\n        // }\r\n        // *** END REMOVED ***\r\n\r\n        // 4. Identify rows to insert and prepare task data\r\n        const tasks = [];\r\n        console.log(\"populateFinancialsJS: Syncing assumption codes load...\");\r\n        await worksheet.context.sync(); // Sync needed for assumptionCodeRange.values\r\n\r\n        // *** RELOAD assumption codes here AFTER the sync above, just in case ***\r\n        // It's safer to reload after any potential sync/modification, though unlikely needed here.\r\n        // Keeping the original load before the Financials code map creation seems okay.\r\n        const assumptionCodes = assumptionCodeRange.values; // Use the already loaded values\r\n\r\n        console.log(`populateFinancialsJS: Processing ${assumptionCodes?.length ?? 0} assumption rows.`);\r\n\r\n        // --- REMOVED Debug logging for row 17 values/addresses ---\r\n\r\n        for (let i = 0; i < (assumptionCodes?.length ?? 0); i++) {\r\n            const code = assumptionCodes[i][0];\r\n            const assumptionRow = CALCS_FIRST_ROW + i; // This is the correct Excel row number\r\n\r\n            if (code !== null && code !== \"\") {\r\n                // Construct the potential link formulas first\r\n                const linkFormulaB = `='${worksheet.name}'!${ASSUMPTION_LINK_COL_B}${assumptionRow}`;\r\n                const linkFormulaD = `='${worksheet.name}'!${ASSUMPTION_LINK_COL_D}${assumptionRow}`;\r\n                const linkFormulaMonths = `='${worksheet.name}'!${ASSUMPTION_MONTHS_START_COL}${assumptionRow}`;\r\n\r\n                // *** REMOVED CHECK 1: Skip if this assumption row link already exists in Financials Col B ***\r\n                // if (existingDataLinks.has(linkFormulaB)) {\r\n                //     console.log(`  Skipping Code ${code} (Assumption Row ${assumptionRow}): Link ${linkFormulaB} already exists in Financials!${FINANCIALS_TARGET_COL_B}.`);\r\n                //     continue; // Skip to next assumption code\r\n                // }\r\n\r\n                // *** MODIFIED: Use case-insensitive check for code existence ***\r\n                const upperCode = String(code).toUpperCase();\r\n                if (!financialsCodeMap.has(upperCode)) {\r\n                     console.log(`  Skipping Code ${code} (Assumption Row ${assumptionRow}): Code not found in Financials template column ${FINANCIALS_CODE_COLUMN}. Cannot determine target row.`);\r\n                     continue; // Skip if no template row found\r\n                }\r\n\r\n                // If the code exists in the map, proceed to create the task\r\n                const targetRow = financialsCodeMap.get(upperCode); // Get the row number from the map\r\n                console.log(`  Task Prep: Code ${code} (Assumption Row ${assumptionRow}) -> Target Financials Row (for insertion): ${targetRow}`);\r\n\r\n                tasks.push({\r\n                    targetRow: targetRow,\r\n                    assumptionRow: assumptionRow,\r\n                    code: code,\r\n                    addressB: linkFormulaB,     // Use the constructed formula link\r\n                    addressD: linkFormulaD,     // Use the constructed formula link\r\n                    addressMonths: linkFormulaMonths // Use the constructed formula link\r\n                });\r\n            }\r\n        }\r\n\r\n        if (tasks.length === 0) {\r\n            console.log(\"No matching codes found. Nothing to insert or populate.\");\r\n            return;\r\n        }\r\n\r\n        // 5. Sort tasks by targetRow DESCENDING\r\n        tasks.sort((a, b) => b.targetRow - a.targetRow);\r\n        console.log(`Sorted ${tasks.length} tasks for insertion.`);\r\n        // --- DEBUG: Log the tasks array --- \r\n        // console.log(\"Tasks array (sorted desc by targetRow):\", JSON.stringify(tasks)); // REMOVED DEBUG\r\n        // --- END DEBUG ---\r\n\r\n        // 6. Perform Insertions (bottom-up)\r\n        console.log(\"Performing row insertions...\");\r\n        for (const task of tasks) { // Uses the DESCENDING sorted tasks\r\n            financialsSheet.getRange(`${task.targetRow}:${task.targetRow}`).insert(Excel.InsertShiftDirection.down);\r\n            // *** It's generally more efficient to sync less often, but syncing after each insert\r\n            // ensures the row model is updated for potential complex dependencies if they existed.\r\n            // Keep sync here for now unless performance becomes an issue. ***\r\n            // await worksheet.context.sync(); // Sync after EACH insertion -- REMOVED THIS LINE\r\n        }\r\n        await worksheet.context.sync(); // Sync AFTER all insertions are queued\r\n        console.log(\"Finished row insertions.\");\r\n\r\n        // Pre-calculate the final adjusted row for each task after all insertions\r\n        console.log(\"Calculating final adjusted rows for population/autofill...\");\r\n        // Get unique original target rows, sorted ascending\r\n        const originalTargetRowsAsc = [...new Set(tasks.map(t => t.targetRow))].sort((a, b) => a - b);\r\n        const taskAdjustedRows = new Map(); // Map to store { assumptionRow: adjustedRow }\r\n        let totalShift = 0; // Total shift accumulated from previous rows\r\n\r\n        // --- DEBUG: Log originalTargetRowsAsc ---\r\n        // console.log(\"Original Target Rows (unique, asc):\", originalTargetRowsAsc); // REMOVED DEBUG\r\n        // --- END DEBUG ---\r\n\r\n        originalTargetRowsAsc.forEach(uniqueRow => {\r\n            // --- DEBUG: Log current uniqueRow ---\r\n            // console.log(`Processing uniqueRow: ${uniqueRow}`); // REMOVED DEBUG\r\n            // --- END DEBUG ---\r\n\r\n            // Find all tasks that originally targeted this unique row\r\n            // CORRECTED PROPERTY NAME IN FILTER: task.targetRow instead of task.originalTargetRow\r\n            const tasksAtThisRow = tasks.filter(task => task.targetRow === uniqueRow);\r\n\r\n            // --- DEBUG: Log tasks found for this uniqueRow ---\r\n            // console.log(`  Tasks found for uniqueRow ${uniqueRow}:`, JSON.stringify(tasksAtThisRow)); // REMOVED DEBUG\r\n            // --- END DEBUG ---\r\n\r\n            // Optional: Sort tasksAtThisRow by assumptionRow for deterministic order, though might not be strictly necessary\r\n            // tasksAtThisRow.sort((a, b) => a.assumptionRow - b.assumptionRow);\r\n\r\n            let currentAdjustedRowForGroup = uniqueRow + totalShift; // Starting adjusted row for this group\r\n\r\n            // Assign consecutive adjusted rows to each task in this group\r\n            tasksAtThisRow.forEach(task => {\r\n                taskAdjustedRows.set(task.assumptionRow, currentAdjustedRowForGroup); // Use assumptionRow as key\r\n                console.log(`  Mapping: Code ${task.code}, Assumption Row ${task.assumptionRow}, Original Target ${uniqueRow}, Final Adjusted Row ${currentAdjustedRowForGroup}`);\r\n                currentAdjustedRowForGroup++; // Increment for the next task inserting at the same original spot\r\n            });\r\n\r\n            // Update the total shift for subsequent unique rows\r\n            totalShift += tasksAtThisRow.length;\r\n        });\r\n\r\n        // --- DEBUG: Log the contents of the map --- \r\n        // console.log(\"taskAdjustedRows map contents:\", taskAdjustedRows); // REMOVED DEBUG\r\n        // --- END DEBUG ---\r\n\r\n        // 7. Populate and Format inserted rows using ADJUSTED row numbers\r\n        console.log(\"Populating inserted rows (using adjusted rows)...\");\r\n        for (const task of tasks) { // Iterates descending sorted tasks (order doesn't strictly matter here, but using the same loop)\r\n            // const originalTargetRow = task.targetRow; // No longer needed for lookup\r\n            const populateRow = taskAdjustedRows.get(task.assumptionRow); // Get the calculated adjusted row using assumptionRow\r\n\r\n            // Check if populateRow was found\r\n            if (typeof populateRow === 'undefined' || populateRow === null) {\r\n                console.error(`Could not find adjusted row for task with Assumption Row ${task.assumptionRow}, Code ${task.code}. Skipping population.`);\r\n                continue; // Skip this task if mapping failed\r\n            }\r\n\r\n            // Use populateRow instead of task.targetRow for getRange calls\r\n            const cellB = financialsSheet.getRange(`${FINANCIALS_TARGET_COL_B}${populateRow}`);\r\n            const cellD = financialsSheet.getRange(`${FINANCIALS_TARGET_COL_D}${populateRow}`);\r\n            const cellAnnualsStart = financialsSheet.getRange(`${FINANCIALS_ANNUALS_START_COL}${populateRow}`);\r\n            const cellMonthsStart = financialsSheet.getRange(`${FINANCIALS_MONTHS_START_COL}${populateRow}`);\r\n\r\n            // --- Populate Column B ---\r\n            cellB.formulas = [[task.addressB]]; // Set formula directly\r\n            cellB.format.font.bold = false;\r\n            cellB.format.font.italic = false;\r\n            cellB.format.indentLevel = 2;\r\n\r\n            // --- Populate Column D ---\r\n            cellD.formulas = [[task.addressD]]; // Set formula directly\r\n            cellD.format.font.bold = false;\r\n            cellD.format.font.italic = false;\r\n            cellD.format.indentLevel = 2;\r\n\r\n            // --- Populate Annuals Start Column (J) with SUMIF ---\r\n            // MODIFIED: Make code prefix comparison case-insensitive\r\n            let codePrefix = String(task.code).substring(0, 2).toUpperCase();\r\n            let formulaJ = \"\";\r\n            if (codePrefix === \"IS\" || codePrefix === \"CF\") {\r\n                 // Corrected R2C[1] to R2C: Criteria should reference current column's header (J$2)\r\n                 formulaJ = `=SUMIF(R3,R2C,R[0])`;\r\n            } else {\r\n                 // Corrected R2C[1] to R2C: Criteria should reference current column's header (J$2)\r\n                 formulaJ = `=SUMIF(R4,R2C,R[0])`;\r\n            }\r\n            cellAnnualsStart.formulasR1C1 = [[formulaJ]]; // Use formulasR1C1 for SUMIF\r\n            cellAnnualsStart.format.font.bold = false;\r\n            cellAnnualsStart.format.font.italic = false;\r\n            cellAnnualsStart.format.numberFormat = CURRENCY_FORMAT;\r\n\r\n            // --- Populate Months Start Column (AE) with Link ---\r\n            cellMonthsStart.formulas = [[task.addressMonths]]; // Set formula directly\r\n            cellMonthsStart.format.font.bold = false;\r\n            cellMonthsStart.format.font.italic = false;\r\n            cellMonthsStart.format.font.color = GREEN_COLOR; // Keep green color for month links\r\n            cellMonthsStart.format.numberFormat = CURRENCY_FORMAT;\r\n\r\n            // Removed Actuals column population (was L in previous version)\r\n            \r\n            // --- NEW: Populate Actuals Columns S:AD with SUMIFS formula ---\r\n            try {\r\n                const actualsRange = financialsSheet.getRange(`S${populateRow}:AD${populateRow}`);\r\n                const sumifsFormula = \"=SUMIFS('Actual Data'!$B:$B,'Actual Data'!$D:$D,EOMONTH(INDIRECT(ADDRESS(2,COLUMN())),0),'Actual Data'!$E:$E,@INDIRECT(ADDRESS(ROW(),2)))\";\r\n                \r\n                // Create a 2D array matching the range dimensions\r\n                const numCols = columnLetterToIndex('AD') - columnLetterToIndex('S') + 1;\r\n                const formulasArray = [Array(numCols).fill(sumifsFormula)];\r\n                actualsRange.formulas = formulasArray;\r\n                \r\n                // Apply formatting\r\n                actualsRange.format.numberFormat = CURRENCY_FORMAT;\r\n                actualsRange.format.font.bold = false;\r\n                actualsRange.format.font.italic = false;\r\n                actualsRange.format.font.color = \"#7030A0\"; // Set font color\r\n                console.log(`  Set SUMIFS formula for S${populateRow}:AD${populateRow}`);\r\n            } catch (sumifsError) {\r\n                console.error(`Error setting SUMIFS formula for row ${populateRow} (Code: ${task.code}):`, sumifsError.debugInfo || sumifsError);\r\n            }\r\n            // --- END NEW SECTION ---\r\n        }\r\n        console.log(\"Finished setting values/formulas/formats for inserted rows.\");\r\n        await worksheet.context.sync(); // Sync all population and formatting\r\n\r\n\r\n        // 8. Perform Autofills using ADJUSTED row numbers\r\n        console.log(\"Performing autofills (using adjusted rows)...\");\r\n        for (const task of tasks) { // Uses the DESCENDING sorted tasks again\r\n             // const originalTargetRow = task.targetRow; // No longer needed for lookup\r\n             const populateRow = taskAdjustedRows.get(task.assumptionRow); // Get the calculated adjusted row using assumptionRow\r\n\r\n             // Check if populateRow was found\r\n            if (typeof populateRow === 'undefined' || populateRow === null) {\r\n                console.error(`Could not find adjusted row for task with Assumption Row ${task.assumptionRow}, Code ${task.code}. Skipping autofill.`);\r\n                continue; // Skip this task if mapping failed\r\n            }\r\n\r\n             try {\r\n                // Use populateRow for autofill ranges\r\n                // Autofill Annuals: J -> P\r\n                const sourceAnnuals = financialsSheet.getRange(`${FINANCIALS_ANNUALS_START_COL}${populateRow}`); // Use adjusted row\r\n                const destAnnuals = financialsSheet.getRange(`${FINANCIALS_ANNUALS_START_COL}${populateRow}:${ANNUALS_END_COL}${populateRow}`); // Use adjusted row\r\n                sourceAnnuals.autoFill(destAnnuals, Excel.AutoFillType.fillDefault);\r\n                // console.log(`  Autofilled ${FINANCIALS_ANNUALS_START_COL}${populateRow} to ${ANNUALS_END_COL}${populateRow}`);\r\n\r\n                // Autofill Months: AE -> CX\r\n                const sourceMonths = financialsSheet.getRange(`${FINANCIALS_MONTHS_START_COL}${populateRow}`); // Use adjusted row\r\n                const destMonths = financialsSheet.getRange(`${FINANCIALS_MONTHS_START_COL}${populateRow}:${MONTHS_END_COL}${populateRow}`); // Use adjusted row\r\n                sourceMonths.autoFill(destMonths, Excel.AutoFillType.fillDefault);\r\n                // console.log(`  Autofilled ${FINANCIALS_MONTHS_START_COL}${populateRow} to ${MONTHS_END_COL}${populateRow}`);\r\n\r\n                // Removed Actuals autofill\r\n             } catch(autofillError) {\r\n                 // Update error message to use adjusted row\r\n                 console.error(`Error during autofill for adjusted row ${populateRow} (Code: ${task.code}, Original Target: ${task.targetRow}):`, autofillError.debugInfo || autofillError);\r\n             }\r\n        }\r\n        console.log(\"Finished setting up autofills.\");\r\n        await worksheet.context.sync(); // Sync all autofill operations\r\n        console.log(\"Autofills synced.\");\r\n\r\n        // *** NEW STEP: Modify codes in Assumption Sheet Column C ***\r\n        console.log(`Modifying codes in ${worksheet.name} column ${ASSUMPTION_CODE_COL} (${CALCS_FIRST_ROW}:${lastRow}) by prepending '-'...`);\r\n        try {\r\n            // Re-get the range and load values (ensure we have the latest state)\r\n            const codeColRange = worksheet.getRange(`${ASSUMPTION_CODE_COL}${CALCS_FIRST_ROW}:${ASSUMPTION_CODE_COL}${lastRow}`);\r\n            codeColRange.load(\"values\");\r\n            await worksheet.context.sync(); // Load the values\r\n\r\n            const currentCodeValues = codeColRange.values;\r\n            const modifiedCodeValues = [];\r\n            let modifiedCount = 0;\r\n\r\n            for (let i = 0; i < currentCodeValues.length; i++) {\r\n                const originalValue = currentCodeValues[i][0];\r\n                if (originalValue !== null && originalValue !== \"\" && !String(originalValue).startsWith('-')) {\r\n                    modifiedCodeValues.push([\"-\" + originalValue]); // Prepend \"-\"\r\n                    modifiedCount++;\r\n                } else {\r\n                    modifiedCodeValues.push([originalValue]); // Keep original if empty, null, or already starts with '-'\r\n                }\r\n            }\r\n\r\n            // Write the modified values back if any changes were made\r\n            if (modifiedCount > 0) {\r\n                 console.log(`  Writing ${modifiedCount} modified codes back to ${ASSUMPTION_CODE_COL}${CALCS_FIRST_ROW}:${ASSUMPTION_CODE_COL}${lastRow}`);\r\n                 codeColRange.values = modifiedCodeValues;\r\n                 await worksheet.context.sync(); // Sync the code modifications\r\n                 console.log(\"  Synced code modifications.\");\r\n            } else {\r\n                console.log(\"  No codes needed modification.\");\r\n            }\r\n        } catch (modifyError) {\r\n             console.error(`Error modifying codes in ${worksheet.name} column ${ASSUMPTION_CODE_COL}:`, modifyError.debugInfo || modifyError);\r\n             // Continue even if modification fails? Or throw? Let's log and continue.\r\n        }\r\n        // *** END NEW STEP ***\r\n\r\n\r\n        console.log(`populateFinancialsJS successfully completed for ${worksheet.name} -> ${financialsSheet.name}`);\r\n\r\n    } catch (error) {\r\n        console.error(`Error in populateFinancialsJS for sheet ${worksheet.name} -> ${financialsSheet.name}:`, error.debugInfo || error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Placeholder for Format_Changes_In_Working_Capital VBA logic.\r\n * Inserts a row and adjusts formatting in \"Financials\" based on specific codes.\r\n * @param {Excel.Worksheet} financialsSheet - The \"Financials\" worksheet (within an Excel.run context).\r\n */\r\nasync function formatChangesInWorkingCapitalJS(financialsSheet) {\r\n    console.log(`Running formatChangesInWorkingCapitalJS for sheet: ${financialsSheet.name}`);\r\n    // This function MUST be called within an Excel.run context.\r\n    const FIND_TEXT_1 = \"CF: Non-cash\";\r\n    const FIND_TEXT_2 = \"CF: WC\";\r\n    const SEARCH_COLUMN = \"I\";\r\n     // Define ranges for border removal based on VBA (e.g., \"K\" + (foundRow + 1) + \":P\" + (foundRow + 1))\r\n\r\n    // TODO: Implement Format_Changes_In_Working_Capital logic\r\n    // 1. Find FIND_TEXT_1 in SEARCH_COLUMN using range.find\r\n    // 2. If found:\r\n    //    a. Get cell above (offset -1, 0)\r\n    //    b. Load its value\r\n    //    c. Sync\r\n    //    d. Check if value is FIND_TEXT_2\r\n    //    e. If yes:\r\n    //       i. Get the entire row of the found cell (.getEntireRow())\r\n    //       ii. Insert a new row above it (insert(Excel.InsertShiftDirection.down))\r\n    //       iii. Get ranges in the *original* row (now shifted down one) and remove borders.\r\n    financialsSheet.load('name'); // Keep reference valid if needed later in the SAME context\r\n    await financialsSheet.context.sync();\r\n     console.warn(`formatChangesInWorkingCapitalJS on ${financialsSheet.name} not implemented yet.`);\r\n}\r\n\r\n/**\r\n * Processes assumption tabs after runCodes, replicating VBA logic.\r\n * Expects an array of assumption tab names.\r\n * @param {string[]} assumptionTabNames - Array of assumption tab names created by runCodes.\r\n */\r\nexport async function processAssumptionTabs(assumptionTabNames) {\r\n    console.log(`Starting processing for ${assumptionTabNames.length} assumption tabs:`, assumptionTabNames);\r\n    if (!assumptionTabNames || assumptionTabNames.length === 0) {\r\n        console.log(\"No assumption tabs provided to process.\");\r\n        return;\r\n    }\r\n\r\n    const FINANCIALS_SHEET_NAME = \"Financials\"; // Define constant\r\n    const AUTOFILL_START_COLUMN = \"AE\";\r\n    const AUTOFILL_END_COLUMN = \"CX\";\r\n    const START_ROW = 10; // <<< CHANGED FROM 9 // Standard start row for processing\r\n\r\n    try {\r\n        // --- Loop through each assumption tab name ---\r\n        for (const worksheetName of assumptionTabNames) {\r\n             console.log(`\\nProcessing Assumption Tab: ${worksheetName}`);\r\n\r\n            try {\r\n                 // Perform operations for a single tab within one Excel.run for efficiency\r\n                 await Excel.run(async (context) => {\r\n                     // Get worksheet and financials sheet references within THIS context\r\n                     const currentWorksheet = context.workbook.worksheets.getItem(worksheetName);\r\n                     const financialsSheet = context.workbook.worksheets.getItem(FINANCIALS_SHEET_NAME);\r\n                     currentWorksheet.load('name'); // Load basic properties\r\n                     financialsSheet.load('name');\r\n                     await context.sync(); // Ensure sheets are loaded\r\n\r\n                     console.log(`Successfully got references for ${currentWorksheet.name} and ${financialsSheet.name}`);\r\n\r\n                     // 1. Get Last Row for the current assumption tab\r\n                     // getLastUsedRow needs context, so call it here\r\n                     const lastRow = await getLastUsedRow(currentWorksheet, \"B\"); // Pass currentWorksheet from this context\r\n                     if (lastRow < START_ROW) {\r\n                         console.warn(`Skipping tab ${worksheetName} as last used row in Col B (${lastRow}) is before start row (${START_ROW}).`);\r\n                         return; // Skip to next tab if empty or too short\r\n                     }\r\n                     console.log(`Last row in Col B for ${worksheetName}: ${lastRow}`);\r\n\r\n                     // --- Call helper functions IN ORDER, passing worksheet objects from this context ---\r\n                     // These helpers now expect to run within this context\r\n\r\n                     // 2. Adjust Drivers\r\n                     await adjustDriversJS(currentWorksheet, lastRow);\r\n\r\n                     // 3. Replace Indirects\r\n                     await replaceIndirectsJS(currentWorksheet, lastRow);\r\n\r\n                     // 4. Get Last Row Again (if Replace_Indirects might change it)\r\n                     // const updatedLastRow = await getLastUsedRow(currentWorksheet, \"B\"); // Recalculate if necessary\r\n                     const updatedLastRow = lastRow; // Assuming Replace_Indirects doesn't change last row for now\r\n                     console.log(`Using last row for subsequent steps: ${updatedLastRow}`);\r\n                     if (updatedLastRow < START_ROW) {\r\n                         console.warn(`Skipping remaining steps for ${worksheetName} as updated last row (${updatedLastRow}) is invalid.`);\r\n                         return;\r\n                     }\r\n\r\n                     // 5. Populate Financials\r\n                     await populateFinancialsJS(currentWorksheet, updatedLastRow, financialsSheet);\r\n\r\n                     // 6.5 Set font color to white in column A\r\n                     // We use updatedLastRow here, as deletions haven't happened yet\r\n                     await setColumnAFontWhite(currentWorksheet, START_ROW, updatedLastRow); \r\n                     console.log(`Set font color to white in column A from rows ${START_ROW}-${updatedLastRow}`);\r\n  \r\n                     // // Force recalculation before Index Growth Curve (especially if manual calc mode)\r\n                     // console.log(`Performing full workbook recalculation before Index Growth Curve for ${worksheetName}...`);\r\n                     // context.workbook.application.calculate(Excel.CalculationType.fullRebuild);\r\n                     // await context.sync(); // Sync the calculation\r\n                     // console.log(`Recalculation complete for ${worksheetName}.`);\r\n \r\n                      // 6.8 Apply Index Growth Curve logic (if applicable)\r\n                     // Run Index Growth *before* deleting rows. Use updatedLastRow as the boundary.\r\n                     await applyIndexGrowthCurveJS(currentWorksheet, updatedLastRow); \r\n                     \r\n                     // 7. Delete rows with green background (#CCFFCC) - AFTER Index Growth\r\n                     console.log(`Deleting green rows in ${worksheetName}...`);\r\n                     // Changed START_ROW to START_ROW - 1 to include row 9\r\n                     const finalLastRow = await deleteGreenRows(currentWorksheet, START_ROW - 1, updatedLastRow); // Get the new last row AFTER deletions\r\n                     console.log(`After deleting green rows, last row is now: ${finalLastRow}`);\r\n \r\n                     // 8. Autofill AE9:AE<lastRow> -> CX<lastRow> on Assumption Tab - Use finalLastRow\r\n                     console.log(`Autofilling ${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_START_COLUMN}${finalLastRow} to ${AUTOFILL_END_COLUMN} on ${worksheetName}`);\r\n                     const sourceRange = currentWorksheet.getRange(`${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_START_COLUMN}${finalLastRow}`);\r\n                     const fillRange = currentWorksheet.getRange(`${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_END_COLUMN}${finalLastRow}`);\r\n                     sourceRange.autoFill(fillRange, Excel.AutoFillType.fillDefault);\r\n \r\n                     // 9. Set Row 9 interior color to none\r\n                     console.log(`Setting row 9 interior color to none for ${worksheetName}`);\r\n                     const row9Range = currentWorksheet.getRange(\"9:9\");\r\n                     row9Range.format.fill.clear();\r\n\r\n                     // Sync all batched operations for this tab\r\n                     await context.sync();\r\n                     console.log(`Finished processing and syncing for tab ${worksheetName}`);\r\n\r\n                 }); // End Excel.run for single tab processing\r\n\r\n             } catch (tabError) {\r\n                 console.error(`Error processing tab ${worksheetName}:`, tabError);\r\n                 // Optionally add to an error list and continue with the next tab\r\n                 // Be mindful that subsequent tabs might depend on this one succeeding.\r\n             }\r\n        } // --- End loop through assumption tabs ---\r\n\r\n        // --- Final Operations on Financials Sheet ---\r\n        console.log(`\\nPerforming final operations on ${FINANCIALS_SHEET_NAME}`);\r\n        try {\r\n             await Excel.run(async (context) => {\r\n                 const finSheet = context.workbook.worksheets.getItem(FINANCIALS_SHEET_NAME);\r\n                 finSheet.load('name'); // Load name for logging\r\n                 await context.sync(); // Ensure sheet is loaded\r\n\r\n                 // 1. Format Changes In Working Capital\r\n                 // await formatChangesInWorkingCapitalJS(finSheet); // <<< COMMENTED OUT\r\n\r\n                 // 2. Get Last Row for Financials\r\n                 const financialsLastRow = await getLastUsedRow(finSheet, \"B\"); // Pass sheet from this context\r\n                 if (financialsLastRow < START_ROW) {\r\n                     console.warn(`Skipping final autofill on ${FINANCIALS_SHEET_NAME} as last row (${financialsLastRow}) is before start row (${START_ROW}).`);\r\n                     return;\r\n                 }\r\n                 console.log(`Last row in Col B for ${FINANCIALS_SHEET_NAME}: ${financialsLastRow}`);\r\n\r\n                //  // 3. Autofill AE9:AE<lastRow> -> CX<lastRow> on Financials\r\n                //  console.log(`Autofilling ${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_START_COLUMN}${financialsLastRow} to ${AUTOFILL_END_COLUMN} on ${FINANCIALS_SHEET_NAME}`);\r\n                //  const sourceRangeFin = finSheet.getRange(`${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_START_COLUMN}${financialsLastRow}`);\r\n                //  const fillRangeFin = finSheet.getRange(`${AUTOFILL_START_COLUMN}${START_ROW}:${AUTOFILL_END_COLUMN}${financialsLastRow}`);\r\n                //  sourceRangeFin.autoFill(fillRangeFin, Excel.AutoFillType.fillDefault);\r\n\r\n\r\n                 // Sync final Financials sheet operations\r\n                 await context.sync();\r\n                 console.log(`Finished final operations on ${FINANCIALS_SHEET_NAME}`);\r\n             });\r\n         } catch (financialsError) {\r\n             console.error(`Error during final operations on ${FINANCIALS_SHEET_NAME}:`, financialsError);\r\n         }\r\n\r\n        console.log(\"Finished processing all assumption tabs.\");\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in processAssumptionTabs main function:\", error);\r\n        // Potentially re-throw or handle top-level errors\r\n    }\r\n}\r\n\r\n/**\r\n * Deletes rows with light green background (#CCFFCC) in column B\r\n * @param {Excel.Worksheet} worksheet - The worksheet to process\r\n * @param {number} startRow - The first row to check\r\n * @param {number} lastRow - The last row to check\r\n * @returns {Promise<number>} - The new last row after deletions\r\n */\r\nasync function deleteGreenRows(worksheet, startRow, lastRow) {\r\n    console.log(`Deleting green rows (#CCFFCC) in ${worksheet.name} from row ${startRow} to ${lastRow}`);\r\n    \r\n    try {\r\n        // Create an array to store rows that need deletion (in descending order)\r\n        const rowsToDelete = [];\r\n        \r\n        // Process each row individually instead of as a range to avoid collection issues\r\n        for (let rowNum = startRow; rowNum <= lastRow; rowNum++) {\r\n            const cellAddress = `B${rowNum}`;\r\n            const cell = worksheet.getRange(cellAddress);\r\n            cell.load(\"format/fill/color\");\r\n            \r\n            try {\r\n                await worksheet.context.sync();\r\n                \r\n                // Safely check if properties exist and if color matches\r\n                if (cell.format && \r\n                    cell.format.fill && \r\n                    cell.format.fill.color === \"#CCFFCC\") {\r\n                    rowsToDelete.push(rowNum);\r\n                }\r\n            } catch (cellError) {\r\n                console.warn(`Error checking color for ${cellAddress}: ${cellError.message}`);\r\n                // Continue to next cell if there's an error with this one\r\n            }\r\n        }\r\n        \r\n        // Sort in descending order to delete from bottom to top\r\n        rowsToDelete.sort((a, b) => b - a);\r\n        \r\n        console.log(`Found ${rowsToDelete.length} green rows to delete`);\r\n        \r\n        // Delete each row (from bottom to top)\r\n        if (rowsToDelete.length > 0) {\r\n            for (const rowNum of rowsToDelete) {\r\n                console.log(`Deleting row ${rowNum}`);\r\n                const rowRange = worksheet.getRange(`${rowNum}:${rowNum}`);\r\n                rowRange.delete(Excel.DeleteShiftDirection.up);\r\n            }\r\n            \r\n            await worksheet.context.sync();\r\n            \r\n            // Recalculate the last row\r\n            const newLastRow = await getLastUsedRow(worksheet, \"B\");\r\n            console.log(`New last row after deletions: ${newLastRow}`);\r\n            \r\n            return newLastRow;\r\n        } else {\r\n            console.log(\"No green rows found to delete\");\r\n            return lastRow; // Return original lastRow if no rows deleted\r\n        }\r\n    } catch (error) {\r\n        console.error(`Error in deleteGreenRows: ${error.message}`, error);\r\n        // Return the original lastRow on error\r\n        return lastRow;\r\n    }\r\n}\r\n\r\n/**\r\n * Sets the font color to white for all cells in column A\r\n * @param {Excel.Worksheet} worksheet - The worksheet to process\r\n * @param {number} startRow - The first row to format\r\n * @param {number} lastRow - The last row to format\r\n * @returns {Promise<void>}\r\n */\r\nasync function setColumnAFontWhite(worksheet, startRow, lastRow) {\r\n    console.log(`Setting font color to white in column A for ${worksheet.name} from row ${startRow} to ${lastRow}`);\r\n    \r\n    try {\r\n        // Get the entire range for column A from startRow to lastRow\r\n        const columnARange = worksheet.getRange(`A${startRow}:A${lastRow}`);\r\n        \r\n        // Set the font color to white\r\n        columnARange.format.font.color = \"#FFFFFF\";\r\n        \r\n        await worksheet.context.sync();\r\n        console.log(`Successfully set font color to white in column A for rows ${startRow}-${lastRow}`);\r\n    } catch (error) {\r\n        console.error(`Error in setColumnAFontWhite: ${error.message}`, error);\r\n    }\r\n}\r\n\r\n// --- Helper Functions for Column Conversion ---\r\n\r\n/**\r\n * Converts a 0-based column index into a column letter (e.g., 0 -> A, 1 -> B, 26 -> AA).\r\n * @param {number} index - The 0-based column index.\r\n * @returns {string} The column letter.\r\n */\r\nfunction columnIndexToLetter(index) {\r\n    let letter = '';\r\n    while (index >= 0) {\r\n        letter = String.fromCharCode(index % 26 + 'A'.charCodeAt(0)) + letter;\r\n        index = Math.floor(index / 26) - 1;\r\n    }\r\n    return letter;\r\n}\r\n\r\n/**\r\n * Converts a column letter into a 0-based column index (e.g., A -> 0, B -> 1, AA -> 26).\r\n * @param {string} letter - The column letter (case-insensitive).\r\n * @returns {number} The 0-based column index.\r\n */\r\nfunction columnLetterToIndex(letter) {\r\n    letter = letter.toUpperCase();\r\n    let index = 0;\r\n    for (let i = 0; i < letter.length; i++) {\r\n        index = index * 26 + (letter.charCodeAt(i) - 'A'.charCodeAt(0) + 1);\r\n    }\r\n    return index - 1; // Adjust to 0-based\r\n}\r\n\r\n/**\r\n * Hides Columns C-I, Rows 2-8, and specific Actuals columns on specified sheets,\r\n * then navigates to cell A1 of the Financials sheet.\r\n * @param {string[]} assumptionTabNames - Array of assumption tab names created by runCodes.\r\n * @returns {Promise<void>}\r\n */\r\nexport async function hideColumnsAndNavigate(assumptionTabNames) { // Renamed and added parameter\r\n    // Define Actuals columns\r\n    const ACTUALS_START_COL = \"S\";\r\n    const ACTUALS_END_COL = \"AD\";\r\n\r\n    try {\r\n        const targetSheetNames = [...assumptionTabNames, \"Financials\"]; // Combine assumption tabs and Financials\r\n        console.log(`Attempting to hide specific rows/columns on sheets [${targetSheetNames.join(', ')}] and navigate...`);\r\n\r\n        await Excel.run(async (context) => {\r\n            // Get all worksheets\r\n            const worksheets = context.workbook.worksheets;\r\n            // Load only names needed for matching\r\n            worksheets.load(\"items/name\");\r\n            await context.sync();\r\n\r\n            console.log(`Found ${worksheets.items.length} worksheets. Targeting ${targetSheetNames.length} specific sheets.`);\r\n            let hideAttempted = false;\r\n\r\n            // Calculate actuals end column for assumption tabs\r\n            const actualsEndIndex = columnLetterToIndex(ACTUALS_END_COL);\r\n            const actualsEndMinusOneCol = actualsEndIndex > 0 ? columnIndexToLetter(actualsEndIndex - 1) : ACTUALS_START_COL; // Handle edge case\r\n\r\n            // --- Queue hiding operations for target sheets ---\r\n            for (const worksheet of worksheets.items) {\r\n                const sheetName = worksheet.name;\r\n                if (targetSheetNames.includes(sheetName)) { // Check if sheet is in our target list\r\n                    console.log(`Queueing hide operations for: ${sheetName}`);\r\n                    try {\r\n                        // Hide Rows 2:8 (Applies to both)\r\n                        const rows28 = worksheet.getRange(\"2:8\");\r\n                        rows28.rowHidden = true;\r\n\r\n                        // Conditional Column Hiding\r\n                        if (sheetName === \"Financials\") {\r\n                            console.log(`  -> Hiding Columns C:I for Financials`);\r\n                            const colsCI = worksheet.getRange(\"C:I\");\r\n                            colsCI.columnHidden = true;\r\n                        } else {\r\n                            // Hide Columns C:E for Assumption Tabs\r\n                            console.log(`  -> Hiding Columns C:E for ${sheetName}`);\r\n                            const colsCE = worksheet.getRange(\"C:E\");\r\n                            colsCE.columnHidden = true;\r\n                        }\r\n\r\n                        // Hide Actuals Columns based on sheet type\r\n                        if (sheetName === \"Financials\") {\r\n                            console.log(`  -> Hiding Actuals range ${ACTUALS_START_COL}:${ACTUALS_END_COL}`);\r\n                            const actualsRangeFin = worksheet.getRange(`${ACTUALS_START_COL}:${ACTUALS_END_COL}`);\r\n                            actualsRangeFin.columnHidden = true;\r\n                        } else if (assumptionTabNames.includes(sheetName)) {\r\n                             console.log(`  -> Hiding Actuals range ${ACTUALS_START_COL}:${actualsEndMinusOneCol}`);\r\n                             const actualsRangeAssum = worksheet.getRange(`${ACTUALS_START_COL}:${actualsEndMinusOneCol}`);\r\n                             actualsRangeAssum.columnHidden = true;\r\n                        }\r\n\r\n                        hideAttempted = true; // Mark that at least one hide was queued\r\n                    } catch (error) {\r\n                        // Log unexpected errors during the queuing attempt\r\n                        console.error(`  Error queuing hide operations for ${sheetName}: ${error.message}`, {\r\n                            code: error.code,\r\n                            debugInfo: error.debugInfo ? JSON.stringify(error.debugInfo) : 'N/A'\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            // --- Sync all queued hide operations ---\r\n            if (hideAttempted) {\r\n                console.log(`Attempting to sync hide columns/rows operations...`);\r\n                try {\r\n                    await context.sync();\r\n                    console.log(\"Successfully synced hide columns/rows operations.\");\r\n                } catch (syncError) {\r\n                    console.error(`Error syncing hide columns/rows operations: ${syncError.message}`, {\r\n                        code: syncError.code,\r\n                        debugInfo: syncError.debugInfo ? JSON.stringify(syncError.debugInfo) : 'N/A'\r\n                    });\r\n                     // Report failure but continue to navigation attempt\r\n                }\r\n            } else {\r\n                 console.log(\"No target sheets found or no hide operations were queued.\");\r\n            }\r\n\r\n            // --- Activate and Select A1 on each assumption tab (mimic Ctrl+Home) ---\r\n            console.log(\"Activating and selecting A1 on assumption tabs...\");\r\n            // Note: This requires syncing inside the loop for the activate/select effect per sheet\r\n            for (const sheetName of assumptionTabNames) {\r\n                try {\r\n                    console.log(`  Activating and selecting A1 for: ${sheetName}`);\r\n                    const worksheet = context.workbook.worksheets.getItem(sheetName);\r\n                    worksheet.activate(); // Activate the sheet first\r\n                    const rangeA1 = worksheet.getRange(\"A1\");\r\n                    rangeA1.select(); // Then select A1\r\n                    await context.sync(); // Sync *immediately* to apply activation and selection for this sheet\r\n                    console.log(`  Synced A1 view reset for ${sheetName}.`);\r\n                } catch (error) {\r\n                     console.error(`  Error resetting view for ${sheetName}: ${error.message}`);\r\n                     // Optionally continue to the next sheet even if one fails\r\n                }\r\n            }\r\n            // No final sync needed for this loop as it happens inside\r\n\r\n            // --- Activate and Select J9 on each assumption tab ---\r\n            console.log(\"Activating and selecting J9 on assumption tabs...\");\r\n            // Note: This requires syncing inside the loop for the activate/select effect per sheet\r\n            for (const sheetName of assumptionTabNames) {\r\n                try {\r\n                    console.log(`  Activating and selecting J9 for: ${sheetName}`);\r\n                    const worksheet = context.workbook.worksheets.getItem(sheetName);\r\n                    worksheet.activate(); // Activate the sheet first\r\n                    const rangeJ9 = worksheet.getRange(\"J9\"); // Get J9\r\n                    rangeJ9.select(); // Then select J9\r\n                    await context.sync(); // Sync *immediately* to apply activation and selection for this sheet\r\n                    console.log(`  Synced J9 view reset for ${sheetName}.`);\r\n                } catch (error) {\r\n                     console.error(`  Error resetting view to J9 for ${sheetName}: ${error.message}`);\r\n                     // Optionally continue to the next sheet even if one fails\r\n                }\r\n            }\r\n            // No final sync needed for this loop as it happens inside\r\n\r\n            // --- Navigate to Financials sheet and select cell J9 ---\r\n            // (This ensures Financials is the final active sheet)\r\n            try {\r\n                console.log(\"Navigating to Financials sheet and selecting J9...\");\r\n                const financialsSheet = context.workbook.worksheets.getItem(\"Financials\");\r\n                // This activate/select sequence overrides the previous active sheet.\r\n                financialsSheet.activate(); \r\n                const rangeJ9 = financialsSheet.getRange(\"J9\"); // Get J9\r\n                rangeJ9.select(); // Select J9\r\n                await context.sync(); // Sync the final activate/select\r\n                console.log(\"Successfully navigated to Financials!J9.\");\r\n            } catch (navError) {\r\n                console.error(`Error navigating to Financials sheet J9: ${navError.message}`, {\r\n                    code: navError.code,\r\n                    debugInfo: navError.debugInfo ? JSON.stringify(navError.debugInfo) : 'N/A'\r\n                });\r\n                // Do not throw here, allow the function to finish\r\n            }\r\n\r\n            console.log(\"Finished hideColumnsAndNavigate function.\");\r\n\r\n        }); // End Excel.run\r\n    } catch (error) {\r\n        // Catch errors from the Excel.run call itself\r\n        console.error(\"Critical error in hideColumnsAndNavigate:\", error);\r\n        throw error; // Re-throw critical errors\r\n    }\r\n}\r\n\r\n/**\r\n * Hides specific rows and columns on all worksheets except for specified exclusions.\r\n * Hides rows 1-8, columns C-I (3-9), and columns S-AC (19-29).\r\n * @param {string[]} excludedSheetNames - An array of sheet names to exclude from hiding.\r\n * @returns {Promise<void>}\r\n */\r\nexport async function hideRowsAndColumnsOnSheets(excludedSheetNames = [\"Actuals Data\", \"Actuals Categorization\"]) {\r\n    try {\r\n        console.log(`Hiding rows/columns on sheets, excluding: ${excludedSheetNames.join(', ')}`);\r\n\r\n        await Excel.run(async (context) => {\r\n            const worksheets = context.workbook.worksheets;\r\n            worksheets.load(\"items/name\");\r\n            await context.sync();\r\n\r\n            for (const worksheet of worksheets.items) {\r\n                const sheetName = worksheet.name;\r\n                if (excludedSheetNames.includes(sheetName)) {\r\n                    console.log(`Skipping sheet: ${sheetName} (excluded)`);\r\n                    continue;\r\n                }\r\n\r\n                console.log(`Processing sheet: ${sheetName}`);\r\n\r\n                try {\r\n                    // Hide Rows 1-8\r\n                    const rowRange = worksheet.getRange(\"1:8\");\r\n                    rowRange.rowHidden = true;\r\n                    console.log(`  Hiding rows 1-8`);\r\n\r\n                    // Hide Columns C-E (Changed from C:I)\r\n                    const colRange1 = worksheet.getRange(\"C:E\"); // Changed range\r\n                    colRange1.columnHidden = true;\r\n                    console.log(`  Hiding columns C-E`); // Update log message\r\n\r\n                    // Hide Columns S-AC\r\n                    const colRange2 = worksheet.getRange(\"S:AC\");\r\n                    colRange2.columnHidden = true;\r\n                    console.log(`  Hiding columns S-AC`);\r\n\r\n                    // It's often more efficient to batch sync operations,\r\n                    // but sometimes hiding needs immediate effect or separate syncs.\r\n                    // Let's sync after hiding for this sheet.\r\n                    await context.sync();\r\n                    console.log(`  Finished hiding for ${sheetName}`);\r\n\r\n                } catch (hideError) {\r\n                    console.error(`  Error hiding rows/columns on sheet ${sheetName}: ${hideError.message}`, {\r\n                        code: hideError.code,\r\n                        debugInfo: hideError.debugInfo ? JSON.stringify(hideError.debugInfo) : 'N/A'\r\n                    });\r\n                    // Continue to the next sheet even if one fails\r\n                }\r\n            }\r\n\r\n            console.log(\"Finished processing all sheets for hiding rows/columns.\");\r\n        }); // End Excel.run\r\n\r\n    } catch (error) {\r\n        console.error(\"Critical error in hideRowsAndColumnsOnSheets:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// TODO: Implement the actual logic within the JS helper functions (adjustDriversJS, replaceIndirectsJS, etc.).\r\n// TODO: Implement findRowByValue helper function if Retained Earnings logic is needed.\r\n// TODO: Update the calling code (e.g., button handler in taskpane.js) to call `processAssumptionTabs` after `runCodes`.\r\n\r\n/**\r\n * Inserts worksheets from a base64-encoded Excel file into the current workbook\r\n * @param {string} base64String - Base64-encoded string of the source Excel file\r\n * @param {string[]} [sheetNames] - Optional array of sheet names to insert. If not provided, all sheets will be inserted.\r\n * @returns {Promise<void>}\r\n */\r\nexport async function handleInsertWorksheetsFromBase64(base64String, sheetNames = null) {\r\n    try {\r\n        // Validate base64 string\r\n        if (!base64String || typeof base64String !== 'string') {\r\n            throw new Error(\"Invalid base64 string provided\");\r\n        }\r\n\r\n        // Validate base64 format\r\n        if (!/^[A-Za-z0-9+/]*={0,2}$/.test(base64String)) {\r\n            throw new Error(\"Invalid base64 format\");\r\n        }\r\n\r\n        await Excel.run(async (context) => {\r\n            const workbook = context.workbook;\r\n            \r\n            // Check if we have the required API version\r\n            if (!workbook.insertWorksheetsFromBase64) {\r\n                throw new Error(\"This feature requires Excel API requirement set 1.13 or later\");\r\n            }\r\n            \r\n            // Insert the worksheets with error handling\r\n            try {\r\n                await workbook.insertWorksheetsFromBase64(base64String, {\r\n                    sheetNames: sheetNames\r\n                });\r\n                \r\n                await context.sync();\r\n                console.log(\"Worksheets inserted successfully\");\r\n            } catch (error) {\r\n                console.error(\"Error during worksheet insertion:\", error);\r\n                throw new Error(`Failed to insert worksheets: ${error.message}`);\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Error inserting worksheets from base64:\", error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Applies the Index Growth Curve logic to a worksheet, mimicking VBA Function IndexGrowthCurve.\r\n * Finds INDEXBEGIN/INDEXEND, inserts rows, populates data and formulas, applies formatting.\r\n * @param {Excel.Worksheet} worksheet - The assumption worksheet (within an Excel.run context).\r\n * @param {number} initialLastRow - The last row determined before this function runs.\r\n */\r\nasync function applyIndexGrowthCurveJS(worksheet, initialLastRow) {\r\n    console.log(`Running applyIndexGrowthCurveJS for sheet: ${worksheet.name}`);\r\n    const START_ROW = 9; // Row to start searching for INDEXBEGIN\r\n    const BEGIN_MARKER = \"INDEXBEGIN\";\r\n    const END_MARKER = \"INDEXEND\";\r\n    const DATA_COL = \"C\";\r\n    const SEARCH_COL = \"D\";\r\n    const OUTPUT_COL_B = \"B\";\r\n    const OUTPUT_COL_C = \"C\";\r\n    const OUTPUT_COL_D = \"D\";\r\n    const CHECK_COL_B = \"B\"; // Column B for green check\r\n    const VALUE_COL_A = \"A\"; // Column A for BS/AV check\r\n    const DRIVER_REF_COL = \"AE\"; // Column containing driver range ref in END_MARKER row\r\n    const SUMIF_START_COL = \"K\"; // K\r\n    const SUMIF_END_COL = \"P\"; // P\r\n    const SUMPRODUCT_COL = \"AE\"; // AE (VBA used AE, not S)\r\n    const MONTHS_START_COL = \"AE\"; // AE\r\n    const MONTHS_END_COL = \"CX\"; // CX\r\n    const LIGHT_BLUE_COLOR = \"#D9E1F2\"; // RGB(217, 225, 242)\r\n    const LIGHT_GREEN_COLOR = \"#CCFFCC\"; // RGB(204, 255, 204)\r\n \r\n    try {\r\n        // Re-get worksheet reference within this context to ensure freshness\r\n        const context = worksheet.context; // Get context from the passed object\r\n        const worksheetName = worksheet.name; // Get name from potentially stale object\r\n        const currentWorksheet = context.workbook.worksheets.getItem(worksheetName);\r\n        // We assume the context itself is valid for this entire Excel.run block\r\n \r\n        // --- 1. Find INDEXBEGIN and INDEXEND rows ---\r\n        console.log(`Searching for ${BEGIN_MARKER} and ${END_MARKER} in column ${SEARCH_COL} of ${worksheetName}`);\r\n        const searchRangeAddress = `${SEARCH_COL}${START_ROW}:${SEARCH_COL}${initialLastRow}`; \r\n        const searchRange = currentWorksheet.getRange(searchRangeAddress); // Use refreshed worksheet object\r\n        searchRange.load(\"values\");\r\n        await context.sync(); // Use the context variable\r\n \r\n        let firstRow = -1;\r\n        let lastRow = -1;\r\n        let indexEndRow = -1; // Keep track of the original END_MARKER row\r\n \r\n        if (searchRange.values) {\r\n            for (let i = 0; i < searchRange.values.length; i++) {\r\n                const currentRow = START_ROW + i;\r\n                const cellValue = searchRange.values[i][0];\r\n                if (cellValue === BEGIN_MARKER && firstRow === -1) {\r\n                    firstRow = currentRow;\r\n                }\r\n                if (cellValue === END_MARKER) {\r\n                    lastRow = currentRow; // This will be the last END_MARKER found\r\n                    indexEndRow = currentRow; // Store the original row index\r\n                }\r\n            }\r\n        }\r\n \r\n        if (firstRow === -1 || lastRow === -1 || lastRow < firstRow) {\r\n            console.log(`Markers ${BEGIN_MARKER}/${END_MARKER} not found or in wrong order in ${searchRangeAddress}. Skipping Index Growth Curve.`);\r\n            return; // Exit if markers not found or invalid\r\n        }\r\n        console.log(`Found ${BEGIN_MARKER} at row ${firstRow}, ${END_MARKER} at row ${lastRow}`);\r\n \r\n        // --- 2. Collect Index Rows (Rows between markers where Col C is not empty) ---\r\n        const indexRows = [];\r\n        // CHANGE DATA_COL here if needed, e.g. const DATA_COL_TO_CHECK = \"B\";\r\n        const DATA_COL_TO_CHECK = \"B\"; // Or \"A\", etc.\r\n        const dataColRangeAddress = `${DATA_COL_TO_CHECK}${firstRow}:${DATA_COL_TO_CHECK}${lastRow}`;\r\n        const dataColRange = currentWorksheet.getRange(dataColRangeAddress);\r\n        // ... rest of the loading and checking logic ...\r\n \r\n        if (indexRows.length === 0) {\r\n            console.log(`No data rows found between ${BEGIN_MARKER} and ${END_MARKER} in column ${DATA_COL}. Skipping rest of Index Growth Curve.`);\r\n            return; // Exit if no data rows found\r\n        }\r\n        console.log(`Collected ${indexRows.length} index rows:`, indexRows);\r\n \r\n        // --- 3. Set Background Color for non-green rows ---\r\n        // Range: B(firstRow+2) to CX(lastRow-2) in VBA, but logic only checks B color. Let's adjust row color based on B.\r\n        const formatCheckStartRow = firstRow + 2;\r\n        const formatCheckEndRow = lastRow - 2;\r\n        console.log(`Setting background color for non-green rows between ${formatCheckStartRow} and ${formatCheckEndRow}`);\r\n        if (formatCheckStartRow <= formatCheckEndRow) {\r\n             // Load colors first\r\n             const checkColorRange = currentWorksheet.getRange(`${CHECK_COL_B}${formatCheckStartRow}:${CHECK_COL_B}${formatCheckEndRow}`);\r\n             checkColorRange.load(\"format/fill/color\");\r\n             await context.sync();\r\n \r\n              // Queue formatting changes\r\n              for (let i = 0; i < checkColorRange.values.length; i++) { // checkColorRange.values isn't loaded, use index\r\n                 const currentRow = formatCheckStartRow + i;\r\n                  // Use loaded format object\r\n                 if (checkColorRange.format.fill.color !== LIGHT_GREEN_COLOR) {\r\n                     console.log(`  Setting row ${currentRow} background to ${LIGHT_BLUE_COLOR}`);\r\n                     const rowRange = currentWorksheet.getRange(`${currentRow}:${currentRow}`);\r\n                     rowRange.format.fill.color = LIGHT_BLUE_COLOR;\r\n                     // Clear fill in column A specifically\r\n                     const cellARange = currentWorksheet.getRange(`A${currentRow}`);\r\n                     cellARange.format.fill.clear();\r\n                 }\r\n              }\r\n         }\r\n \r\n         // --- 4. Insert Rows ---\r\n         const newRowStart = lastRow + 2;\r\n         const numNewRows = indexRows.length;\r\n         const newRowEnd = newRowStart + numNewRows - 1;\r\n         console.log(`Inserting ${numNewRows} rows at range ${newRowStart}:${newRowEnd}`);\r\n         const insertRange = currentWorksheet.getRange(`${newRowStart}:${newRowEnd}`);\r\n         insertRange.insert(Excel.InsertShiftDirection.down);\r\n         // Sync required before populating new rows\r\n         await context.sync();\r\n \r\n         // --- 5. Populate New Rows (B, C, D) ---\r\n         console.log(`Populating columns ${OUTPUT_COL_B}, ${OUTPUT_COL_C}, ${OUTPUT_COL_D} in new rows ${newRowStart}:${newRowEnd}`);\r\n         // Load source data from original index rows\r\n         const sourceDataAddresses = indexRows.map(r => `${OUTPUT_COL_B}${r}:${OUTPUT_COL_C}${r}`);\r\n         // Cannot load disjoint ranges easily this way. Load columns B and C for the whole original block.\r\n         const sourceBlockRange = currentWorksheet.getRange(`${OUTPUT_COL_B}${firstRow}:${OUTPUT_COL_C}${lastRow}`);\r\n         sourceBlockRange.load(\"values\");\r\n         await context.sync();\r\n \r\n         const outputDataBC = [];\r\n         const outputDataD = [];\r\n         const sourceValues = sourceBlockRange.values;\r\n         for (const originalRow of indexRows) {\r\n             const rowIndexInBlock = originalRow - firstRow; // 0-based index within the loaded block\r\n             const valB = sourceValues[rowIndexInBlock][0]; // Col B is index 0\r\n             const valC = sourceValues[rowIndexInBlock][1]; // Col C is index 1\r\n             outputDataBC.push([valB, valC]);\r\n             outputDataD.push([END_MARKER]);\r\n         }\r\n \r\n         const outputRangeBC = currentWorksheet.getRange(`${OUTPUT_COL_B}${newRowStart}:${OUTPUT_COL_C}${newRowEnd}`);\r\n         outputRangeBC.values = outputDataBC;\r\n         const outputRangeD = currentWorksheet.getRange(`${OUTPUT_COL_D}${newRowStart}:${OUTPUT_COL_D}${newRowEnd}`);\r\n         outputRangeD.values = outputDataD;\r\n \r\n         // --- 6. Apply SUMIF Formulas (K-P) ---\r\n         console.log(`Applying SUMIF formulas to ${SUMIF_START_COL}${newRowStart}:${SUMIF_END_COL}${newRowEnd}`);\r\n         // Load necessary data: Col C and Col A values from original index rows\r\n         const sourceColCRange = currentWorksheet.getRange(`${DATA_COL}${firstRow}:${DATA_COL}${lastRow}`);\r\n         const sourceColARange = currentWorksheet.getRange(`${VALUE_COL_A}${firstRow}:${VALUE_COL_A}${lastRow}`);\r\n         sourceColCRange.load(\"values\");\r\n         sourceColARange.load(\"values\");\r\n         await context.sync();\r\n \r\n         const sourceValuesC = sourceColCRange.values;\r\n         const sourceValuesA = sourceColARange.values;\r\n         const numSumifCols = columnLetterToIndex(SUMIF_END_COL) - columnLetterToIndex(SUMIF_START_COL) + 1;\r\n         const sumifFormulas = [];\r\n \r\n         for (let i = 0; i < indexRows.length; i++) {\r\n             const originalRow = indexRows[i];\r\n             const rowIndexInBlock = originalRow - firstRow; // 0-based index within the loaded block\r\n             const codeC = sourceValuesC[rowIndexInBlock][0] || \"\"; // Ensure string\r\n             const valueA = sourceValuesA[rowIndexInBlock][0];\r\n             const targetRowNum = newRowStart + i; // Row where formula will be placed\r\n \r\n             let baseFormula;\r\n             // Check if Col C starts with \"BS\" or Col A is \"AV\"\r\n             if (codeC.toUpperCase().startsWith(\"BS\") || String(valueA).toUpperCase() === \"AV\") {\r\n                 // \"=SUMIF($3:$3,@ INDIRECT(ADDRESS(ROW($A$2),COLUMN(),2)), INDIRECT(ROW() & \"\":\"\" & ROW()))\"\r\n                  baseFormula = `=SUMIF($3:$3, INDIRECT(ADDRESS(2,COLUMN())), ${targetRowNum}:${targetRowNum})`;\r\n             } else {\r\n                 // \"=SUMIF($4:$4,@ INDIRECT(ADDRESS(ROW($A$2),COLUMN(),2)), INDIRECT(ROW() & \"\":\"\" & ROW()))\"\r\n                  baseFormula = `=SUMIF($4:$4, INDIRECT(ADDRESS(2,COLUMN())), ${targetRowNum}:${targetRowNum})`;\r\n             }\r\n             // Create array for the row\r\n             sumifFormulas.push(Array(numSumifCols).fill(baseFormula));\r\n         }\r\n \r\n         const sumifRange = currentWorksheet.getRange(`${SUMIF_START_COL}${newRowStart}:${SUMIF_END_COL}${newRowEnd}`);\r\n         sumifRange.formulas = sumifFormulas;\r\n \r\n         // --- 7. Apply SUMPRODUCT Formulas (AE) ---\r\n         console.log(`Applying SUMPRODUCT formulas to ${SUMPRODUCT_COL}${newRowStart}:${SUMPRODUCT_COL}${newRowEnd}`);\r\n         // Get the driver range string from the original END_MARKER row, column AE\r\n         const driverCell = currentWorksheet.getRange(`${DRIVER_REF_COL}${indexEndRow}`);\r\n         driverCell.load(\"values\");\r\n         await context.sync();\r\n         const driverRangeString = driverCell.values[0][0];\r\n \r\n         if (!driverRangeString || typeof driverRangeString !== 'string') {\r\n             console.warn(`Driver range string not found or invalid in cell ${DRIVER_REF_COL}${indexEndRow}. Skipping SUMPRODUCT.`);\r\n         } else {\r\n              console.log(`Using driver range: ${driverRangeString}`);\r\n              // Iterate and set formula for each cell individually (mimics FormulaArray)\r\n              for (let i = 0; i < indexRows.length; i++) {\r\n                  const originalRow = indexRows[i];\r\n                  const targetRow = newRowStart + i;\r\n                  const dataRangeString = `$${MONTHS_START_COL}$${originalRow}:$${MONTHS_END_COL}$${originalRow}`;\r\n                  // Formula: =SUMPRODUCT(INDEX(driverRange, N(IF({1}, MAX(COLUMN(driverRange)) - COLUMN(driverRange) + 1))), dataRange)\r\n                  const sumproductFormula = `=SUMPRODUCT(INDEX(${driverRangeString},N(IF({1},MAX(COLUMN(${driverRangeString}))-COLUMN(${driverRangeString})+1))), ${dataRangeString})`;\r\n \r\n                  const targetCell = currentWorksheet.getRange(`${SUMPRODUCT_COL}${targetRow}`);\r\n                  targetCell.formulas = [[sumproductFormula]];\r\n                  // console.log(`  Set formula for ${SUMPRODUCT_COL}${targetRow}: ${sumproductFormula}`);\r\n             }\r\n         }\r\n \r\n         // --- 8. Copy Formats and Adjust ---\r\n         console.log(`Copying formats and adjusting for new rows ${newRowStart}:${newRowEnd}`);\r\n         for (let i = 0; i < indexRows.length; i++) {\r\n             const sourceRow = indexRows[i];\r\n             const targetRow = newRowStart + i;\r\n \r\n             const sourceRowRange = currentWorksheet.getRange(`${sourceRow}:${sourceRow}`);\r\n             const targetRowRange = currentWorksheet.getRange(`${targetRow}:${targetRow}`);\r\n \r\n             // Copy formats first\r\n             targetRowRange.copyFrom(sourceRowRange, Excel.RangeCopyType.formats);\r\n              await context.sync(); // Sync after each copy maybe needed? Let's try one sync after loop.\r\n \r\n             // Apply format overrides\r\n             targetRowRange.format.font.color = \"#000000\"; // Black font\r\n             targetRowRange.format.borders.load('items'); // Load borders collection\r\n              await context.sync(); // Need to sync load before clearing\r\n \r\n              targetRowRange.format.borders.items.forEach(border => border.style = 'None');\r\n             // Explicitly clear all borders (simpler?)\r\n             // targetRowRange.format.borders.getItem('EdgeTop').style = 'None';\r\n             // targetRowRange.format.borders.getItem('EdgeBottom').style = 'None';\r\n             // targetRowRange.format.borders.getItem('EdgeLeft').style = 'None';\r\n             // targetRowRange.format.borders.getItem('EdgeRight').style = 'None';\r\n             // targetRowRange.format.borders.getItem('InsideVertical').style = 'None';\r\n             // targetRowRange.format.borders.getItem('InsideHorizontal').style = 'None';\r\n \r\n             targetRowRange.format.fill.clear(); // Clear interior color\r\n             targetRowRange.format.font.bold = false; // Remove bold\r\n \r\n             // Set indent level for column B\r\n             const targetCellB = currentWorksheet.getRange(`${OUTPUT_COL_B}${targetRow}`);\r\n             targetCellB.format.indentLevel = 2;\r\n         }\r\n          await context.sync(); // Sync format changes\r\n \r\n         // --- 9. Clear Original Column C values ---\r\n         console.log(`Clearing values in original index rows (${indexRows.join(', ')}) column ${DATA_COL}`);\r\n         // It's safer to clear individually if rows aren't contiguous\r\n         for (const originalRow of indexRows) {\r\n             const cellToClear = currentWorksheet.getRange(`${DATA_COL}${originalRow}`);\r\n             cellToClear.clear(Excel.ClearApplyTo.contents);\r\n         }\r\n          await context.sync(); // Sync clears\r\n \r\n         console.log(`applyIndexGrowthCurveJS completed successfully for sheet: ${worksheetName}`);\r\n \r\n     } catch (error) {\r\n         console.error(`Error in applyIndexGrowthCurveJS for sheet ${worksheet.name}:`, error);\r\n         // Decide if error should be re-thrown\r\n         // throw error; // Optional: re-throw to stop processAssumptionTabs if critical\r\n     }\r\n     // Note: This function runs within the context of the calling Excel.run in processAssumptionTabs.\r\n     // Syncs are added within the function for critical steps like after insertion.\r\n }","// Helper function to build the pipe-delimited string for a row\r\nfunction buildRowArrayString(valuesRow, formulasRow) {\r\n    // ... (Helper function remains the same)\r\n    // Indices: A=0, B=1, C=2, G=6, H=7, I=8, K=10, L=11, M=12, N=13, O=14, P=15, R=17\r\n    const cols = [0, 1, 2, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17];\r\n    const formulaCols = [10, 11, 12, 13, 14, 15, 17]; // Columns to check for formulas\r\n    let parts = [];\r\n\r\n    if (!valuesRow) return \"\"; // Handle case where row might be completely empty\r\n\r\n    for (const colIndex of cols) {\r\n        // Ensure the row has enough columns\r\n        let value = (valuesRow.length > colIndex && valuesRow[colIndex] !== null && valuesRow[colIndex] !== undefined) ? valuesRow[colIndex] : \"\";\r\n        let formula = (formulasRow && formulasRow.length > colIndex) ? formulasRow[colIndex] : null;\r\n\r\n        if (formulaCols.includes(colIndex)) {\r\n            // Check formula first\r\n            if (typeof formula === 'string' && formula.startsWith('=')) {\r\n                value = \"F\";\r\n            }\r\n        }\r\n        const valueString = String(value).replace(/\"/g, '\"\"');\r\n        parts.push(valueString);\r\n    }\r\n    return parts.join(\"|\");\r\n}\r\n\r\n// Helper function to process a standard code block based on Column D\r\nfunction processCodeBlock(values, formulas, startDataRowIndex, endDataRowIndex, codeName, rangeStartRowExcel) {\r\n    // console.log(`Processing block: ${codeName} from Excel row ${startDataRowIndex + rangeStartRowExcel} to ${endDataRowIndex + rangeStartRowExcel}`);\r\n    let blockString = `<${codeName};`;\r\n    let rowCount = 1;\r\n    // The indices i here are 0-based relative to the START of the loaded data range\r\n    for (let i = startDataRowIndex; i <= endDataRowIndex; i++) {\r\n        if (values && i < values.length && formulas && i < formulas.length) {\r\n            const rowArrayString = buildRowArrayString(values[i], formulas[i]);\r\n            blockString += `row${rowCount}=\"${rowArrayString}\";`;\r\n            rowCount++;\r\n        } else {\r\n             // console.warn(`Skipping data row index ${i} in block ${codeName} due to missing data.`);\r\n        }\r\n    }\r\n    blockString += \">\";\r\n    // console.log(`Generated block string for ${codeName}: ${blockString.substring(0,100)}...`);\r\n    return blockString;\r\n}\r\n\r\nexport async function generateTabString() {\r\n    try {\r\n        await Excel.run(async (context) => {\r\n            console.log(\"Starting generateTabString (dynamic range)...\");\r\n            const sheets = context.workbook.worksheets;\r\n            sheets.load(\"items/name\");\r\n            await context.sync();\r\n            console.log(`Found ${sheets.items.length} sheets.`);\r\n\r\n            let finalResultString = \"\";\r\n\r\n            for (const sheet of sheets.items) {\r\n                console.log(`Processing sheet: ${sheet.name}`);\r\n                let sheetCodeBlocks = \"\";\r\n                let lastUsedRowInB = 0;\r\n\r\n                try {\r\n                    // --- Find the last used row in Column B ---\r\n                    // Get the bottom-most cell in column B (using a large row number)\r\n                    const bottomCellInB = sheet.getRange(\"B1048576\");\r\n                    // Find the last used cell *up* from the absolute bottom\r\n                    const lastUsedCellInB = bottomCellInB.getRangeEdge(Excel.KeyboardDirection.up);\r\n                    lastUsedCellInB.load(\"rowIndex\");\r\n                    await context.sync();\r\n\r\n                    // Add 1 because rowIndex is 0-based\r\n                    lastUsedRowInB = lastUsedCellInB.rowIndex + 1;\r\n                    console.log(`Sheet ${sheet.name}: Last used row in Col B found at: ${lastUsedRowInB}`);\r\n\r\n                    // --- Validate last row and define dynamic range ---\r\n                    if (lastUsedRowInB < 9) {\r\n                        console.log(`Sheet ${sheet.name}: Last used row (${lastUsedRowInB}) is before row 9. Skipping code generation.`);\r\n                        finalResultString += `<TAB; label1=\"${sheet.name}\";>\\n\\n`; // Add TAB tag even if no codes\r\n                        continue; // Skip to the next sheet\r\n                    }\r\n\r\n                    const dynamicRangeAddress = `A9:R${lastUsedRowInB}`;\r\n                    console.log(`Sheet ${sheet.name}: Loading dynamic range: ${dynamicRangeAddress}`);\r\n\r\n                    // --- Load data from the dynamic range --- Load data from the dynamic range ---\r\n                    const range = sheet.getRange(dynamicRangeAddress);\r\n                    range.load([\"values\", \"formulas\", \"rowCount\", \"rowIndex\"]);\r\n                    await context.sync();\r\n\r\n                    const values = range.values;\r\n                    const formulas = range.formulas;\r\n                    const loadedRowCount = range.rowCount;\r\n                    const rangeStartRowExcel = range.rowIndex + 1; // Should be 9\r\n\r\n                    if (rangeStartRowExcel !== 9) {\r\n                         console.warn(`Sheet ${sheet.name}: Loaded range started at ${rangeStartRowExcel} instead of 9.`);\r\n                    }\r\n                    if (!values || loadedRowCount === 0) {\r\n                        console.log(`Sheet ${sheet.name}: No values loaded from range ${dynamicRangeAddress}. Skipping code generation.`);\r\n                        finalResultString += `<TAB; label1=\"${sheet.name}\";>\\n\\n`;\r\n                        continue; // Skip to the next sheet\r\n                    }\r\n\r\n                    // --- Process the loaded data --- Process the loaded data ---\r\n                    // Check if Column D (index 3 in the loaded array) has significant data\r\n                    let hasDataInD = false;\r\n                    for (let r = 0; r < loadedRowCount; r++) {\r\n                         if (values[r] && values[r].length > 3 && values[r][3] && String(values[r][3]).trim() !== \"\") {\r\n                            hasDataInD = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    console.log(`Sheet ${sheet.name}: Has significant data in Column D (in loaded range)? ${hasDataInD}`);\r\n\r\n                    if (!hasDataInD) {\r\n                        // --- Generate MANUAL-ER Block ---\r\n                        console.log(`Sheet ${sheet.name}: Generating MANUAL-ER block.`);\r\n                        sheetCodeBlocks += \"<MANUAL-ER;\";\r\n                        let manualRowCount = 1;\r\n                        for (let r = 0; r < loadedRowCount; r++) {\r\n                            if (values[r] && formulas[r]) { // Ensure row data exists\r\n                                const rowArrayString = buildRowArrayString(values[r], formulas[r]);\r\n                                sheetCodeBlocks += `row${manualRowCount}=\"${rowArrayString}\";`;\r\n                                manualRowCount++;\r\n                            }\r\n                        }\r\n                        sheetCodeBlocks += \">\";\r\n\r\n                    } else {\r\n                        // --- Generate Blocks Based on Column D ---\r\n                        console.log(`Sheet ${sheet.name}: Generating blocks based on Column D changes.`);\r\n                        let currentBlockStartDataRow = -1;\r\n                        let currentBlockCodeName = \"\";\r\n\r\n                        for (let r = 0; r < loadedRowCount; r++) {\r\n                            const dValue = (values[r] && values[r].length > 3 && values[r][3]) ? String(values[r][3]).trim() : \"\";\r\n\r\n                            if (dValue !== \"\") {\r\n                                if (currentBlockStartDataRow === -1) {\r\n                                    currentBlockStartDataRow = r;\r\n                                    currentBlockCodeName = dValue;\r\n                                } else if (dValue !== currentBlockCodeName) {\r\n                                    // Add newline before appending if sheetCodeBlocks isn't empty\r\n                                    if (sheetCodeBlocks) sheetCodeBlocks += \"\\n\";\r\n                                    sheetCodeBlocks += processCodeBlock(values, formulas, currentBlockStartDataRow, r - 1, currentBlockCodeName, rangeStartRowExcel);\r\n                                    currentBlockStartDataRow = r;\r\n                                    currentBlockCodeName = dValue;\r\n                                }\r\n                            } else { // Empty D value\r\n                                if (currentBlockStartDataRow !== -1) {\r\n                                    // Add newline before appending if sheetCodeBlocks isn't empty\r\n                                    if (sheetCodeBlocks) sheetCodeBlocks += \"\\n\";\r\n                                    sheetCodeBlocks += processCodeBlock(values, formulas, currentBlockStartDataRow, r - 1, currentBlockCodeName, rangeStartRowExcel);\r\n                                    currentBlockStartDataRow = -1;\r\n                                    currentBlockCodeName = \"\";\r\n                                }\r\n                            }\r\n\r\n                            // Handle the last block if the loop finishes while inside a block\r\n                            if (r === loadedRowCount - 1 && currentBlockStartDataRow !== -1) {\r\n                                // Add newline before appending if sheetCodeBlocks isn't empty\r\n                                if (sheetCodeBlocks) sheetCodeBlocks += \"\\n\";\r\n                                sheetCodeBlocks += processCodeBlock(values, formulas, currentBlockStartDataRow, r, currentBlockCodeName, rangeStartRowExcel);\r\n                            }\r\n                        } // end for loop r\r\n                    } // end else (hasDataInD)\r\n\r\n                } catch (sheetError) {\r\n                     console.error(`Error processing sheet ${sheet.name}: ${sheetError}`);\r\n                     if (sheetError instanceof OfficeExtension.Error) {\r\n                         console.error(\"Debug info: \" + JSON.stringify(sheetError.debugInfo));\r\n                     }\r\n                     sheetCodeBlocks = \"<!-- Error processing sheet data -->\";\r\n                }\r\n\r\n                // Append the result for this sheet\r\n                // Add a newline between TAB and blocks only if blocks exist\r\n                let tabLine = `<TAB; label1=\"${sheet.name}\";>`;\r\n                if (sheetCodeBlocks) {\r\n                    tabLine += \"\\n\" + sheetCodeBlocks; // Add newline before the blocks\r\n                }\r\n                finalResultString += tabLine + \"\\n\\n\"; // Add double newline after each sheet entry\r\n            } // end loop sheets\r\n\r\n            console.log(\"--- FINAL GENERATED STRING ---\");\r\n            console.log(finalResultString);\r\n            console.log(\"--- END FINAL GENERATED STRING ---\");\r\n\r\n        }); // end Excel.run\r\n    } catch (error) {\r\n        console.error(\"Error in generateTabString top level: \" + error);\r\n        if (error instanceof OfficeExtension.Error) {\r\n            console.error(\"Debug info: \" + JSON.stringify(error.debugInfo));\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n/* global console, document, Excel, Office */\r\n\r\n// Remove imports from Langchain to avoid ESM module issues\r\n// Using direct fetch calls instead\r\n// Add this test function\r\nimport { validateCodeStrings } from './Validation.js';\r\n// Import the spreadsheet utilities\r\n// import { handleInsertWorksheetsFromBase64 } from './SpreadsheetUtils.js';\r\n// Import code collection functions\r\nimport { populateCodeCollection, exportCodeCollectionToText, runCodes, processAssumptionTabs, collapseGroupingsAndNavigateToFinancials, hideColumnsAndNavigate, handleInsertWorksheetsFromBase64 } from './CodeCollection.js';\r\n// >>> ADDED: Import the new validation function\r\nimport { validateCodeStringsForRun } from './Validation.js';\r\n// >>> ADDED: Import the tab string generator function\r\nimport { generateTabString } from './IndexWorksheet.js';\r\n// Add the codeStrings variable with the specified content\r\n// REMOVED hardcoded codeStrings variable\r\n\r\nimport { API_KEYS as configApiKeys } from '../../config.js'; // Assuming config.js exports API_KEYS\r\n\r\n// Mock fs module for browser environment (if needed within AIcalls)\r\nconst fs = {\r\n    writeFileSync: (path, content) => {\r\n        console.log(`Mock writeFileSync called with path: ${path}`);\r\n        // In browser, we'll just log the content instead of writing to file\r\n        console.log(`Content would be written to ${path}:`, content.substring(0, 100) + '...');\r\n    }\r\n};\r\n\r\n//*********Setup*********\r\n// Start the timer\r\nconst startTime = performance.now();\r\n\r\n//Debugging Toggle\r\nconst DEBUG = true;\r\n\r\n// Variable to store loaded code strings\r\nlet loadedCodeStrings = \"\";\r\n\r\n// Variable to store the parsed code database\r\nlet codeDatabase = [];\r\n\r\n// >>> ADDED: Variables for search/replace state <<<\r\n// >>> REMOVED: Main search/replace state variables <<<\r\n// let lastSearchTerm = '';\r\n// let lastSearchIndex = -1; // Tracks the starting index of the last found match\r\n// let searchResultIndices = []; // Stores indices of all matches for Replace All\r\n// let currentHighlightIndex = -1; // Index within searchResultIndices for Find Next\r\n\r\n// API keys storage - initialized by initializeAPIKeys\r\nlet INTERNAL_API_KEYS = {\r\n  OPENAI_API_KEY: \"\",\r\n  PINECONE_API_KEY: \"\"\r\n};\r\n\r\n// Function to set API keys from outside this module\r\nexport function setAPIKeys(keys) {\r\n  if (keys && typeof keys === 'object') {\r\n    if (keys.OPENAI_API_KEY) {\r\n      INTERNAL_API_KEYS.OPENAI_API_KEY = keys.OPENAI_API_KEY;\r\n      console.log(\"AIcalls.js: OpenAI API key set externally\");\r\n    }\r\n    if (keys.PINECONE_API_KEY) {\r\n      INTERNAL_API_KEYS.PINECONE_API_KEY = keys.PINECONE_API_KEY;\r\n      console.log(\"AIcalls.js: Pinecone API key set externally\");\r\n    }\r\n  }\r\n}\r\n\r\nconst srcPaths = [\r\n  'https://localhost:3002/src/prompts/Encoder_System.txt',\r\n  'https://localhost:3002/src/prompts/Encoder_Main.txt',\r\n  'https://localhost:3002/src/prompts/Followup_System.txt',\r\n  'https://localhost:3002/src/prompts/Structure_System.txt',\r\n  'https://localhost:3002/src/prompts/Validation_System.txt',\r\n  'https://localhost:3002/src/prompts/Validation_Main.txt'\r\n];\r\n\r\n// Function to load the code string database\r\nasync function loadCodeDatabase() {\r\n  try {\r\n    console.log(\"Loading code database...\");\r\n    const response = await fetch('https://localhost:3002/assets/codestringDB.txt');\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to load codestringDB.txt: ${response.statusText}`);\r\n    }\r\n    const text = await response.text();\r\n    const lines = text.split(/[\\r\\n]+/).filter(line => line.trim() !== ''); // Split by lines and remove empty ones\r\n\r\n    codeDatabase = lines.map(line => {\r\n      const parts = line.split('\\t'); // Assuming tab-separated\r\n      if (parts.length >= 2) {\r\n        return { name: parts[0].trim(), code: parts[1].trim() };\r\n      }\r\n      console.warn(`Skipping malformed line in codestringDB.txt: ${line}`);\r\n      return null;\r\n    }).filter(item => item !== null); // Filter out null entries from malformed lines\r\n\r\n    console.log(`Code database loaded successfully with ${codeDatabase.length} entries.`);\r\n    if (DEBUG && codeDatabase.length > 0) {\r\n        console.log(\"First few code database entries:\", codeDatabase.slice(0, 5));\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error(\"Error loading code database:\", error);\r\n    showError(\"Failed to load code database. Search functionality will be unavailable.\");\r\n    codeDatabase = []; // Ensure it's empty on error\r\n  }\r\n}\r\n\r\n// Function to load API keys from a config file\r\n// This allows the keys to be stored in a separate file that's .gitignored\r\nexport async function initializeAPIKeys() {\r\n  try {\r\n    console.log(\"Initializing API keys from AIcalls.js...\");\r\n\r\n    // Use keys from imported config.js if available\r\n    if (configApiKeys?.OPENAI_API_KEY) {\r\n        INTERNAL_API_KEYS.OPENAI_API_KEY = configApiKeys.OPENAI_API_KEY;\r\n        console.log(\"OpenAI API key loaded from config.js\");\r\n    } else {\r\n         console.warn(\"OpenAI API key not found in config.js.\");\r\n    }\r\n\r\n    if (configApiKeys?.PINECONE_API_KEY) {\r\n        INTERNAL_API_KEYS.PINECONE_API_KEY = configApiKeys.PINECONE_API_KEY;\r\n        console.log(\"Pinecone API key loaded from config.js\");\r\n    } else {\r\n         console.warn(\"Pinecone API key not found in config.js.\");\r\n    }\r\n\r\n    // Fallback: try fetching from the old location if config.js didn't provide them\r\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY || !INTERNAL_API_KEYS.PINECONE_API_KEY) {\r\n        console.log(\"Attempting fallback API key loading from https://localhost:3002/config.js\");\r\n        try {\r\n            const configResponse = await fetch('https://localhost:3002/config.js');\r\n            if (configResponse.ok) {\r\n                const configText = await configResponse.text();\r\n                // Extract keys from the config text using regex\r\n                const openaiKeyMatch = configText.match(/OPENAI_API_KEY\\s*=\\s*[\"']([^\"']+)[\"']/);\r\n                const pineconeKeyMatch = configText.match(/PINECONE_API_KEY\\s*=\\s*[\"']([^\"']+)[\"']/);\r\n\r\n                if (!INTERNAL_API_KEYS.OPENAI_API_KEY && openaiKeyMatch && openaiKeyMatch[1]) {\r\n                    INTERNAL_API_KEYS.OPENAI_API_KEY = openaiKeyMatch[1];\r\n                    console.log(\"OpenAI API key loaded via fetch fallback.\");\r\n                }\r\n\r\n                if (!INTERNAL_API_KEYS.PINECONE_API_KEY && pineconeKeyMatch && pineconeKeyMatch[1]) {\r\n                    INTERNAL_API_KEYS.PINECONE_API_KEY = pineconeKeyMatch[1];\r\n                    console.log(\"Pinecone API key loaded via fetch fallback.\");\r\n                }\r\n            } else {\r\n                 console.warn(\"Fallback fetch for config.js failed or returned non-OK status.\");\r\n            }\r\n        } catch (error) {\r\n            console.warn(\"Could not load config.js via fetch fallback:\", error);\r\n        }\r\n    }\r\n\r\n    // Add debug logging with secure masking of keys\r\n    console.log(\"Loaded API Keys (AIcalls.js):\");\r\n    console.log(\"  OPENAI_API_KEY:\", INTERNAL_API_KEYS.OPENAI_API_KEY ?\r\n      `${INTERNAL_API_KEYS.OPENAI_API_KEY.substring(0, 3)}...${INTERNAL_API_KEYS.OPENAI_API_KEY.substring(INTERNAL_API_KEYS.OPENAI_API_KEY.length - 3)}` :\r\n      \"Not found\");\r\n    console.log(\"  PINECONE_API_KEY:\", INTERNAL_API_KEYS.PINECONE_API_KEY ?\r\n      `${INTERNAL_API_KEYS.PINECONE_API_KEY.substring(0, 3)}...${INTERNAL_API_KEYS.PINECONE_API_KEY.substring(INTERNAL_API_KEYS.PINECONE_API_KEY.length - 3)}` :\r\n      \"Not found\");\r\n\r\n    const keysFound = !!(INTERNAL_API_KEYS.OPENAI_API_KEY && INTERNAL_API_KEYS.PINECONE_API_KEY);\r\n    console.log(\"API Keys Initialized:\", keysFound);\r\n    // Return a copy to prevent external modification of the internal state\r\n    return { ...INTERNAL_API_KEYS };\r\n\r\n  } catch (error) {\r\n    console.error(\"Error initializing API keys:\", error);\r\n    // Return empty keys on error\r\n    return { OPENAI_API_KEY: \"\", PINECONE_API_KEY: \"\" };\r\n  }\r\n}\r\n\r\n// Update Pinecone configuration to handle multiple indexes\r\nconst PINECONE_ENVIRONMENT = \"gcp-starter\";\r\n\r\n// Define configurations for each index\r\nconst PINECONE_INDEXES = {\r\n    codes: {\r\n        name: \"codes\",\r\n        apiEndpoint: \"https://codes-zmg9zog.svc.aped-4627-b74a.pinecone.io\"\r\n    },\r\n    call2trainingdata: {\r\n        name: \"call2trainingdata\",\r\n        apiEndpoint: \"https://call2trainingdata-zmg9zog.svc.aped-4627-b74a.pinecone.io\"\r\n    },\r\n    call2context: {\r\n        name: \"call2context\",\r\n        apiEndpoint: \"https://call2context-zmg9zog.svc.aped-4627-b74a.pinecone.io\"\r\n    },\r\n    call1context: {\r\n        name: \"call1context\",\r\n        apiEndpoint: \"https://call1context-zmg9zog.svc.aped-4627-b74a.pinecone.io\"\r\n    }\r\n};\r\n\r\n//Models\r\nconst GPT4O_MINI = \"gpt-4o-mini\"\r\nconst GPT4O = \"gpt-4o\"\r\nconst GPT41 = \"gpt-4.1\"\r\nconst GPT45_TURBO = \"gpt-4.5-turbo\"\r\nconst GPT35_TURBO = \"gpt-3.5-turbo\"\r\nconst GPT4_TURBO = \"gpt-4-turbo\"\r\nconst GPTFT1 =  \"ft:gpt-3.5-turbo-1106:orsi-advisors:cohcolumnsgpt35:B6Wlrql1\"\r\n\r\n// Conversation history storage\r\nlet conversationHistory = [];\r\n\r\n// Functions to save and load conversation history (use localStorage directly)\r\nexport function saveConversationHistory(history) {\r\n    try {\r\n        localStorage.setItem('conversationHistory', JSON.stringify(history));\r\n        if (DEBUG) console.log('Conversation history saved to localStorage');\r\n    } catch (error) {\r\n        console.error(\"Error saving conversation history:\", error);\r\n    }\r\n}\r\n\r\nexport function loadConversationHistory() {\r\n    try {\r\n        const history = localStorage.getItem('conversationHistory');\r\n        if (history) {\r\n            if (DEBUG) console.log('Loaded conversation history from localStorage');\r\n            const parsedHistory = JSON.parse(history);\r\n\r\n            if (!Array.isArray(parsedHistory)) {\r\n                console.error(\"Invalid history format, expected array\");\r\n                return [];\r\n            }\r\n\r\n            return parsedHistory;\r\n        }\r\n        if (DEBUG) console.log(\"No conversation history found in localStorage\");\r\n        return [];\r\n    } catch (error) {\r\n        console.error(\"Error loading conversation history:\", error);\r\n        return [];\r\n    }\r\n}\r\n\r\n// Direct OpenAI API call function\r\nexport async function callOpenAI(messages, model = GPT41, temperature = 0.7) {\r\n  try {\r\n    console.log(`Calling OpenAI API with model: ${model}`);\r\n\r\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY) {\r\n      throw new Error(\"OpenAI API key not found. Please check your API keys.\");\r\n    }\r\n\r\n    const response = await fetch('https://api.openai.com/v1/chat/completions', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${INTERNAL_API_KEYS.OPENAI_API_KEY}`\r\n      },\r\n      body: JSON.stringify({\r\n        model: model,\r\n        messages: messages,\r\n        temperature: temperature\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => null);\r\n      console.error(\"OpenAI API error response:\", errorData);\r\n      throw new Error(`OpenAI API error: ${response.status} ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log(\"OpenAI API response received\");\r\n\r\n    return data.choices[0].message.content;\r\n  } catch (error) {\r\n    console.error(\"Error calling OpenAI API:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// OpenAI embeddings function\r\nexport async function createEmbedding(text) {\r\n  try {\r\n    console.log(\"Creating embedding for text\");\r\n\r\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY) {\r\n      throw new Error(\"OpenAI API key not found. Please check your API keys.\");\r\n    }\r\n\r\n    const response = await fetch('https://api.openai.com/v1/embeddings', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${INTERNAL_API_KEYS.OPENAI_API_KEY}`\r\n      },\r\n      body: JSON.stringify({\r\n        model: \"text-embedding-3-large\",\r\n        input: text\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => null);\r\n      console.error(\"OpenAI Embeddings API error response:\", errorData);\r\n      throw new Error(`OpenAI Embeddings API error: ${response.status} ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    console.log(\"OpenAI Embeddings API response received\");\r\n\r\n    return data.data[0].embedding;\r\n  } catch (error) {\r\n    console.error(\"Error creating embedding:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Function to load prompts from files\r\nexport async function loadPromptFromFile(promptKey) {\r\n  try {\r\n    const paths = [\r\n      `https://localhost:3002/prompts/${promptKey}.txt`,\r\n      ...srcPaths // Add fallback paths if needed\r\n    ];\r\n\r\n    let response = null;\r\n    for (const path of paths) {\r\n      if (DEBUG) console.log(`Attempting to load prompt from: ${path}`);\r\n      try {\r\n        response = await fetch(path);\r\n        if (response.ok) {\r\n          if (DEBUG) console.log(`Successfully loaded prompt from: ${path}`);\r\n          break;\r\n        }\r\n      } catch (err) {\r\n        if (DEBUG) console.log(`Path ${path} failed: ${err.message}`);\r\n      }\r\n    }\r\n\r\n    if (!response || !response.ok) {\r\n      throw new Error(`Failed to load prompt: ${promptKey} (Could not find file in any location)`);\r\n    }\r\n\r\n    return await response.text();\r\n  } catch (error) {\r\n    console.error(`Error loading prompt ${promptKey}:`, error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Function to get system prompt from file\r\nexport async function getSystemPromptFromFile(promptKey) {\r\n  try {\r\n    const prompt = await loadPromptFromFile(promptKey);\r\n    if (!prompt) {\r\n      throw new Error(`Prompt key \"${promptKey}\" not found`);\r\n    }\r\n    return prompt;\r\n  } catch (error) {\r\n    console.error(`Error getting prompt for key ${promptKey}:`, error);\r\n    return null; // Return null or handle error as appropriate\r\n  }\r\n};\r\n\r\n// Function: OpenAI Call with conversation history support\r\nexport async function processPrompt({ userInput, systemPrompt, model, temperature, history = [] }) {\r\n    if (DEBUG) console.log(\"API Key being used for processPrompt:\", INTERNAL_API_KEYS.OPENAI_API_KEY ? `${INTERNAL_API_KEYS.OPENAI_API_KEY.substring(0, 3)}...` : \"None\");\r\n\r\n    const messages = [\r\n        { role: \"system\", content: systemPrompt }\r\n    ];\r\n\r\n    if (history.length > 0) {\r\n        history.forEach(message => {\r\n            // Ensure message is in the correct format [role, content]\r\n             if (Array.isArray(message) && message.length === 2) {\r\n                 messages.push({\r\n                     role: message[0] === \"human\" ? \"user\" : \"assistant\",\r\n                     content: message[1]\r\n                 });\r\n             } else {\r\n                 console.warn(\"Skipping malformed history message:\", message);\r\n             }\r\n        });\r\n    }\r\n\r\n    messages.push({ role: \"user\", content: userInput });\r\n\r\n    try {\r\n        const responseContent = await callOpenAI(messages, model, temperature);\r\n\r\n        // Try to parse JSON response if applicable, otherwise split lines\r\n        try {\r\n            const parsed = JSON.parse(responseContent);\r\n            // Expecting an array of strings based on original code\r\n            if (Array.isArray(parsed)) {\r\n                return parsed;\r\n            }\r\n            // If not array, maybe single string JSON? Unlikely based on usage.\r\n             console.warn(\"Parsed JSON response, but it was not an array:\", parsed);\r\n             // Fallback to splitting the original string\r\n             return responseContent.split('\\n').filter(line => line.trim());\r\n        } catch (e) {\r\n            return responseContent.split('\\n').filter(line => line.trim());\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error in processPrompt:\", error);\r\n        throw error; // Re-throw to be caught by caller\r\n    }\r\n}\r\n\r\n// Function: Structure database queries\r\nexport async function structureDatabasequeries(clientprompt) {\r\n  if (DEBUG) console.log(\"Processing structured database queries:\", clientprompt);\r\n\r\n  try {\r\n      if (DEBUG) console.log(\"Getting structure system prompt\");\r\n      const systemStructurePrompt = await getSystemPromptFromFile('Structure_System');\r\n\r\n      if (!systemStructurePrompt) {\r\n          throw new Error(\"Failed to load structure system prompt\");\r\n      }\r\n\r\n      if (DEBUG) console.log(\"Got system prompt, processing query strings\");\r\n      // processPrompt expects history, pass empty array if none applicable here\r\n      const queryStrings = await processPrompt({\r\n          userInput: clientprompt,\r\n          systemPrompt: systemStructurePrompt,\r\n          model: GPT41,\r\n          temperature: 1,\r\n          history: [] // Explicitly empty\r\n      });\r\n\r\n      if (!queryStrings || !Array.isArray(queryStrings)) {\r\n          console.error(\"Invalid query strings received:\", queryStrings);\r\n          throw new Error(\"Failed to get valid query strings from structuring prompt\");\r\n      }\r\n\r\n      if (DEBUG) console.log(\"Got query strings:\", queryStrings);\r\n      const results = [];\r\n\r\n      for (const queryString of queryStrings) {\r\n          if (DEBUG) console.log(\"Processing query:\", queryString);\r\n          try {\r\n              // Make sure queryVectorDB uses the internal API keys\r\n              const queryResults = {\r\n                  query: queryString,\r\n                  trainingData: await queryVectorDB({\r\n                      queryPrompt: queryString,\r\n                      similarityThreshold: .2,\r\n                      indexName: 'call2trainingdata',\r\n                      numResults: 3\r\n                  }),\r\n                  call2Context: await queryVectorDB({\r\n                      queryPrompt: queryString,\r\n                      similarityThreshold: .2,\r\n                      indexName: 'call2context',\r\n                      numResults: 5\r\n                  }),\r\n                  call1Context: await queryVectorDB({\r\n                      queryPrompt: queryString,\r\n                      similarityThreshold: .2,\r\n                      indexName: 'call1context',\r\n                      numResults: 5\r\n                  }),\r\n                  codeOptions: await queryVectorDB({\r\n                      queryPrompt: queryString,\r\n                      indexName: 'codes',\r\n                      numResults: 3,\r\n                      similarityThreshold: .1\r\n                  })\r\n              };\r\n\r\n              results.push(queryResults);\r\n              if (DEBUG) console.log(\"Successfully processed query:\", queryString);\r\n          } catch (error) {\r\n              console.error(`Error processing query \"${queryString}\":`, error);\r\n              // Continue with next query instead of failing completely\r\n          }\r\n      }\r\n\r\n      if (results.length === 0 && queryStrings.length > 0) {\r\n           console.warn(\"All structured queries failed to produce results.\");\r\n           // Decide whether to throw an error or return empty results\r\n           // Throwing error based on original logic\r\n           throw new Error(\"No valid results were obtained from any structured queries\");\r\n      } else if (queryStrings.length === 0) {\r\n           console.warn(\"Structuring prompt returned no query strings.\");\r\n           // Throwing error as subsequent steps likely depend on results\r\n           throw new Error(\"Structuring prompt did not return any queries to process.\");\r\n      }\r\n\r\n      return results;\r\n  } catch (error) {\r\n      console.error(\"Error in structureDatabasequeries:\", error);\r\n      throw error; // Re-throw\r\n  }\r\n}\r\n\r\n// Function: Query Vector Database using Pinecone REST API\r\nexport async function queryVectorDB({ queryPrompt, indexName = 'codes', numResults = 10, similarityThreshold = null }) {\r\n    try {\r\n        if (DEBUG) console.log(\"Generating embeddings for query:\", queryPrompt);\r\n\r\n        // Ensure API key exists before proceeding\r\n        if (!INTERNAL_API_KEYS.PINECONE_API_KEY) {\r\n            throw new Error(\"Pinecone API key not found. Please check your API keys.\");\r\n        }\r\n\r\n        const embedding = await createEmbedding(queryPrompt); // Uses OpenAI key internally\r\n        if (DEBUG) console.log(\"Embeddings generated successfully\");\r\n\r\n        const indexConfig = PINECONE_INDEXES[indexName];\r\n        if (!indexConfig) {\r\n            throw new Error(`Invalid index name provided: ${indexName}`);\r\n        }\r\n\r\n        const url = `${indexConfig.apiEndpoint}/query`;\r\n        if (DEBUG) console.log(\"Making Pinecone API request to:\", url);\r\n\r\n        const response = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'api-key': INTERNAL_API_KEYS.PINECONE_API_KEY,\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({\r\n                vector: embedding,\r\n                topK: numResults,\r\n                includeMetadata: true,\r\n                namespace: \"ns1\" // Assuming namespace is constant\r\n            })\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorText = await response.text().catch(() => \"Could not read error response body\");\r\n            console.error(\"Pinecone API error details:\", {\r\n                status: response.status,\r\n                statusText: response.statusText,\r\n                error: errorText\r\n            });\r\n            throw new Error(`Pinecone API error: ${response.status} ${response.statusText} - ${errorText}`);\r\n        }\r\n\r\n        const data = await response.json();\r\n        if (DEBUG) console.log(\"Pinecone API response received\");\r\n\r\n        let matches = data.matches || [];\r\n\r\n        if (similarityThreshold !== null) {\r\n            matches = matches.filter(match => match.score >= similarityThreshold);\r\n        }\r\n\r\n        // Apply numResults limit *after* threshold filtering\r\n        matches = matches.slice(0, numResults);\r\n\r\n        // Extract text using the helper function\r\n        const cleanMatches = matches.map(match => extractTextFromJson(match)).filter(text => text !== \"\");\r\n\r\n        if (DEBUG) {\r\n            console.log(`Found ${cleanMatches.length} matches (after threshold/limit/extraction):`);\r\n            cleanMatches.forEach((text, i) => console.log(`  ${i + 1}: ${text.substring(0, 100)}...`));\r\n        }\r\n\r\n        return cleanMatches;\r\n\r\n    } catch (error) {\r\n        console.error(`Error during vector database query for index \"${indexName}\":`, error);\r\n        throw error; // Re-throw\r\n    }\r\n}\r\n\r\n\r\n// Helper function to extract text from Pinecone match JSON\r\nfunction extractTextFromJson(jsonInput) {\r\n   try {\r\n       // Input might already be an object if response was parsed\r\n       const jsonData = typeof jsonInput === 'string' ? JSON.parse(jsonInput) : jsonInput;\r\n\r\n       // Check common structures\r\n       if (jsonData?.metadata?.text) {\r\n           return jsonData.metadata.text;\r\n       }\r\n       // Fallback for older structures or direct text? (Less likely based on usage)\r\n       if (typeof jsonData?.text === 'string') {\r\n           return jsonData.text;\r\n       }\r\n\r\n       // Handle array case (though query response is usually object with 'matches')\r\n       if (Array.isArray(jsonData)) {\r\n           for (const item of jsonData) {\r\n               if (item?.metadata?.text) {\r\n                   return item.metadata.text; // Return first found\r\n               }\r\n           }\r\n       }\r\n\r\n       // If no text found\r\n       console.warn(\"Could not find 'text' field in metadata for match:\", JSON.stringify(jsonInput).substring(0, 100));\r\n       return \"\"; // Return empty string if text cannot be extracted\r\n\r\n   } catch (error) {\r\n       console.error(`Error processing JSON for text extraction: ${error.message}`);\r\n       // Log the problematic input for debugging\r\n       console.error(\"Input causing error:\", jsonInput);\r\n       return \"\"; // Return empty string on error\r\n   }\r\n}\r\n\r\n\r\n// Helper function to format JSON for prompts (handle potential errors)\r\nexport function safeJsonForPrompt(obj, readable = true) {\r\n    try {\r\n        if (!readable) {\r\n            // Simple stringify, remove potential noise, escape braces\r\n            let jsonString = JSON.stringify(obj);\r\n            // Remove empty values/metadata pairs if they exist and are noise\r\n            // Be cautious with overly broad replaces\r\n            // jsonString = jsonString.replace(/\"values\":\\s*\\[\\],\\s*\"metadata\":/g, '\"metadata\":'); // Example, adjust if needed\r\n            return jsonString\r\n                // .replace(/{/g, '\\\\u007B') // Escaping might not be needed depending on LLM\r\n                // .replace(/}/g, '\\\\u007D');\r\n        }\r\n\r\n        // Readable format (extract text, add score)\r\n        if (Array.isArray(obj)) {\r\n            return obj.map(item => {\r\n                let result = \"\";\r\n                if (item?.metadata?.text) {\r\n                    // Basic cleaning: replace newlines, trim\r\n                    const text = item.metadata.text.replace(/[\\r\\n]+/g, ' ').trim();\r\n                    result = text; // Use cleaned text directly\r\n                    // Example of splitting if structure was known:\r\n                    // const parts = text.split(';');\r\n                    // if (parts.length >= 1) result += parts[0].trim();\r\n                    // ... etc ...\r\n                } else {\r\n                    // Fallback if no text found\r\n                    result = JSON.stringify(item); // Stringify the whole item as fallback\r\n                }\r\n\r\n                if (item?.score) {\r\n                    result += `\\nSimilarity Score: ${item.score.toFixed(4)}`;\r\n                }\r\n                return result;\r\n            }).join('\\n\\n'); // Separate items clearly\r\n        }\r\n\r\n        // Fallback for non-array objects (less likely for lists of results)\r\n        return JSON.stringify(obj, null, 2); // Pretty print as fallback\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in safeJsonForPrompt:\", error);\r\n        // Return a safe representation of the error or the input\r\n        return `[Error formatting JSON: ${error.message}]`;\r\n    }\r\n}\r\n\r\n\r\n// Function: Handle Follow-Up Conversation\r\nexport async function handleFollowUpConversation(clientprompt, currentHistory) {\r\n    if (DEBUG) console.log(\"Processing follow-up question:\", clientprompt);\r\n    if (DEBUG) console.log(\"Using conversation history length:\", currentHistory.length);\r\n\r\n    // Ensure API keys are available\r\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY || !INTERNAL_API_KEYS.PINECONE_API_KEY) {\r\n        throw new Error(\"API keys not initialized for follow-up conversation.\");\r\n    }\r\n\r\n    // Load necessary prompts\r\n    const systemPrompt = await getSystemPromptFromFile('Followup_System');\r\n    const mainPromptText = await getSystemPromptFromFile('Encoder_Main'); // Assuming this is the 'MainPrompt' context needed\r\n\r\n     if (!systemPrompt || !mainPromptText) {\r\n         throw new Error(\"Failed to load required prompts for follow-up.\");\r\n     }\r\n\r\n    // Fetch context using vector DB queries\r\n    // These calls internally use createEmbedding (OpenAI key) and query (Pinecone key)\r\n    const trainingdataCall2 = await queryVectorDB({\r\n        queryPrompt: clientprompt,\r\n        similarityThreshold: .4,\r\n        indexName: 'call2trainingdata',\r\n        numResults: 3\r\n    });\r\n\r\n    const call2context = await queryVectorDB({\r\n        queryPrompt: clientprompt + safeJsonForPrompt(trainingdataCall2, false), // Append context for better query\r\n        similarityThreshold: .3,\r\n        indexName: 'call2context',\r\n        numResults: 5\r\n    });\r\n\r\n    const call1context = await queryVectorDB({\r\n        queryPrompt: clientprompt + safeJsonForPrompt(trainingdataCall2, false),\r\n        similarityThreshold: .3,\r\n        indexName: 'call1context',\r\n        numResults: 5\r\n    });\r\n\r\n    const codeOptions = await queryVectorDB({\r\n        queryPrompt: clientprompt + safeJsonForPrompt(trainingdataCall2, false) + safeJsonForPrompt(call1context, false),\r\n        indexName: 'codes',\r\n        numResults: 10,\r\n        similarityThreshold: .1\r\n    });\r\n\r\n    // Construct the prompt for the LLM\r\n    const followUpPrompt = `Client request: ${clientprompt}\\n` +\r\n                   `Main Prompt Context: ${mainPromptText}\\n` + // Use loaded main prompt text\r\n                   `Training Data Context: ${safeJsonForPrompt(trainingdataCall2, true)}\\n` + // Use readable format for prompt\r\n                   `Code Choosing Context: ${safeJsonForPrompt(call1context, true)}\\n` +\r\n                   `Code Editing Context: ${safeJsonForPrompt(call2context, true)}\\n` +\r\n                   `Relevant Code Options: ${safeJsonForPrompt(codeOptions, true)}`;\r\n\r\n    // Call the LLM (processPrompt uses OpenAI key internally)\r\n    const responseArray = await processPrompt({\r\n        userInput: followUpPrompt,\r\n        systemPrompt: systemPrompt,\r\n        model: GPT41,\r\n        temperature: 1,\r\n        history: currentHistory // Pass the existing history\r\n    });\r\n\r\n    // Update history (create new array, don't modify inplace)\r\n    const updatedHistory = [\r\n        ...currentHistory,\r\n        [\"human\", clientprompt],\r\n        [\"assistant\", responseArray.join(\"\\n\")] // Store response as single string\r\n    ];\r\n\r\n    // Persist updated history and analysis data (using localStorage helpers)\r\n    saveConversationHistory(updatedHistory); // Save the new history state\r\n    savePromptAnalysis(\r\n        clientprompt,\r\n        systemPrompt,\r\n        mainPromptText,\r\n        null, // No validation prompt info available here\r\n        null, // No validation prompt info available here\r\n        null, // No validation results available here\r\n        safeJsonForPrompt(call2context, false), // Save non-readable for potential re-use\r\n        safeJsonForPrompt(call1context, false),\r\n        safeJsonForPrompt(trainingdataCall2, false),\r\n        safeJsonForPrompt(codeOptions, false),\r\n        responseArray\r\n    );\r\n    saveTrainingData(clientprompt, responseArray);\r\n\r\n    if (DEBUG) console.log(\"Follow-up conversation processed. History length:\", updatedHistory.length);\r\n\r\n    // Return the response and the updated history\r\n    return { response: responseArray, history: updatedHistory };\r\n}\r\n\r\n\r\n// Function: Handle Initial Conversation\r\nexport async function handleInitialConversation(clientprompt) {\r\n    if (DEBUG) console.log(\"Processing initial question:\", clientprompt);\r\n\r\n     // Ensure API keys are available\r\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY) {\r\n        throw new Error(\"OpenAI API key not initialized for initial conversation.\");\r\n    }\r\n\r\n    // Load necessary prompts\r\n    const systemPrompt = await getSystemPromptFromFile('Encoder_System');\r\n    const mainPromptText = await getSystemPromptFromFile('Encoder_Main');\r\n\r\n     if (!systemPrompt || !mainPromptText) {\r\n         throw new Error(\"Failed to load required prompts for initial conversation.\");\r\n     }\r\n\r\n    if (DEBUG) console.log(\"SYSTEM PROMPT: \", systemPrompt ? systemPrompt.substring(0,100) + \"...\" : \"Not loaded\");\r\n    if (DEBUG) console.log(\"MAIN PROMPT: \", mainPromptText ? mainPromptText.substring(0,100) + \"...\" : \"Not loaded\");\r\n\r\n    // Construct the prompt for the first call (no vector DB context yet)\r\n    const initialCallPrompt = `Client request: ${clientprompt}\\n` +\r\n                           `Main Prompt: ${mainPromptText}`;\r\n\r\n    // Call the LLM (processPrompt uses OpenAI key internally)\r\n    const outputArray = await processPrompt({\r\n        userInput: initialCallPrompt,\r\n        systemPrompt: systemPrompt,\r\n        model: GPT41,\r\n        temperature: 1,\r\n        history: [] // No history for initial call\r\n    });\r\n\r\n    // Create the initial history\r\n    const initialHistory = [\r\n        [\"human\", clientprompt],\r\n        [\"assistant\", outputArray.join(\"\\n\")] // Store response as single string\r\n    ];\r\n\r\n    // Persist history and analysis data\r\n    saveConversationHistory(initialHistory);\r\n    savePromptAnalysis(\r\n        clientprompt,\r\n        systemPrompt,\r\n        mainPromptText,\r\n        null, null, null, // No validation info\r\n        \"\", \"\", \"\", \"\", // No vector DB context yet\r\n        outputArray\r\n    );\r\n    saveTrainingData(clientprompt, outputArray);\r\n\r\n    if (DEBUG) console.log(\"Initial conversation processed. History length:\", initialHistory.length);\r\n    if (DEBUG) console.log(\"Initial Response:\", outputArray);\r\n\r\n    // Return the response and the new history\r\n    return { response: outputArray, history: initialHistory };\r\n}\r\n\r\n// Main conversation handler - decides between initial and follow-up\r\n// Takes current history and returns { response, history }\r\nexport async function handleConversation(clientprompt, currentHistory) {\r\n    try {\r\n        const isFollowUp = currentHistory && currentHistory.length > 0;\r\n        if (isFollowUp) {\r\n            return await handleFollowUpConversation(clientprompt, currentHistory);\r\n        } else {\r\n            return await handleInitialConversation(clientprompt);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Error in conversation handling:\", error);\r\n        // Return error message and unchanged history\r\n        return {\r\n            response: [\"Error processing your request: \" + error.message],\r\n            history: currentHistory || [] // Return existing or empty history\r\n        };\r\n    }\r\n}\r\n\r\n\r\n// Function: Save prompt analysis data to localStorage\r\nfunction savePromptAnalysis(clientprompt, systemPrompt, mainPrompt, validationSystemPrompt, validationMainPrompt, validationResults, call2context, call1context, trainingdataCall2, codeOptions, outputArray) {\r\n    try {\r\n        const analysisData = {\r\n            clientRequest: clientprompt || \"\",\r\n            systemPrompt: systemPrompt || \"\",\r\n            mainPrompt: mainPrompt || \"\",\r\n            validationSystemPrompt: validationSystemPrompt || \"\",\r\n            validationMainPrompt: validationMainPrompt || \"\",\r\n            validationResults: validationResults || [],\r\n            call2context: call2context || \"\", // Store the potentially non-readable string used\r\n            call1context: call1context || \"\",\r\n            trainingdataCall2: trainingdataCall2 || \"\",\r\n            codeOptions: codeOptions || \"\",\r\n            outputArray: outputArray || []\r\n        };\r\n\r\n        localStorage.setItem('promptAnalysis', JSON.stringify(analysisData));\r\n        if (DEBUG) console.log('Prompt analysis saved to localStorage');\r\n    } catch (error) {\r\n        console.error(\"Error saving prompt analysis:\", error);\r\n    }\r\n}\r\n\r\n// Function: Save training data pair to localStorage\r\nfunction saveTrainingData(clientprompt, outputArray) {\r\n    try {\r\n        // Helper to clean text for storage\r\n        function cleanText(text) {\r\n            if (!text) return '';\r\n            // Convert non-strings (like arrays) to string first\r\n            const str = Array.isArray(text) ? JSON.stringify(text) : String(text);\r\n            return str.replace(/[\\r\\n\\t]+/g, ' ').trim(); // Replace newlines/tabs with space\r\n        }\r\n\r\n        const trainingData = {\r\n            prompt: cleanText(clientprompt),\r\n            // Ensure outputArray is stringified if it's an array\r\n            response: cleanText(outputArray)\r\n        };\r\n\r\n        localStorage.setItem('trainingData', JSON.stringify(trainingData));\r\n        if (DEBUG) console.log('Training data saved to localStorage');\r\n    } catch (error) {\r\n        console.error(\"Error saving training data:\", error);\r\n    }\r\n}\r\n\r\n\r\n// Function: Perform validation correction using LLM\r\n// Note: Assumes localStorage contains relevant context from previous calls\r\nexport async function validationCorrection(clientprompt, initialResponse, validationResults) {\r\n    try {\r\n         // Ensure API keys are available\r\n         if (!INTERNAL_API_KEYS.OPENAI_API_KEY) {\r\n            throw new Error(\"OpenAI API key not initialized for validation correction.\");\r\n        }\r\n\r\n        // Load context from localStorage (as per original logic)\r\n        // Consider passing these as arguments if localStorage access becomes problematic\r\n        const trainingData = localStorage.getItem('trainingData') || '{\"prompt\":\"\",\"response\":\"\"}'; // Provide default structure\r\n        const promptAnalysisData = JSON.parse(localStorage.getItem('promptAnalysis') || '{}');\r\n\r\n        // Load validation prompts\r\n        const validationSystemPrompt = await getSystemPromptFromFile('Validation_System');\r\n        const validationMainPrompt = await getSystemPromptFromFile('Validation_Main');\r\n\r\n        if (!validationSystemPrompt || !validationMainPrompt) {\r\n            throw new Error(\"Failed to load validation system or main prompt\");\r\n        }\r\n\r\n        // Format the initial response and validation results as strings\r\n        const responseString = Array.isArray(initialResponse) ? initialResponse.join(\"\\n\") : String(initialResponse);\r\n        const validationResultsString = Array.isArray(validationResults) ? validationResults.join(\"\\n\") : String(validationResults);\r\n\r\n        // Construct the correction prompt using loaded context\r\n        const correctionPrompt =\r\n            `Main Prompt: ${validationMainPrompt}\\n\\n` +\r\n            `Original User Input: ${clientprompt}\\n\\n` +\r\n            `Initial Response (to be corrected): ${responseString}\\n\\n` +\r\n            `Validation Errors Found: ${validationResultsString}\\n\\n` +\r\n            // Include context from the last analysis if available\r\n            `Training Data Example: ${trainingData}\\n\\n` + // Use loaded training data string\r\n            `Code Options Context: ${promptAnalysisData.codeOptions || \"Not available\"}\\n\\n` +\r\n            `Code Choosing Context: ${promptAnalysisData.call1context || \"Not available\"}\\n\\n` +\r\n            `Code Editing Context: ${promptAnalysisData.call2context || \"Not available\"}`;\r\n\r\n\r\n        if (DEBUG) {\r\n            console.log(\"====== VALIDATION CORRECTION INPUT ======\");\r\n            console.log(\"System Prompt:\", validationSystemPrompt.substring(0,100) + \"...\");\r\n            console.log(\"User Input Prompt (truncated):\", correctionPrompt.substring(0, 500) + \"...\");\r\n            console.log(\"=========================================\");\r\n        }\r\n\r\n        // Call LLM for correction (processPrompt uses OpenAI key)\r\n        // Pass an empty history, as correction likely doesn't need chat context\r\n        const correctedResponseArray = await processPrompt({\r\n            userInput: correctionPrompt,\r\n            systemPrompt: validationSystemPrompt,\r\n            model: GPT41,\r\n            temperature: 0.7, // Lower temperature for correction\r\n            history: []\r\n        });\r\n\r\n        // Save the output using the mock fs (as per original logic)\r\n        const correctionOutputPath = \"C:\\\\Users\\\\joeor\\\\Dropbox\\\\B - Freelance\\\\C_Projectify\\\\VanPC\\\\Training Data\\\\Main Script Training and Context Data\\\\validation_correction_output.txt\";\r\n        const correctedResponseString = Array.isArray(correctedResponseArray) ? correctedResponseArray.join(\"\\n\") : correctedResponseArray;\r\n        fs.writeFileSync(correctionOutputPath, correctedResponseString);\r\n\r\n        if (DEBUG) console.log(`Validation correction output saved via mock fs to ${correctionOutputPath}`);\r\n        if (DEBUG) console.log(\"Corrected Response:\", correctedResponseArray);\r\n\r\n        return correctedResponseArray; // Return the array format expected by caller\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in validation correction:\", error);\r\n        // console.error(error.stack); // Keep stack trace for detailed debugging\r\n        // Return an error message array, consistent with other function returns\r\n        return [\"Error during validation correction: \" + error.message];\r\n    }\r\n}\r\n\r\n","import { validateCodeStrings } from './Validation.js';\n\nimport { populateCodeCollection, exportCodeCollectionToText, runCodes, processAssumptionTabs, collapseGroupingsAndNavigateToFinancials, hideColumnsAndNavigate, handleInsertWorksheetsFromBase64 } from './CodeCollection.js';\n// >>> ADDED: Import the new validation function\nimport { validateCodeStringsForRun } from './Validation.js';\n// >>> ADDED: Import the tab string generator function\nimport { generateTabString } from './IndexWorksheet.js';\n// >>> UPDATED: Import structureDatabasequeries from the helper file\nimport { structureDatabasequeries } from './StructureHelper.js';\n// >>> ADDED: Import setAPIKeys function from AIcalls\nimport { setAPIKeys } from './AIcalls.js';\n// >>> ADDED: Import callOpenAI function from AIcalls\nimport { callOpenAI } from './AIcalls.js';\n// >>> ADDED: Import conversation history functions from AIcalls\nimport { saveConversationHistory, loadConversationHistory } from './AIcalls.js';\n// >>> ADDED: Import prompt loading functions from AIcalls\nimport { loadPromptFromFile, getSystemPromptFromFile } from './AIcalls.js';\n// >>> ADDED: Import processPrompt function from AIcalls\nimport { processPrompt } from './AIcalls.js';\n// >>> ADDED: Import createEmbedding function from AIcalls\nimport { createEmbedding } from './AIcalls.js';\n// >>> ADDED: Import queryVectorDB function from AIcalls\nimport { queryVectorDB } from './AIcalls.js';\n// >>> ADDED: Import safeJsonForPrompt function from AIcalls\nimport { safeJsonForPrompt } from './AIcalls.js';\n// >>> ADDED: Import conversation handling and validation functions from AIcalls\n// Make sure handleConversation is included here\nimport { handleFollowUpConversation, handleInitialConversation, handleConversation, validationCorrection } from './AIcalls.js';\n// Add the codeStrings variable with the specified content\n// REMOVED hardcoded codeStrings variable\n\nimport { API_KEYS as configApiKeys } from '../../config.js'; // Assuming config.js exports API_KEYS\n\n//Debugging Toggle\nconst DEBUG = true;\n\n// Variable to store loaded code strings\nlet loadedCodeStrings = \"\";\n\n// Variable to store the parsed code database\nlet codeDatabase = [];\n\n// API keys storage - initialized by initializeAPIKeys\nlet INTERNAL_API_KEYS = {\n  OPENAI_API_KEY: \"\",\n  PINECONE_API_KEY: \"\"\n};\n\n// >>> MOVED & MODIFIED: Ensure truly global scope for cursor position\nvar lastEditorCursorPosition = null;\n\n// Function to load the code string database\nasync function loadCodeDatabase() {\n  try {\n    console.log(\"Loading code database...\");\n    const response = await fetch('https://localhost:3002/assets/codestringDB.txt');\n    if (!response.ok) {\n      throw new Error(`Failed to load codestringDB.txt: ${response.statusText}`);\n    }\n    const text = await response.text();\n    const lines = text.split(/[\\r\\n]+/).filter(line => line.trim() !== ''); // Split by lines and remove empty ones\n\n    codeDatabase = lines.map(line => {\n      const parts = line.split('\\t'); // Assuming tab-separated\n      if (parts.length >= 2) {\n        return { name: parts[0].trim(), code: parts[1].trim() };\n      }\n      console.warn(`Skipping malformed line in codestringDB.txt: ${line}`);\n      return null;\n    }).filter(item => item !== null); // Filter out null entries from malformed lines\n\n    console.log(`Code database loaded successfully with ${codeDatabase.length} entries.`);\n    if (DEBUG && codeDatabase.length > 0) {\n        console.log(\"First few code database entries:\", codeDatabase.slice(0, 5));\n    }\n\n  } catch (error) {\n    console.error(\"Error loading code database:\", error);\n    showError(\"Failed to load code database. Search functionality will be unavailable.\");\n    codeDatabase = []; // Ensure it's empty on error\n  }\n}\n\n// Function to load API keys from a config file\n// This allows the keys to be stored in a separate file that's .gitignored\nexport async function initializeAPIKeys() {\n  try {\n    console.log(\"Initializing API keys from AIcalls.js...\");\n\n    // Use keys from imported config.js if available\n    if (configApiKeys?.OPENAI_API_KEY) {\n        INTERNAL_API_KEYS.OPENAI_API_KEY = configApiKeys.OPENAI_API_KEY;\n        console.log(\"OpenAI API key loaded from config.js\");\n    } else {\n         console.warn(\"OpenAI API key not found in config.js.\");\n    }\n\n    if (configApiKeys?.PINECONE_API_KEY) {\n        INTERNAL_API_KEYS.PINECONE_API_KEY = configApiKeys.PINECONE_API_KEY;\n        console.log(\"Pinecone API key loaded from config.js\");\n    } else {\n         console.warn(\"Pinecone API key not found in config.js.\");\n    }\n\n    // Fallback: try fetching from the old location if config.js didn't provide them\n    if (!INTERNAL_API_KEYS.OPENAI_API_KEY || !INTERNAL_API_KEYS.PINECONE_API_KEY) {\n        console.log(\"Attempting fallback API key loading from https://localhost:3002/config.js\");\n        try {\n            const configResponse = await fetch('https://localhost:3002/config.js');\n            if (configResponse.ok) {\n                const configText = await configResponse.text();\n                // Extract keys from the config text using regex\n                const openaiKeyMatch = configText.match(/OPENAI_API_KEY\\s*=\\s*[\"']([^\"']+)[\"']/);\n                const pineconeKeyMatch = configText.match(/PINECONE_API_KEY\\s*=\\s*[\"']([^\"']+)[\"']/);\n\n                if (!INTERNAL_API_KEYS.OPENAI_API_KEY && openaiKeyMatch && openaiKeyMatch[1]) {\n                    INTERNAL_API_KEYS.OPENAI_API_KEY = openaiKeyMatch[1];\n                    console.log(\"OpenAI API key loaded via fetch fallback.\");\n                }\n\n                if (!INTERNAL_API_KEYS.PINECONE_API_KEY && pineconeKeyMatch && pineconeKeyMatch[1]) {\n                    INTERNAL_API_KEYS.PINECONE_API_KEY = pineconeKeyMatch[1];\n                    console.log(\"Pinecone API key loaded via fetch fallback.\");\n                }\n            } else {\n                 console.warn(\"Fallback fetch for config.js failed or returned non-OK status.\");\n            }\n        } catch (error) {\n            console.warn(\"Could not load config.js via fetch fallback:\", error);\n        }\n    }\n\n    // Add debug logging with secure masking of keys\n    console.log(\"Loaded API Keys (AIcalls.js):\");\n    console.log(\"  OPENAI_API_KEY:\", INTERNAL_API_KEYS.OPENAI_API_KEY ?\n      `${INTERNAL_API_KEYS.OPENAI_API_KEY.substring(0, 3)}...${INTERNAL_API_KEYS.OPENAI_API_KEY.substring(INTERNAL_API_KEYS.OPENAI_API_KEY.length - 3)}` :\n      \"Not found\");\n    console.log(\"  PINECONE_API_KEY:\", INTERNAL_API_KEYS.PINECONE_API_KEY ?\n      `${INTERNAL_API_KEYS.PINECONE_API_KEY.substring(0, 3)}...${INTERNAL_API_KEYS.PINECONE_API_KEY.substring(INTERNAL_API_KEYS.PINECONE_API_KEY.length - 3)}` :\n      \"Not found\");\n\n    const keysFound = !!(INTERNAL_API_KEYS.OPENAI_API_KEY && INTERNAL_API_KEYS.PINECONE_API_KEY);\n    console.log(\"API Keys Initialized:\", keysFound);\n    // Return a copy to prevent external modification of the internal state\n    return { ...INTERNAL_API_KEYS };\n\n  } catch (error) {\n    console.error(\"Error initializing API keys:\", error);\n    // Return empty keys on error\n    return { OPENAI_API_KEY: \"\", PINECONE_API_KEY: \"\" };\n  }\n}\n\n// Conversation history storage\nlet conversationHistory = [];\n\n// Add this function at the top level\nfunction showMessage(message) {\n    const messageDiv = document.createElement('div');\n    messageDiv.style.color = 'green';\n    messageDiv.style.padding = '10px';\n    messageDiv.style.margin = '10px';\n    messageDiv.style.border = '1px solid green';\n    messageDiv.style.borderRadius = '4px';\n    messageDiv.textContent = message;\n    \n    const appBody = document.getElementById('app-body');\n    appBody.insertBefore(messageDiv, appBody.firstChild);\n    \n    // Remove the message after 5 seconds\n    setTimeout(() => {\n        messageDiv.remove();\n    }, 5000);\n}\n\n// Add this function at the top level\nfunction showError(message) {\n    const errorDiv = document.createElement('div');\n    errorDiv.style.color = 'red';\n    errorDiv.style.padding = '10px';\n    errorDiv.style.margin = '10px';\n    errorDiv.style.border = '1px solid red';\n    errorDiv.style.borderRadius = '4px';\n    errorDiv.textContent = `Error: ${message}`;\n    \n    const appBody = document.getElementById('app-body');\n    appBody.insertBefore(errorDiv, appBody.firstChild);\n    \n    // Remove the error message after 5 seconds\n    setTimeout(() => {\n        errorDiv.remove();\n    }, 5000);\n}\n\n// Add this function at the top level\nfunction setButtonLoading(isLoading) {\n    console.log(`[setButtonLoading] Called with isLoading: ${isLoading}`);\n    const sendButton = document.getElementById('send');\n    const loadingAnimation = document.getElementById('loading-animation');\n    \n    if (sendButton) {\n        sendButton.disabled = isLoading;\n    } else {\n        console.warn(\"[setButtonLoading] Could not find send button with id='send'\");\n    }\n    \n    if (loadingAnimation) {\n        const newDisplay = isLoading ? 'flex' : 'none';\n        console.log(`[setButtonLoading] Found loadingAnimation element. Setting display to: ${newDisplay}`);\n        loadingAnimation.style.display = newDisplay;\n    } else {\n        console.error(\"[setButtonLoading] Could not find loading animation element with id='loading-animation'\");\n    }\n}\n\n// Add this variable to store the last response\nlet lastResponse = null;\n\n// Add this variable to track if the current message is a response\nlet isResponse = false;\n\n// Add this function to write to Excel\nasync function writeToExcel() {\n    if (!lastResponse) {\n        showError('No response to write to Excel');\n        return;\n    }\n\n    try {\n        await Excel.run(async (context) => {\n            const range = context.workbook.getSelectedRange();\n            range.load(\"rowIndex\");\n            range.load(\"columnIndex\");\n            await context.sync();\n            \n            const startRow = range.rowIndex;\n            const startCol = range.columnIndex;\n            \n            // Split the response into individual code strings\n            let codeStrings = [];\n            if (Array.isArray(lastResponse)) {\n                // Join the array elements and then split by brackets\n                const fullText = lastResponse.join(' ');\n                codeStrings = fullText.match(/<[^>]+>/g) || [];\n            } else if (typeof lastResponse === 'string') {\n                codeStrings = lastResponse.match(/<[^>]+>/g) || [];\n            }\n            \n            if (codeStrings.length === 0) {\n                throw new Error(\"No valid code strings found in response\");\n            }\n            \n            // Create a range that spans all the rows we need\n            const targetRange = range.worksheet.getRangeByIndexes(\n                startRow,\n                startCol,\n                codeStrings.length,\n                1\n            );\n            \n            // Set all values at once, with each code string in its own row\n            targetRange.values = codeStrings.map(str => [str]);\n            \n            await context.sync();\n            console.log(\"Response written to Excel\");\n        });\n    } catch (error) {\n        console.error(\"Error writing to Excel:\", error);\n        showError(error.message);\n    }\n}\n\n// Add this function to append messages to the chat log\nfunction appendMessage(content, isUser = false) {\n    const chatLog = document.getElementById('chat-log');\n    const welcomeMessage = document.getElementById('welcome-message');\n    \n    // Hide welcome message when first message is added\n    if (welcomeMessage) {\n        welcomeMessage.style.display = 'none';\n    }\n    \n    const messageDiv = document.createElement('div');\n    messageDiv.className = `chat-message ${isUser ? 'user-message' : 'assistant-message'}`;\n    \n    const messageContent = document.createElement('p');\n    messageContent.className = 'message-content';\n    messageContent.textContent = content;\n    \n    messageDiv.appendChild(messageContent);\n    chatLog.appendChild(messageDiv);\n    \n    // Scroll to bottom\n    chatLog.scrollTop = chatLog.scrollHeight;\n}\n\n// Modify the handleSend function\nasync function handleSend() {\n    const userInput = document.getElementById('user-input').value.trim();\n    \n    if (!userInput) {\n        showError('Please enter a request');\n        return;\n    }\n\n    // Check if this is a response to a previous message\n    isResponse = conversationHistory.length > 0;\n\n    // Add user message to chat\n    appendMessage(userInput, true);\n    \n    // Clear input\n    document.getElementById('user-input').value = '';\n\n    setButtonLoading(true);\n    try {\n        // Process the text through the main function\n        console.log(\"Starting structureDatabasequeries\");\n        const dbResults = await structureDatabasequeries(userInput);\n        console.log(\"Database queries completed\");\n        \n        if (!dbResults || !Array.isArray(dbResults)) {\n            console.error(\"Invalid database results:\", dbResults);\n            throw new Error(\"Failed to get valid database results\");\n        }\n        \n        // Format the database results into a string\n        const plainTextResults = dbResults.map(result => {\n            if (!result) return \"No results found\";\n            \n            return `Query: ${result.query || 'No query'}\\n` +\n                   `Training Data:\\n${(result.trainingData || []).join('\\n')}\\n` +\n                   `Code Options:\\n${(result.codeOptions || []).join('\\n')}\\n` +\n                   `Code Choosing Context:\\n${(result.call1Context || []).join('\\n')}\\n` +\n                   `Code Editing Context:\\n${(result.call2Context || []).join('\\n')}\\n` +\n                   `---\\n`;\n        }).join('\\n');\n\n        const enhancedPrompt = `Client Request: ${userInput}\\n\\nDatabase Results:\\n${plainTextResults}`;\n        console.log(\"Enhanced prompt created\");\n        console.log(\"Enhanced prompt:\", enhancedPrompt);\n\n        console.log(\"Starting handleConversation\");\n        let conversationResult = await handleConversation(enhancedPrompt, isResponse); // Store the whole result object\n        console.log(\"Conversation completed\");\n        console.log(\"Initial Conversation Result:\", conversationResult); // Log the whole object\n\n        // Extract the response array and update history\n        let responseArray = conversationResult.response;\n        conversationHistory = conversationResult.history; // Update global history if needed (check AIcalls.js if it manages history internally)\n\n        // Validate the extracted response array\n        if (!responseArray || !Array.isArray(responseArray)) {\n            console.error(\"Invalid response array extracted:\", responseArray);\n            throw new Error(\"Failed to get valid response array from conversation result\");\n        }\n\n        // Run validation and correction if needed (using the extracted array)\n        console.log(\"Starting validation\");\n        const validationResults = await validateCodeStrings(responseArray);\n        console.log(\"Validation completed:\", validationResults);\n\n        if (validationResults && validationResults.length > 0) {\n            console.log(\"Starting validation correction\");\n            // Pass the extracted array to validationCorrection\n            responseArray = await validationCorrection(userInput, responseArray, validationResults);\n            console.log(\"Validation correction completed\");\n        }\n\n        // Store the final response array for Excel writing\n        lastResponse = responseArray;\n\n        // Add assistant message to chat (using the extracted array)\n        appendMessage(responseArray.join('\\n'));\n        \n    } catch (error) {\n        console.error(\"Error in handleSend:\", error);\n        showError(error.message);\n        // Add error message to chat\n        appendMessage(`Error: ${error.message}`);\n    } finally {\n        setButtonLoading(false);\n    }\n}\n\n// Add this function to reset the chat\nfunction resetChat() {\n    // Clear the chat log\n    const chatLog = document.getElementById('chat-log');\n    chatLog.innerHTML = '';\n    \n    // Restore welcome message\n    const welcomeMessage = document.createElement('div');\n    welcomeMessage.id = 'welcome-message';\n    welcomeMessage.className = 'welcome-message';\n    const welcomeTitle = document.createElement('h1');\n    welcomeTitle.textContent = 'What would you like to model?';\n    welcomeMessage.appendChild(welcomeTitle);\n    chatLog.appendChild(welcomeMessage);\n    \n    // Clear the conversation history\n    conversationHistory = [];\n    saveConversationHistory(conversationHistory);\n    \n    // Reset the response flag and last response\n    isResponse = false;\n    lastResponse = null;\n    \n    // Clear the input field\n    document.getElementById('user-input').value = '';\n    \n    console.log(\"Chat reset completed\");\n}\n\n// *** Define Helper Function Globally (BEFORE Office.onReady) ***\nfunction getTabBlocks(codeString) {\n    if (!codeString) return [];\n    const tabBlocks = [];\n    const tabRegex = /(<TAB;[^>]*>)/g;\n    let match;\n    const indices = [];\n    while ((match = tabRegex.exec(codeString)) !== null) {\n        indices.push({ index: match.index, tag: match[1] });\n    }\n    if (indices.length === 0) {\n        if (codeString.trim().length > 0) {\n            console.warn(\"Code string provided but no <TAB;...> tags found. Processing cannot proceed based on Tabs.\");\n        }\n        return []; \n    } \n    for (let i = 0; i < indices.length; i++) {\n        const start = indices[i].index;\n        const tag = indices[i].tag;\n        const end = (i + 1 < indices.length) ? indices[i + 1].index : codeString.length;\n        const blockText = codeString.substring(start, end).trim();\n        if (blockText) {\n            tabBlocks.push({ tag: tag, text: blockText });\n        }\n    }\n    return tabBlocks;\n}\n\n// Helper function to find max driver numbers in existing text\nfunction getMaxDriverNumbers(text) {\n    const maxNumbers = {};\n    // MODIFIED Regex: Allow optional spaces around =\n    const regex = /row\\d+\\s*=\\s*\"([A-Z]+)(\\d*)\\|/g;\n    let match;\n    console.log(\"Scanning text for drivers:\", text.substring(0, 200) + \"...\"); // Log input text\n\n    while ((match = regex.exec(text)) !== null) {\n        const prefix = match[1];\n        const numberStr = match[2];\n        const number = numberStr ? parseInt(numberStr, 10) : 0;\n        console.log(`Found driver match: prefix='${prefix}', numberStr='${numberStr}', number=${number}`); // Log each match\n\n        if (isNaN(number)) {\n             console.warn(`Parsed NaN for number from '${numberStr}' for prefix '${prefix}'. Skipping.`);\n             continue;\n        }\n\n        if (!maxNumbers[prefix] || number > maxNumbers[prefix]) {\n            maxNumbers[prefix] = number;\n            console.log(`Updated max for '${prefix}' to ${number}`); // Log updates\n        }\n    }\n    if (Object.keys(maxNumbers).length === 0) {\n        console.log(\"No existing drivers found matching the pattern.\");\n    }\n    console.log(\"Final max existing driver numbers:\", maxNumbers);\n    return maxNumbers;\n}\n\nasync function insertSheetsAndRunCodes() {\n\n    // >>> ADDED: Get codes from textarea and save automatically\n    const codesTextarea = document.getElementById('codes-textarea');\n    if (!codesTextarea) {\n        showError(\"Could not find the code input area. Cannot run codes.\");\n        return;\n    }\n    loadedCodeStrings = codesTextarea.value; // Update global variable\n    try {\n        localStorage.setItem('userCodeStrings', loadedCodeStrings);\n        console.log(\"[Run Codes] Automatically saved codes from textarea to localStorage.\");\n    } catch (error) {\n        console.error(\"[Run Codes] Error auto-saving codes to localStorage:\", error);\n        showError(`Error automatically saving codes: ${error.message}. Run may not reflect latest changes.`);\n    }\n    // <<< END ADDED CODE\n\n    let codesToRun = loadedCodeStrings;\n    let previousCodes = null;\n    // >>> REVISED: Unified list for all content to process\n    let allCodeContentToProcess = \"\"; // Holds full text of *all* new AND modified tabs\n    let runResult = null; // To store result from runCodes if called\n    // Removed: codesToProcessForRunCodes, tabsToInsertIncrementally, codeStringToValidate (use allCodeContentToProcess)\n\n    // Main processing wrapped in try/catch/finally\n    try {\n        // --- Check Financials Sheet Existence ---\n        let financialsSheetExists = false;\n        await Excel.run(async (context) => {\n            try {\n                const financialsSheet = context.workbook.worksheets.getItem(\"Financials\");\n                financialsSheet.load(\"name\");\n                await context.sync();\n                financialsSheetExists = true;\n            } catch (error) {\n                if (error instanceof OfficeExtension.Error && error.code === Excel.ErrorCodes.itemNotFound) {\n                    financialsSheetExists = false;\n                } else { throw error; } // Rethrow other errors\n            }\n        });\n\n        // Set calculation mode to manual (do this early)\n        await Excel.run(async (context) => {\n            context.application.calculationMode = Excel.CalculationMode.manual;\n            await context.sync();\n        });\n\n        setButtonLoading(true);\n        console.log(\"Starting code processing...\");\n\n        // --- Pass Logic: Determine sheets to insert and codes to process ---\n        if (!financialsSheetExists) {\n            // *** FIRST PASS ***\n            console.log(\"[Run Codes] FIRST PASS: Financials sheet not found.\");\n            allCodeContentToProcess = codesToRun; // All codes are new\n\n            // >>> VALIDATION FOR FIRST PASS <<<\n            if (allCodeContentToProcess.trim().length > 0) {\n                console.log(\"Validating ALL codes before initial base sheet insertion...\");\n                const validationErrors = await validateCodeStringsForRun(allCodeContentToProcess.split(/\\r?\\n/).filter(line => line.trim() !== ''));\n                if (validationErrors && validationErrors.length > 0) {\n                    const errorMsg = \"Initial validation failed. Please fix the errors before running:\\n\" + validationErrors.join(\"\\n\");\n                    console.error(\"Code validation failed:\", validationErrors);\n                    showError(\"Code validation failed. See chat for details.\");\n                    appendMessage(errorMsg);\n                    setButtonLoading(false);\n                    return; // Stop execution\n                }\n                console.log(\"Initial code validation successful.\");\n            } else {\n                console.log(\"[Run Codes] No codes to validate on first pass.\");\n                // If no codes, no need to insert base sheets? Or insert anyway? Assuming insert needed.\n            }\n\n            // --- Insert BASE sheets ---\n            console.log(\"Inserting base sheets from Worksheets_4.3.25 v1.xlsx...\");\n            // ... (fetch and handleInsertWorksheetsFromBase64 for Worksheets_4.3.25 remains the same) ...\n            const worksheetsResponse = await fetch('https://localhost:3002/assets/Worksheets_4.3.25 v1.xlsx');\n            if (!worksheetsResponse.ok) throw new Error(`Worksheets load failed: ${worksheetsResponse.statusText}`);\n            const worksheetsArrayBuffer = await worksheetsResponse.arrayBuffer();\n            console.log(\"Converting base file to base64 (using chunks)...\");\n            const worksheetsUint8Array = new Uint8Array(worksheetsArrayBuffer);\n            let worksheetsBinaryString = '';\n            const chunkSize = 8192;\n            for (let i = 0; i < worksheetsUint8Array.length; i += chunkSize) {\n                const chunk = worksheetsUint8Array.slice(i, Math.min(i + chunkSize, worksheetsUint8Array.length));\n                worksheetsBinaryString += String.fromCharCode.apply(null, chunk);\n            }\n            const worksheetsBase64String = btoa(worksheetsBinaryString);\n            console.log(\"Base64 conversion complete.\");\n            await handleInsertWorksheetsFromBase64(worksheetsBase64String);\n            console.log(\"Base sheets inserted.\");\n            // No need to insert codes.xlsx here, it happens after runCodes\n\n        } else {\n            // *** SECOND PASS (or later) ***\n            console.log(\"[Run Codes] SUBSEQUENT PASS: Financials sheet found.\");\n\n            // Load previous codes for comparison\n            try {\n                previousCodes = localStorage.getItem('previousRunCodeStrings');\n            } catch (error) {\n                 console.error(\"[Run Codes] Error loading previous codes for comparison:\", error);\n                 console.warn(\"[Run Codes] Could not load previous codes. Processing ALL current codes as fallback.\");\n                 previousCodes = null; // Treat as if all codes are new if loading fails\n            }\n\n            // Check for NO changes first\n            if (previousCodes !== null && previousCodes === codesToRun) {\n                 console.log(\"[Run Codes] No change in code strings since last run. Nothing to process.\");\n                 // Update previous state just in case, though it's identical\n                 try { localStorage.setItem('previousRunCodeStrings', codesToRun); } catch(e) { console.error(\"Err updating prev codes:\", e); }\n                 showMessage(\"No code changes to run.\");\n                 setButtonLoading(false);\n                 return; // <<< EXIT EARLY\n            }\n\n            // --- Identify New and Modified Tabs & Collect ALL content ---\n            const currentTabs = getTabBlocks(codesToRun);\n            const previousTabs = getTabBlocks(previousCodes || \"\"); // Use empty string if previousCodes is null\n            const previousTabMap = new Map(previousTabs.map(block => [block.tag, block.text]));\n\n            let hasAnyChanges = false; // Flag to check if codes.xlsx needs inserting\n            const codeRegex = /<[^>]+>/g; // Regex to find <...> codes\n\n            for (const currentTab of currentTabs) {\n                const currentTag = currentTab.tag; // This is the <TAB;...> tag\n                const currentText = currentTab.text; // This is the full text block starting with <TAB;...>\n                const previousText = previousTabMap.get(currentTag);\n\n                if (previousText === undefined) {\n                    // *** New Tab ***\n                    console.log(`[Run Codes] Identified NEW tab: ${currentTag}. Adding all its codes.`);\n                    const newTabCodes = currentText.match(codeRegex) || [];\n                    if (newTabCodes.length > 0) {\n                        allCodeContentToProcess += newTabCodes.join(\"\\n\") + \"\\n\\n\"; // newTabCodes already includes the TAB tag\n                        hasAnyChanges = true;\n                    }\n                } else {\n                    // *** Existing Tab: Compare individual codes ***\n                    const currentCodes = currentText.match(codeRegex) || [];\n                    const previousCodesSet = new Set((previousText || \"\").match(codeRegex) || []);\n                    let tabHasChanges = false;\n                    let codesToAddForThisTab = \"\"; // Collect codes for this tab\n\n                    for (const currentCode of currentCodes) {\n                        if (!previousCodesSet.has(currentCode)) {\n                            console.log(`[Run Codes] Identified NEW/MODIFIED code in tab ${currentTag}: ${currentCode.substring(0, 80)}...`);\n                            codesToAddForThisTab += currentCode + \"\\n\"; // Collect only the new/modified code\n                            hasAnyChanges = true;\n                            tabHasChanges = true; // Mark that this specific tab had changes\n                        }\n                    }\n                    // If codes were added from this modified tab, prefix them with the TAB tag\n                    if (tabHasChanges) {\n                        allCodeContentToProcess += currentTag + \"\\n\"; // Add TAB tag\n                        allCodeContentToProcess += codesToAddForThisTab + \"\\n\"; // Add collected codes + separator\n                    }\n                }\n            }\n\n            // --- Validate ALL collected content BEFORE inserting codes.xlsx ---\n            if (hasAnyChanges) {\n                if (allCodeContentToProcess.trim().length > 0) {\n                    console.log(\"Validating ALL content from new/modified tabs BEFORE inserting codes.xlsx...\");\n                    const validationErrors = await validateCodeStringsForRun(allCodeContentToProcess.split(/\\r?\\n/).filter(line => line.trim() !== ''));\n\n                    if (validationErrors && validationErrors.length > 0) {\n                        const errorMsg = \"Validation failed. Please fix the errors before running:\\n\" + validationErrors.join(\"\\n\");\n                        console.error(\"Code validation failed:\", validationErrors);\n                        showError(\"Code validation failed. See chat for details.\");\n                        appendMessage(errorMsg);\n                        setButtonLoading(false);\n                        return; // Stop execution\n                    }\n                    console.log(\"Code validation successful for new/modified tabs.\");\n                } else {\n                    console.log(\"[Run Codes] Changes detected, but no code content found for validation in new/modified tabs.\");\n                     // This case might occur if only whitespace/comments changed within tabs\n                     // Decide if codes.xlsx insertion is still needed? Assuming yes if hasAnyChanges=true\n                }\n\n                // --- Insert codes.xlsx only AFTER successful validation if changes were detected ---\n                console.log(`[Run Codes] Changes detected and validated: ${currentTabs.filter(tab => !previousTabMap.has(tab.tag) || previousTabMap.get(tab.tag) !== tab.text).map(tab => tab.tag).join(', ')}. Inserting base sheets from codes.xlsx...`);\n                try {\n                    const codesResponse = await fetch('https://localhost:3002/assets/codes.xlsx');\n                    if (!codesResponse.ok) throw new Error(`codes.xlsx load failed: ${codesResponse.statusText}`);\n                    const codesArrayBuffer = await codesResponse.arrayBuffer();\n                    console.log(\"Converting codes.xlsx file to base64 (using chunks)...\");\n                    // ... (base64 conversion remains the same) ...\n                    const codesUint8Array = new Uint8Array(codesArrayBuffer);\n                    let codesBinaryString = '';\n                    const chunkSize_codes = 8192;\n                    for (let i = 0; i < codesUint8Array.length; i += chunkSize_codes) {\n                        const chunk = codesUint8Array.slice(i, Math.min(i + chunkSize_codes, codesUint8Array.length));\n                        codesBinaryString += String.fromCharCode.apply(null, chunk);\n                    }\n                    const codesBase64String = btoa(codesBinaryString);\n\n                    console.log(\"codes.xlsx Base64 conversion complete.\");\n                    await handleInsertWorksheetsFromBase64(codesBase64String);\n                    console.log(\"codes.xlsx sheets inserted.\");\n                } catch (e) {\n                    console.error(\"Failed to insert sheets from codes.xlsx:\", e);\n                    showError(\"Failed to insert necessary sheets from codes.xlsx. Aborting.\");\n                    setButtonLoading(false);\n                    return;\n                }\n            } else {\n                 console.log(\"[Run Codes] No changes identified in tabs compared to previous run. Nothing to insert or process.\");\n                 // Update previous state as the content is effectively the same\n                 try { localStorage.setItem('previousRunCodeStrings', codesToRun); } catch(e) { console.error(\"Err updating prev codes:\", e); }\n                 showMessage(\"No code changes identified to run.\");\n                 setButtonLoading(false);\n                 return; // Exit if no actionable changes\n            }\n\n        } // End of pass logic (if/else financialsSheetExists)\n\n        // --- Execute Processing ---\n\n        // >>> REMOVED: Incremental Insertion block <<<\n\n        // --- Process ALL collected content (New + Modified Tabs) using runCodes ---\n        if (allCodeContentToProcess.trim().length > 0) {\n            console.log(\"[Run Codes] Processing collected content from new/modified tabs...\");\n            console.log(\"Populating collection...\");\n            const collection = populateCodeCollection(allCodeContentToProcess);\n            console.log(`Collection populated with ${collection.length} code(s)`);\n\n             // Check if collection is empty after population (might happen if only comments/whitespace)\n            if (collection.length > 0) {\n                console.log(\"Running codes...\");\n                runResult = await runCodes(collection); // Store the result\n                console.log(\"Codes executed:\", runResult);\n            } else {\n                 console.log(\"[Run Codes] Collection is empty after population, skipping runCodes execution.\");\n                 // Ensure runResult is initialized for post-processing\n                 if (!runResult) runResult = { assumptionTabs: [] };\n            }\n        } else {\n            console.log(\"[Run Codes] No code content collected to process via runCodes.\");\n             // Initialize runResult structure if needed by post-processing\n             if (!runResult) runResult = { assumptionTabs: [] }; // Ensure runResult exists\n        }\n\n        // --- Post-processing (Runs regardless) ---\n        console.log(\"[Run Codes] Starting post-processing steps...\");\n        if (runResult && runResult.assumptionTabs && runResult.assumptionTabs.length > 0) {\n            console.log(\"Processing assumption tabs...\");\n            await processAssumptionTabs(runResult.assumptionTabs);\n        } else {\n             console.log(\"No assumption tabs to process.\");\n        }\n        console.log(\"Hiding specific columns and navigating...\");\n        // Pass assumption tabs from runResult (if any), otherwise an empty array.\n        await hideColumnsAndNavigate(runResult?.assumptionTabs || []);\n\n        // Cleanup\n        console.log(\"Deleting Codes sheet / Skipping hiding Calcs sheet...\");\n        await Excel.run(async (context) => {\n            try {\n                const codesSheet = context.workbook.worksheets.getItem(\"Codes\");\n                codesSheet.delete();\n                console.log(\"Codes sheet deleted.\");\n            } catch (e) {\n                if (e instanceof OfficeExtension.Error && e.code === Excel.ErrorCodes.itemNotFound) {\n                     console.warn(\"Codes sheet not found, skipping deletion.\");\n                } else { console.error(\"Error deleting Codes sheet:\", e); }\n            }\n            // Hiding Calcs sheet logic was removed previously, keeping it out.\n            await context.sync();\n        }).catch(error => { console.error(\"Error during sheet cleanup:\", error); });\n\n        // --- IMPORTANT: Update previous codes state AFTER successful processing ---\n        try {\n            localStorage.setItem('previousRunCodeStrings', codesToRun);\n            console.log(\"[Run Codes] Updated previous run state with full current codes.\");\n        } catch (error) {\n             console.error(\"[Run Codes] Failed to update previous run state:\", error);\n        }\n\n        showMessage(\"Code processing finished successfully!\");\n\n    } catch (error) {\n        console.error(\"An error occurred during the build process:\", error);\n        showError(`Operation failed: ${error.message || error.toString()}`);\n    } finally {\n        // Always set calculation mode back to automatic and hide loading\n        try {\n            await Excel.run(async (context) => {\n                context.application.calculationMode = Excel.CalculationMode.automatic;\n                await context.sync();\n            });\n        } catch (finalError) {\n            console.error(\"Error setting calculation mode to automatic:\", finalError);\n        }\n        setButtonLoading(false);\n    }\n}\n\n// Ensure Office.onReady sets up the button click handler for the REVISED function\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // Assign the REVISED async function as the handler\n    const button = document.getElementById(\"insert-and-run\");\n    if (button) {\n        button.onclick = insertSheetsAndRunCodes; // Use the revised function\n    } else {\n        console.error(\"Could not find button with id='insert-and-run'\");\n    }\n\n    // ... (rest of your Office.onReady remains the same) ...\n\n    // Keep the setup for your other buttons (send-button, reset-button, etc.)\n    const sendButton = document.getElementById('send');\n    if (sendButton) sendButton.onclick = handleSend;\n\n    const writeButton = document.getElementById('write-to-excel');\n    if (writeButton) writeButton.onclick = writeToExcel;\n\n    const resetButton = document.getElementById('reset-chat');\n    if (resetButton) resetButton.onclick = resetChat;\n\n    // >>> ADDED: Setup for Generate Tab String button\n    const generateTabStringButton = document.getElementById('generate-tab-string-button');\n    if (generateTabStringButton) {\n        generateTabStringButton.onclick = generateTabString; // Assign the imported function\n    } else {\n        console.error(\"Could not find button with id='generate-tab-string-button'\");\n    }\n    // <<< END ADDED CODE\n\n    const codesTextarea = document.getElementById('codes-textarea');\n    const editParamsButton = document.getElementById('edit-code-params-button');\n    const paramsModal = document.getElementById('code-params-modal');\n    const paramsModalForm = document.getElementById('code-params-modal-form');\n    const closeModalButton = paramsModal.querySelector('.close-button');\n    const applyParamsButton = document.getElementById('apply-code-params-button');\n    const cancelParamsButton = document.getElementById('cancel-code-params-button');\n\n    // Modal Find/Replace elements\n    const modalFindInput = document.getElementById('modal-find-input');\n    const modalReplaceInput = document.getElementById('modal-replace-input');\n    const modalReplaceAllButton = document.getElementById('modal-replace-all-button');\n    const modalSearchStatus = document.getElementById('modal-search-status');\n\n    let currentCodeStringRange = null; // To store {start, end} of the code string being edited\n    let currentCodeStringType = ''; // To store the type like 'VOL-EV'\n\n    // State for modal find/replace (Simplified)\n    let modalSearchableElements = []; // Stores {element, originalValue}\n    // Removed modalSearchTerm, modalCurrentMatchIndex, modalAllMatches\n\n    // Function to reset modal search state (Simplified)\n    const resetModalSearchState = () => {\n        modalSearchableElements = Array.from(paramsModalForm.querySelectorAll('input[data-param-key], textarea[data-param-key]'));\n        if (modalSearchStatus) modalSearchStatus.textContent = '';\n        // Clear input fields as well?\n        // if (modalFindInput) modalFindInput.value = '';\n        // if (modalReplaceInput) modalReplaceInput.value = '';\n        console.log(\"Modal search state reset.\");\n    };\n\n    // Function to update modal search status\n    const updateModalSearchStatus = (message) => {\n        if (modalSearchStatus) {\n            modalSearchStatus.textContent = message;\n        }\n    };\n\n    // Removed findAllMatchesInModal function\n\n    // Function to show the modal\n    const showParamsModal = () => {\n        if (paramsModal) {\n            paramsModal.style.display = 'block';\n            resetModalSearchState(); // Reset search when modal opens\n        }\n    };\n\n    // Function to hide the modal\n    const hideParamsModal = () => {\n        if (paramsModal) {\n            paramsModal.style.display = 'none';\n            paramsModalForm.innerHTML = ''; // Clear the form\n            currentCodeStringRange = null; // Reset state\n            currentCodeStringType = '';\n            resetModalSearchState(); // Also reset search state on close\n        }\n    };\n\n    // Function to find the <...> block around the cursor\n    const findCodeStringAroundCursor = (text, cursorPos) => {\n        const textBeforeCursor = text.substring(0, cursorPos);\n        const textAfterCursor = text.substring(cursorPos);\n\n        const lastOpenBracket = textBeforeCursor.lastIndexOf('<');\n        const lastCloseBracketBefore = textBeforeCursor.lastIndexOf('>');\n\n        // Check if cursor is potentially inside brackets\n        if (lastOpenBracket > lastCloseBracketBefore) {\n            const firstCloseBracketAfter = textAfterCursor.indexOf('>');\n            if (firstCloseBracketAfter !== -1) {\n                const start = lastOpenBracket;\n                const end = cursorPos + firstCloseBracketAfter + 1; // +1 to include '>'\n                const codeString = text.substring(start, end);\n                console.log(`Found code string: ${codeString} at range [${start}, ${end})`);\n                return { codeString, start, end };\n            }\n        }\n        console.log(\"Cursor not inside a <...> block.\");\n        return null; // Cursor is not inside a valid <...> block\n    };\n\n    // Function to parse parameters from the code string content (inside <...>)\n    const parseCodeParameters = (content) => {\n        const parts = content.split(';');\n        if (parts.length < 1) return { type: '', params: {} };\n\n        const type = parts[0].trim();\n        const params = {};\n        // Regex to match key=\"value\" or key=value (no quotes)\n        const paramRegex = /\\s*([^=\\s]+)\\s*=\\s*(?:\"([^\"]*)\"|([^;]*))/g;\n\n        for (let i = 1; i < parts.length; i++) {\n            const part = parts[i].trim();\n            if (!part) continue;\n\n            // Reset regex index before each exec\n            paramRegex.lastIndex = 0;\n            const match = paramRegex.exec(part);\n\n            if (match) {\n                const key = match[1];\n                // Value could be in group 2 (quoted) or group 3 (unquoted)\n                const value = match[2] !== undefined ? match[2] : match[3];\n                 if (key) { // Ensure key is valid\n                    params[key] = value.trim();\n                }\n            } else {\n                console.warn(`Could not parse parameter part: '${part}'`);\n            }\n        }\n        console.log(`Parsed type: ${type}, params:`, params);\n        return { type, params };\n    };\n\n    // Function to populate the modal form (needs to update searchable elements)\n    const populateParamsModal = (type, params) => {\n        paramsModalForm.innerHTML = ''; // Clear previous form items\n        currentCodeStringType = type; // Store the type\n\n        Object.entries(params).forEach(([key, value]) => {\n            const paramEntryDiv = document.createElement('div');\n            paramEntryDiv.className = 'param-entry';\n\n            const label = document.createElement('label');\n            label.htmlFor = `param-${key}`;\n            label.textContent = key;\n\n            let inputElement;\n            const isLongValue = key.toLowerCase().includes('row') || value.length > 60;\n            const isLIParam = /LI\\d+\\|/.test(value.trim()); // Check if value starts with LI<digit>|\n\n            if (isLongValue || isLIParam) { // Use textarea for LI params too, for consistency\n                inputElement = document.createElement('textarea');\n                inputElement.rows = isLIParam ? 2 : 3; // Slightly smaller for LI rows initially\n            } else {\n                inputElement = document.createElement('input');\n                inputElement.type = 'text';\n            }\n\n            inputElement.id = `param-${key}`;\n            inputElement.value = value;\n            inputElement.dataset.paramKey = key;\n            if (isLIParam) {\n                inputElement.dataset.isOriginalLi = \"true\"; // Mark original LI fields\n            }\n\n            paramEntryDiv.appendChild(label);\n\n            if (isLIParam) {\n                // Create a container for the LI field and its add button\n                const liContainer = document.createElement('div');\n                liContainer.className = 'li-parameter-container';\n                liContainer.dataset.originalLiKey = key; // Link container to original key\n\n                liContainer.appendChild(inputElement); // Add the input field first\n\n                // Create the Add button\n                const addButton = document.createElement('button');\n                addButton.type = 'button'; // Important: prevent form submission\n                addButton.textContent = '+';\n                addButton.className = 'ms-Button ms-Button--icon add-li-button'; // Add specific class\n                addButton.title = 'Add another LI item based on this one';\n                addButton.dataset.targetLiKey = key; // Link button to the input's key\n\n                addButton.onclick = (event) => {\n                    const sourceInput = document.getElementById(`param-${key}`);\n                    if (!sourceInput) return;\n\n                    const newValueContainer = document.createElement('div');\n                    newValueContainer.className = 'added-li-item';\n\n                    const newInput = sourceInput.cloneNode(true); // Clone the original input/textarea\n                    // Clear ID, mark as added, remove original marker\n                    newInput.id = '';\n                    newInput.dataset.isAddedLi = \"true\";\n                    delete newInput.dataset.isOriginalLi;\n                    newInput.dataset.originalLiKey = key; // Link back to the original key\n                    // Keep the same value as the original initially\n                    newInput.value = sourceInput.value; // Duplicate the content\n\n                    // Add a remove button for the added item\n                    const removeButton = document.createElement('button');\n                    removeButton.type = 'button';\n                    removeButton.textContent = '-';\n                    removeButton.className = 'ms-Button ms-Button--icon remove-li-button';\n                    removeButton.title = 'Remove this added LI item';\n                    removeButton.onclick = () => {\n                        newValueContainer.remove();\n                    };\n\n                    newValueContainer.appendChild(newInput);\n                    newValueContainer.appendChild(removeButton);\n\n                    // Insert the new container after the clicked button\n                    // or after the last added item within this container\n                    event.target.parentNode.appendChild(newValueContainer);\n                     // Maybe scroll container? paramsModalForm.scrollTop = paramsModalForm.scrollHeight;\n                };\n\n                liContainer.appendChild(addButton); // Add button after input\n                paramEntryDiv.appendChild(liContainer); // Add container to entry div\n\n            } else {\n                 paramEntryDiv.appendChild(inputElement); // Non-LI params added directly\n            }\n\n            paramsModalForm.appendChild(paramEntryDiv);\n        });\n        // IMPORTANT: Update searchable elements after populating\n        resetModalSearchState(); // Reset search state after populating form\n    };\n\n    // --- Event Listener for the Edit Parameters Button ---\n    if (editParamsButton && codesTextarea && paramsModal) {\n        editParamsButton.onclick = () => {\n            const text = codesTextarea.value;\n            const cursorPos = codesTextarea.selectionStart;\n\n            const codeInfo = findCodeStringAroundCursor(text, cursorPos);\n\n            if (codeInfo) {\n                // Extract content within < >\n                const content = codeInfo.codeString.substring(1, codeInfo.codeString.length - 1);\n                const { type, params } = parseCodeParameters(content);\n\n                if (type) {\n                    currentCodeStringRange = { start: codeInfo.start, end: codeInfo.end };\n                    populateParamsModal(type, params);\n                    showParamsModal();\n                } else {\n                    showError(\"Could not parse the code string structure.\");\n                }\n            } else {\n                showError(\"Place cursor inside a <...> code block to edit parameters.\");\n            }\n        };\n    }\n\n    // --- Event Listeners for Modal Actions ---\n    if (closeModalButton) {\n        closeModalButton.onclick = hideParamsModal;\n    }\n    if (cancelParamsButton) {\n        cancelParamsButton.onclick = hideParamsModal;\n    }\n\n    // --- APPLY CHANGES LOGIC (MODIFIED) ---\n    if (applyParamsButton && codesTextarea) {\n        applyParamsButton.onclick = () => {\n            if (!currentCodeStringRange || !currentCodeStringType) return; // Safety check\n\n            // Use a map to reconstruct parameters, handling LI aggregation\n            const paramValues = {};\n\n            // Process all input/textarea fields in the form\n            const formElements = paramsModalForm.querySelectorAll('input[data-param-key], textarea[data-param-key]');\n\n            formElements.forEach(input => {\n                const key = input.dataset.paramKey;\n                const isOriginalLI = input.dataset.isOriginalLi === \"true\";\n                const isAddedLI = input.dataset.isAddedLi === \"true\";\n                const value = input.value;\n\n                if (isOriginalLI) {\n                    // If it's an original LI, initialize its value in the map\n                    if (!paramValues[key]) {\n                        paramValues[key] = value; // Start with the original value\n                    }\n                } else if (isAddedLI) {\n                    // This case handled below by finding related elements\n                    // We only need to store original keys first\n                } else if (key && !isAddedLI) {\n                    // Standard parameter, just store its value\n                     if (!paramValues[key]) { // Check prevents overwriting if key appears twice (shouldn't happen)\n                       paramValues[key] = value;\n                    }\n                }\n            });\n\n            // Now, aggregate added LI items\n            const addedLiElements = paramsModalForm.querySelectorAll('textarea[data-is-added-li=\"true\"]');\n            addedLiElements.forEach(addedInput => {\n                 const originalKey = addedInput.dataset.originalLiKey;\n                 if (originalKey && paramValues[originalKey]) {\n                      // Append the added value, prefixed with *\n                      paramValues[originalKey] += ` *${addedInput.value}`;\n                 }\n            });\n\n            // Build the final parameter string parts\n            const updatedParams = Object.entries(paramValues).map(([key, finalValue]) => {\n                 // Re-add quotes around the final aggregated value\n                 return `${key}=\"${finalValue}\"`;\n            });\n\n            // Reconstruct the code string\n            const newCodeStringContent = `${currentCodeStringType}; ${updatedParams.join('; ')}`;\n            const newCodeString = `<${newCodeStringContent}>`;\n\n            // Update the textarea content\n            const currentText = codesTextarea.value;\n            const textBefore = currentText.substring(0, currentCodeStringRange.start);\n            const textAfter = currentText.substring(currentCodeStringRange.end);\n\n            codesTextarea.value = textBefore + newCodeString + textAfter;\n\n            console.log(`Updated code string at [${currentCodeStringRange.start}, ${currentCodeStringRange.start + newCodeString.length})`);\n            console.log(\"New string:\", newCodeString);\n\n            // Optionally, update cursor position\n            const newCursorPos = currentCodeStringRange.start + newCodeString.length;\n            codesTextarea.focus();\n            codesTextarea.setSelectionRange(newCursorPos, newCursorPos);\n\n            hideParamsModal(); // Close modal after applying\n        };\n    }\n\n    // --- Modal Find/Replace Logic (Simplified) ---\n\n    const modalReplaceAll = () => {\n        const searchTerm = modalFindInput.value;\n        const replaceTerm = modalReplaceInput.value;\n        if (!searchTerm) {\n            updateModalSearchStatus(\"Enter search term.\");\n            return;\n        }\n\n        // Ensure searchable elements are up-to-date\n        modalSearchableElements = Array.from(paramsModalForm.querySelectorAll('input[data-param-key], textarea[data-param-key]'));\n\n        let replacementsMade = 0;\n        modalSearchableElements.forEach((element, index) => {\n            let currentValue = element.value;\n            // Escape regex special characters in search term\n            const escapedSearchTerm = searchTerm.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n            let newValue = currentValue.replace(new RegExp(escapedSearchTerm, 'g'), () => {\n                replacementsMade++;\n                return replaceTerm;\n            });\n            if (currentValue !== newValue) {\n                element.value = newValue;\n                console.log(`Modal Replace All: Made replacements in element ${index}`);\n            }\n        });\n\n        if (replacementsMade > 0) {\n            updateModalSearchStatus(`Replaced ${replacementsMade} occurrence(s).`);\n            // No need to reset search state as there's no find next\n        } else {\n            updateModalSearchStatus(`\"${searchTerm}\" not found.`);\n        }\n    };\n\n    // Add event listeners for modal find/replace buttons (Simplified)\n    // Removed listeners for Find Next and Replace\n    if (modalReplaceAllButton) modalReplaceAllButton.onclick = modalReplaceAll;\n    // Removed input listener for modalFindInput\n\n    // --- Event Listeners for Modal Actions ---\n    if (closeModalButton) {\n        closeModalButton.onclick = hideParamsModal;\n    }\n\n    // ... (rest of your Office.onReady, including suggestion logic, initializations)\n\n    // Make sure initialization runs after setting up modal logic\n    Promise.all([\n        initializeAPIKeys(),\n        loadCodeDatabase()\n    ]).then(([keys]) => {\n      if (!keys) {\n        showError(\"Failed to load API keys. Please check configuration.\");\n      } else {\n        // >>> ADDED: Set the API keys in AIcalls module\n        setAPIKeys(keys);\n      }\n      conversationHistory = loadConversationHistory();\n\n      try {\n          const storedCodes = localStorage.getItem('userCodeStrings');\n          if (storedCodes !== null) {\n              loadedCodeStrings = storedCodes;\n              if (codesTextarea) {\n                  codesTextarea.value = loadedCodeStrings;\n              }\n              console.log(\"Code strings loaded from localStorage into global variable.\");\n          } else {\n              console.log(\"No code strings found in localStorage, initializing global variable as empty.\");\n              loadedCodeStrings = \"\";\n          }\n          // Also load the previous run codes if available\n           const storedPreviousCodes = localStorage.getItem('previousRunCodeStrings');\n           if (storedPreviousCodes) {\n               console.log(\"Previous run code strings loaded from localStorage.\");\n           }\n\n      } catch (error) {\n          console.error(\"Error loading code strings from localStorage:\", error);\n          showError(`Error loading codes from storage: ${error.message}`);\n          loadedCodeStrings = \"\";\n      }\n\n      // >>> MOVED: Assign event listeners AFTER initialization is complete\n      // Setup cursor position tracking\n      if (codesTextarea) {\n          const updateCursorPosition = () => {\n              lastEditorCursorPosition = codesTextarea.selectionStart;\n              // console.log(`Cursor position updated: ${lastEditorCursorPosition}`); // Optional debug log\n          };\n          codesTextarea.addEventListener('keyup', updateCursorPosition); // Update on key release\n          codesTextarea.addEventListener('mouseup', updateCursorPosition); // Update on mouse click release\n          codesTextarea.addEventListener('focus', updateCursorPosition);   // Update when focus is gained\n          // codesTextarea.addEventListener('blur', updateCursorPosition); // Maybe don't update on blur?\n          console.log(\"[Office.onReady] Added event listeners to codesTextarea for cursor tracking.\"); // <<< DEBUG LOG\n      }\n\n      // Setup Insert to Editor button\n      const insertToEditorButton = document.getElementById('insert-to-editor');\n      if (insertToEditorButton) {\n          console.log(\"[Office.onReady] Found insert-to-editor button.\"); // <<< DEBUG LOG\n          insertToEditorButton.onclick = insertResponseToEditor;\n          console.log(\"[Office.onReady] Assigned onclick for insert-to-editor button.\"); // <<< DEBUG LOG\n      } else {\n          console.error(\"[Office.onReady] Could not find button with id='insert-to-editor'\");\n      }\n      // <<< END MOVED CODE\n\n    }).catch(error => {\n        console.error(\"Error during initialization:\", error);\n        showError(\"Error during initialization: \" + error.message);\n    });\n\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"block\";\n\n    // ... (existing modal logic: applyParamsButton.onclick, window.onclick)\n\n    // --- Code Suggestion Logic (Restored) ---\n    let dynamicSuggestionsContainer = document.getElementById('dynamic-suggestions-container');\n    if (!dynamicSuggestionsContainer) {\n        dynamicSuggestionsContainer = document.createElement('div');\n        dynamicSuggestionsContainer.id = 'dynamic-suggestions-container';\n        dynamicSuggestionsContainer.className = 'code-suggestions'; // Reuse class if styling exists\n        dynamicSuggestionsContainer.style.display = 'none';\n        // Basic positioning styles (adjust in CSS for better control)\n        dynamicSuggestionsContainer.style.position = 'absolute';\n        dynamicSuggestionsContainer.style.border = '1px solid #ccc';\n        dynamicSuggestionsContainer.style.backgroundColor = 'white';\n        dynamicSuggestionsContainer.style.maxHeight = '150px';\n        dynamicSuggestionsContainer.style.overflowY = 'auto';\n        dynamicSuggestionsContainer.style.zIndex = '1000';\n\n        // Insert after the textarea's container or adjust as needed\n        if (codesTextarea && codesTextarea.parentNode) { // Check if codesTextarea exists\n            codesTextarea.parentNode.insertBefore(dynamicSuggestionsContainer, codesTextarea.nextSibling);\n        } else {\n            // Fallback: Append to body, though less ideal positioning\n            document.body.appendChild(dynamicSuggestionsContainer);\n        }\n\n        // Function to update position and width\n        const updateSuggestionPosition = () => {\n          if (dynamicSuggestionsContainer.style.display === 'block' && codesTextarea) {\n              const rect = codesTextarea.getBoundingClientRect();\n              dynamicSuggestionsContainer.style.width = codesTextarea.offsetWidth + 'px';\n              dynamicSuggestionsContainer.style.top = (rect.bottom + window.scrollY) + 'px';\n              dynamicSuggestionsContainer.style.left = (rect.left + window.scrollX) + 'px';\n          }\n        };\n\n        // Update on resize and scroll\n        window.addEventListener('resize', updateSuggestionPosition);\n        window.addEventListener('scroll', updateSuggestionPosition, true); // Use capture phase for scroll\n    }\n\n    let highlightedSuggestionIndex = -1;\n    let currentSuggestions = [];\n\n    const updateHighlight = (newIndex) => {\n      if (!dynamicSuggestionsContainer) return; // Guard against null\n      const suggestionItems = dynamicSuggestionsContainer.querySelectorAll('.code-suggestion-item');\n      if (highlightedSuggestionIndex >= 0 && highlightedSuggestionIndex < suggestionItems.length) {\n        suggestionItems[highlightedSuggestionIndex].classList.remove('suggestion-highlight');\n      }\n      if (newIndex >= 0 && newIndex < suggestionItems.length) {\n        suggestionItems[newIndex].classList.add('suggestion-highlight');\n        suggestionItems[newIndex].scrollIntoView({ block: 'nearest' });\n      }\n      highlightedSuggestionIndex = newIndex;\n    };\n\n    const showSuggestionsForTerm = (searchTerm) => {\n        if (!dynamicSuggestionsContainer || !codesTextarea) return; // Guard against null\n\n        searchTerm = searchTerm.toLowerCase().trim();\n        console.log(`[showSuggestionsForTerm] Search Term: '${searchTerm}'`);\n\n        dynamicSuggestionsContainer.innerHTML = '';\n        highlightedSuggestionIndex = -1;\n        currentSuggestions = [];\n\n        if (searchTerm.length < 2) {\n            console.log(\"[showSuggestionsForTerm] Search term too short, hiding suggestions.\");\n            dynamicSuggestionsContainer.style.display = 'none';\n            return;\n        }\n\n        console.log(\"[showSuggestionsForTerm] Filtering code database...\");\n        const suggestions = codeDatabase\n            .filter(item => {\n                const hasName = item && typeof item.name === 'string';\n                return hasName && item.name.toLowerCase().includes(searchTerm);\n            })\n            .slice(0, 10);\n\n        currentSuggestions = suggestions;\n        console.log(`[showSuggestionsForTerm] Found ${currentSuggestions.length} suggestions:`, currentSuggestions);\n\n        if (currentSuggestions.length > 0) {\n            console.log(\"[showSuggestionsForTerm] Populating suggestions container...\");\n            currentSuggestions.forEach((item, i) => {\n                const suggestionDiv = document.createElement('div');\n                suggestionDiv.className = 'code-suggestion-item';\n                suggestionDiv.textContent = item.name;\n                suggestionDiv.dataset.index = i;\n\n                suggestionDiv.onclick = () => {\n                    console.log(`Suggestion clicked: '${item.name}'`);\n                    const currentText = codesTextarea.value;\n                    const cursorPosition = codesTextarea.selectionStart;\n                    let codeToAdd = item.code;\n\n                    let insertionPosition = cursorPosition;\n                    let wasAdjusted = false;\n                    const textBeforeCursor = currentText.substring(0, cursorPosition);\n                    const lastOpenBracket = textBeforeCursor.lastIndexOf('<');\n                    const lastCloseBracket = textBeforeCursor.lastIndexOf('>');\n\n                    if (lastOpenBracket > lastCloseBracket) {\n                        const textAfterCursor = currentText.substring(cursorPosition);\n                        const nextCloseBracket = textAfterCursor.indexOf('>');\n                        if (nextCloseBracket !== -1) {\n                            insertionPosition = cursorPosition + nextCloseBracket + 1;\n                            wasAdjusted = true;\n                            console.log(`Cursor inside <>, adjusting insertion point to after > at ${insertionPosition}`);\n                        }\n                    }\n\n                    const maxNumbers = getMaxDriverNumbers(currentText);\n                    // Corrected regex - double escapes not needed in string literal here\n                    const driverRegex = /(row\\d+\\s*=\\s*\")([A-Z]+)(\\d*)(\\|)/g;\n                    const nextNumbers = { ...maxNumbers };\n\n                    codeToAdd = codeToAdd.replace(driverRegex, (match, rowPart, prefix, existingNumberStr, pipePart) => {\n                        nextNumbers[prefix] = (nextNumbers[prefix] || 0) + 1;\n                        const newNumber = nextNumbers[prefix];\n                        const replacement = `${rowPart}${prefix}${newNumber}${pipePart}`;\n                        console.log(`Replacing driver: '${prefix}${existingNumberStr || ''}|' with '${prefix}${newNumber}|'`);\n                        return replacement;\n                    });\n\n                    console.log(\"Modified code to add:\", codeToAdd);\n\n                    const textAfterInsertion = currentText.substring(insertionPosition);\n                    let textBeforeFinal = \"\";\n                    let searchStartIndex = insertionPosition;\n\n                    if (!wasAdjusted) {\n                        const textBeforeInsertion = currentText.substring(0, insertionPosition);\n                        let tempSearchStart = cursorPosition - 1;\n                        while (tempSearchStart >= 0) {\n                            const char = textBeforeCursor[tempSearchStart];\n                             // CORRECTED REGEX IN ONCLICK:\n                            if (/\\s|\\n|>|<|;|\\|/.test(char)) {\n                                tempSearchStart++;\n                                break;\n                            }\n                            tempSearchStart--;\n                        }\n                        if (tempSearchStart < 0) tempSearchStart = 0;\n\n                        searchStartIndex = tempSearchStart;\n                        const searchTermToRemove = textBeforeCursor.substring(searchStartIndex, cursorPosition);\n                        console.log(`Attempting to replace term: '${searchTermToRemove}' starting at index ${searchStartIndex}`);\n                        textBeforeFinal = currentText.substring(0, searchStartIndex);\n                    } else {\n                         textBeforeFinal = currentText.substring(0, insertionPosition);\n                         searchStartIndex = insertionPosition;\n                    }\n\n                    const firstNewlineIndexInSuffix = textAfterInsertion.indexOf('\\n');\n                    let remainderOfOriginalLine = \"\";\n                    let subsequentLines = \"\";\n\n                    if (firstNewlineIndexInSuffix === -1) {\n                        remainderOfOriginalLine = textAfterInsertion;\n                    } else {\n                        remainderOfOriginalLine = textAfterInsertion.substring(0, firstNewlineIndexInSuffix);\n                        subsequentLines = textAfterInsertion.substring(firstNewlineIndexInSuffix);\n                    }\n\n                    const newText = textBeforeFinal +\n                                    codeToAdd +\n                                    (remainderOfOriginalLine.length > 0 ? '\\n' : '') +\n                                    remainderOfOriginalLine +\n                                    subsequentLines;\n\n                    codesTextarea.value = newText;\n\n                    const newCursorPos = (textBeforeFinal + codeToAdd).length;\n                    codesTextarea.focus();\n                    codesTextarea.setSelectionRange(newCursorPos, newCursorPos);\n\n                    dynamicSuggestionsContainer.innerHTML = '';\n                    dynamicSuggestionsContainer.style.display = 'none';\n                    highlightedSuggestionIndex = -1;\n                    currentSuggestions = [];\n                };\n\n                suggestionDiv.onmouseover = () => {\n                    updateHighlight(i);\n                };\n\n                dynamicSuggestionsContainer.appendChild(suggestionDiv);\n            });\n            console.log(\"[showSuggestionsForTerm] Setting suggestions display to 'block'\");\n\n            const rect = codesTextarea.getBoundingClientRect();\n            dynamicSuggestionsContainer.style.width = codesTextarea.offsetWidth + 'px';\n            dynamicSuggestionsContainer.style.top = (rect.bottom + window.scrollY) + 'px';\n            dynamicSuggestionsContainer.style.left = (rect.left + window.scrollX) + 'px';\n            dynamicSuggestionsContainer.style.display = 'block';\n        } else {\n            console.log(\"[showSuggestionsForTerm] No suggestions found, hiding container.\");\n            dynamicSuggestionsContainer.style.display = 'none';\n        }\n    };\n\n    if (codesTextarea && dynamicSuggestionsContainer) {\n        codesTextarea.oninput = (event) => {\n             if (!event.isTrusted || !dynamicSuggestionsContainer) {\n                 return;\n             }\n            const cursorPosition = codesTextarea.selectionStart;\n            const currentText = codesTextarea.value;\n\n            const textBeforeCursor = currentText.substring(0, cursorPosition);\n            const lastOpenBracket = textBeforeCursor.lastIndexOf('<');\n            const lastCloseBracket = textBeforeCursor.lastIndexOf('>');\n            let isInsideBrackets = false;\n            if (lastOpenBracket > lastCloseBracket) {\n                const textAfterCursor = currentText.substring(cursorPosition);\n                const nextCloseBracket = textAfterCursor.indexOf('>');\n                if (nextCloseBracket !== -1 ) {\n                    isInsideBrackets = true;\n                }\n            }\n\n            if (isInsideBrackets) {\n                console.log(\"[Textarea Input] Cursor inside <>, hiding suggestions.\");\n                dynamicSuggestionsContainer.style.display = 'none';\n                highlightedSuggestionIndex = -1;\n                currentSuggestions = [];\n            } else {\n                let searchStart = cursorPosition - 1;\n                while (searchStart >= 0) {\n                    const char = textBeforeCursor[searchStart];\n                    // CORRECTED REGEX: No double escapes needed\n                    if (/\\s|\\n|>|<|;|\\|/.test(char)) {\n                        searchStart++;\n                        break;\n                    }\n                    searchStart--;\n                }\n                if (searchStart < 0) searchStart = 0;\n\n                console.log(`[Textarea Input Debug] cursorPosition: ${cursorPosition}, calculated searchStart: ${searchStart}, char at searchStart: '${searchStart < currentText.length ? textBeforeCursor[searchStart] : 'EOF'}'`);\n\n                const searchTerm = textBeforeCursor.substring(searchStart, cursorPosition);\n                const trimmedSearchTerm = searchTerm.trim();\n\n                if (trimmedSearchTerm.length === 0 || !/^[a-zA-Z]/.test(trimmedSearchTerm)) {\n                     if (trimmedSearchTerm.length === 0) {\n                         console.log(`[Textarea Input] Hiding suggestions (empty term detected immediately after delimiter)`);\n                     } else {\n                         console.log(`[Textarea Input] Hiding suggestions (term does not start with letter: '${searchTerm}')`);\n                     }\n                    dynamicSuggestionsContainer.style.display = 'none';\n                    highlightedSuggestionIndex = -1;\n                    currentSuggestions = [];\n                } else {\n                    console.log(`[Textarea Input] Cursor outside <>, potential search term: '${searchTerm}'`);\n                    showSuggestionsForTerm(searchTerm);\n                }\n            }\n        };\n\n        codesTextarea.onkeydown = (event) => {\n            if (!dynamicSuggestionsContainer || dynamicSuggestionsContainer.style.display !== 'block' || currentSuggestions.length === 0) {\n                return;\n            }\n\n            const suggestionItems = dynamicSuggestionsContainer.querySelectorAll('.code-suggestion-item');\n            let newIndex = highlightedSuggestionIndex;\n\n            switch (event.key) {\n                case 'ArrowDown':\n                case 'ArrowUp':\n                    event.preventDefault();\n                    newIndex = event.key === 'ArrowDown'\n                        ? (highlightedSuggestionIndex + 1) % currentSuggestions.length\n                        : (highlightedSuggestionIndex - 1 + currentSuggestions.length) % currentSuggestions.length;\n                    updateHighlight(newIndex);\n                    break;\n\n                case 'Enter':\n                 case 'Tab':\n                    event.preventDefault();\n                    if (highlightedSuggestionIndex >= 0 && highlightedSuggestionIndex < suggestionItems.length) {\n                        suggestionItems[highlightedSuggestionIndex].click();\n                    } else if (currentSuggestions.length > 0 && suggestionItems.length > 0) {\n                         suggestionItems[0].click(); // Select first if none highlighted\n                    }\n                    // Suggestion click handles hiding\n                    break;\n\n                case 'Escape':\n                    event.preventDefault();\n                    dynamicSuggestionsContainer.style.display = 'none';\n                    highlightedSuggestionIndex = -1;\n                    currentSuggestions = [];\n                    break;\n\n                default:\n                    if (!event.ctrlKey && !event.altKey && !event.metaKey && event.key.length === 1) {\n                       updateHighlight(-1);\n                    }\n                    break;\n            }\n        };\n\n         codesTextarea.addEventListener('blur', () => {\n             if (!dynamicSuggestionsContainer) return;\n             setTimeout(() => {\n                 if (!dynamicSuggestionsContainer.contains(document.activeElement)) {\n                      dynamicSuggestionsContainer.style.display = 'none';\n                      highlightedSuggestionIndex = -1;\n                 }\n             }, 150);\n         });\n    }\n    // --- End of Code Suggestion Logic ---\n\n\n    // ... (rest of your Office.onReady, e.g., Promise.all)\n\n    // Make sure initialization runs after setting up modal logic\n  }\n});\n\n// >>> ADDED: Function definition moved here\nasync function insertResponseToEditor() {\n    console.log(\"[insertResponseToEditor] Function called.\");\n    if (!lastResponse) {\n        console.log(\"[insertResponseToEditor] Exiting: lastResponse is null or empty.\");\n        showError('No response to insert');\n        return;\n    }\n\n    console.log(\"[insertResponseToEditor] lastResponse:\", lastResponse);\n\n    const codesTextarea = document.getElementById('codes-textarea');\n    if (!codesTextarea) {\n        console.error(\"[insertResponseToEditor] Exiting: Could not find codes-textarea.\");\n        showError('Could not find the code editor textarea');\n        return;\n    }\n\n    console.log(\"[insertResponseToEditor] Found codesTextarea.\");\n\n    try {\n        // Check for valid cursor position FIRST\n        if (lastEditorCursorPosition === null) {\n             console.log(\"[insertResponseToEditor] Exiting: lastEditorCursorPosition is null.\");\n             showError(\"Please click in the code editor first to set the insertion point.\");\n             return;\n        }\n\n        let responseText = \"\";\n        // >>> MODIFIED: Extract <...> strings and ensure each is on a new line\n        let codeStringsToInsert = [];\n        if (Array.isArray(lastResponse)) {\n            // Filter out empty strings just in case\n            codeStringsToInsert = lastResponse.filter(item => typeof item === 'string' && item.trim().length > 0);\n        } else if (typeof lastResponse === 'string') {\n            const matches = lastResponse.match(/<[^>]+>/g); // Find all <...> patterns\n            if (matches) {\n                codeStringsToInsert = matches;\n            } else if (lastResponse.trim().length > 0) {\n                 // Fallback: If it's a string but no <...> found, maybe insert the whole string?\n                 // For now, let's only insert if <...> are found based on the requirement.\n                 console.log(\"[insertResponseToEditor] lastResponse is a string but no <...> tags found.\");\n            }\n        } else {\n            // Log if the format is unexpected\n             console.warn(\"[insertResponseToEditor] lastResponse is not an array or string:\", lastResponse);\n        }\n\n        if (codeStringsToInsert.length === 0) {\n            showMessage(\"No code strings found in the response to insert.\");\n            console.log(\"[insertResponseToEditor] No <...> strings extracted from lastResponse.\");\n            return;\n        }\n\n        // Join the extracted strings, each on its own line\n        responseText = codeStringsToInsert.join('\\n');\n        // <<< END MODIFIED BLOCK\n\n        if (!responseText) {\n            showMessage(\"Response is empty, nothing to insert.\");\n            return;\n        }\n\n        const currentText = codesTextarea.value;\n        // Define insertionPoint using the validated cursor position\n        const insertionPoint = lastEditorCursorPosition;\n\n        // >>> ADDED: Check for <TAB; prefix if missing\n        const tabPrefix = '<TAB; ';\n        const defaultTabString = '<TAB; label1=\"Calcs\";>';\n        let addDefaultTab = false;\n        if (!currentText.includes(tabPrefix) && !responseText.includes(tabPrefix)) {\n            addDefaultTab = true;\n            console.log(\"[insertResponseToEditor] Neither editor nor response contains '<TAB; '. Prepending default tab.\");\n        }\n        // <<< END ADDED CHECK\n\n        // Validate insertionPoint is within bounds (safety check)\n        if (insertionPoint < 0 || insertionPoint > currentText.length) {\n             console.error(`[insertResponseToEditor] Invalid insertionPoint: ${insertionPoint}, currentText length: ${currentText.length}`);\n             showError(\"Invalid cursor position detected. Please click in the editor again.\");\n             lastEditorCursorPosition = null; // Reset invalid position\n             return;\n        }\n\n        const textBefore = currentText.substring(0, insertionPoint);\n        const textAfter = currentText.substring(insertionPoint);\n\n        // Insert the response, adding a newline before if inserting mid-text and not at the start or after a newline\n        let textToInsert = (addDefaultTab ? defaultTabString + '\\n' : '') + responseText; // Prepend default tab if needed\n        if (insertionPoint > 0 && textBefore.charAt(textBefore.length - 1) !== '\\n') {\n             textToInsert = '\\n' + textToInsert; // Add leading newline to the combined string (tab + response)\n        }\n        // Add a newline after if not inserting at the very end or before an existing newline\n        if (insertionPoint < currentText.length && textAfter.charAt(0) !== '\\n') {\n             textToInsert += '\\n';\n        } else if (insertionPoint === currentText.length && currentText.length > 0 && textBefore.charAt(textBefore.length - 1) !== '\\n') {\n             // Special case: inserting exactly at the end, ensure newline separation from previous content\n             textToInsert = '\\n' + textToInsert;\n        }\n\n\n        codesTextarea.value = textBefore + textToInsert + textAfter;\n\n        // Update the last cursor position to be after the inserted text\n        const newCursorPos = insertionPoint + textToInsert.length;\n        codesTextarea.focus();\n        codesTextarea.setSelectionRange(newCursorPos, newCursorPos);\n        lastEditorCursorPosition = newCursorPos; // Update tracked position\n\n        showMessage(\"Response inserted into editor.\");\n        console.log(`Response inserted at position: ${insertionPoint}`);\n\n    } catch (error) {\n        console.error(\"Error inserting response to editor:\", error);\n        showError(`Failed to insert response: ${error.message}`);\n    }\n}\n\n\n\n\n\n\n\n\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Projectify Task Pane</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-Fabric\\\" dir=\\\"ltr\\\"> <div id=\\\"sideload-msg\\\" class=\\\"ms-Rule ms-font-xl\\\"> <p>Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/sideload-office-add-ins-for-testing\\\">sideload</a> your add-in to see app body.</p> </div> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <div class=\\\"container\\\"> <div id=\\\"chat-log\\\" class=\\\"chat-log\\\"> <div id=\\\"welcome-message\\\" class=\\\"welcome-message\\\"> <h1>What would you like to model?</h1> </div> </div> <div class=\\\"input-area\\\"> <input type=\\\"text\\\" id=\\\"user-input\\\" placeholder=\\\"Enter your request here...\\\"> <button id=\\\"send\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Send</span> </button> <div id=\\\"loading-animation\\\" class=\\\"loading-animation\\\"></div> <button id=\\\"write-to-excel\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Write Response to Excel</span> </button> <button id=\\\"insert-to-editor\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Insert to Editor</span> </button> <button id=\\\"reset-chat\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Reset Chat</span> </button> </div> <div class=\\\"code-area\\\"> <h2>Codes</h2> <textarea id=\\\"codes-textarea\\\" rows=\\\"15\\\" placeholder=\\\"Code strings will appear here after generation or can be pasted...\\\"></textarea> <div id=\\\"dynamic-suggestions-container\\\" class=\\\"code-suggestions\\\"></div> <div class=\\\"code-area-buttons\\\"> <button id=\\\"edit-code-params-button\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Edit Params</span> </button> <button id=\\\"insert-and-run\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Run Codes</span> </button> <button id=\\\"generate-tab-string-button\\\" class=\\\"ms-Button\\\"> <span class=\\\"ms-Button-label\\\">Generate Tab Index</span> </button> </div> </div> <div id=\\\"code-params-modal\\\" class=\\\"modal\\\"> <div class=\\\"modal-content\\\"> <span class=\\\"close-button\\\">&times;</span> <h2>Edit Code Parameters</h2> <div class=\\\"modal-find-replace\\\"> <input type=\\\"text\\\" id=\\\"modal-find-input\\\" placeholder=\\\"Find in Params\\\"> <input type=\\\"text\\\" id=\\\"modal-replace-input\\\" placeholder=\\\"Replace With\\\"> <button id=\\\"modal-replace-all-button\\\" class=\\\"ms-Button\\\">Replace All</button> <span id=\\\"modal-search-status\\\"></span> </div> <form id=\\\"code-params-modal-form\\\"> </form> <div class=\\\"modal-actions\\\"> <button id=\\\"apply-code-params-button\\\" class=\\\"ms-Button ms-Button--primary\\\">Apply</button> <button id=\\\"cancel-code-params-button\\\" class=\\\"ms-Button\\\">Cancel</button> </div> </div> </div> </div> </main> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </body> </html>\";\n// Exports\nexport default code;"],"names":["Object","defineProperty","exports","value","handleApiError","utils_1","http_1","request_1","async","e","customMessage","url","Error","name","responseError","rawMessage","extractMessage","statusCode","response","status","message","mapHttpStatusError","PineconeConnectionError","err","ChatStream","convertKeys_1","constructor","stream","this","Symbol","asyncIterator","buffer","chunk","newlineIndex","toString","indexOf","line","slice","trim","startsWith","json","parsedJson","JSON","parse","convertedJson","convertKeysToCamelCase","console","debug","PineconeUnmappedHttpError","PineconeNotImplementedError","PineconeUnavailableError","PineconeMaxRetriesExceededError","PineconeInternalServerError","PineconeConflictError","PineconeNotFoundError","PineconeAuthorizationError","PineconeBadRequestError","base_1","CONFIG_HELP","BasePineconeError","failedRequest","super","body","join","retries","requestInfo","failedRequestInfo","getFetch","errors_1","config","fetchApi","g","fetch","PineconeConfigurationError","RetryOnServerFailure","asyncFn","maxRetries","calculateRetryDelay","attempt","baseDelay","maxDelay","jitterFactor","delay","Math","random","min","max","execute","args","isRetryError","error","mappedError","mapErrorIfNeeded","shouldStopRetrying","includes","delayTime","Promise","resolve","setTimeout","cachedSetTimeout","cachedClearTimeout","process","module","defaultSetTimout","defaultClearTimeout","runTimeout","fun","call","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","marker","runClearTimeout","Item","array","noop","nextTick","Array","arguments","i","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","PineconeUnableToResolveHostError","PineconeEnvironmentVarsNotSupportedError","PineconeUnexpectedResponseError","normalizeUrl","PineconeRequestError","urlMessage","context","init","method","cause","setPrototypeOf","captureStackTrace","debugLog","str","PINECONE_DEBUG","log","isBrowser","isEdge","EdgeRuntime","window","__createBinding","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","__exportStar","p","hasOwnProperty","PineconeArgumentError","config_1","validation_1","handling_1","object","isArray","map","item","entries","reduce","acc","key","toCamelCase","replace","_","letter","toUpperCase","text","messageJSON","__setModuleDefault","v","__importStar","mod","result","buildUserAgent","environment_1","packageInfo","userAgentParts","sourceTag","normalizeSourceTag","toLowerCase","queryParamsStringify","params","prefix","keys","querystringSingleKey","filter","part","keyPrefix","fullKey","multiValue","singleValue","encodeURIComponent","String","Set","from","Date","toISOString","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","globalThis","Function","obj","prop","scriptUrl","importScripts","location","document","currentScript","tagName","src","scripts","getElementsByTagName","test","b","baseURI","self","href","_regeneratorRuntime","t","r","n","a","iterator","c","u","toStringTag","define","wrap","Generator","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","__await","then","callInvokeWithMethodAndArg","done","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","mark","__proto__","awrap","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_createForOfIteratorHelper","_n","F","asyncGeneratorStep","_asyncToGenerator","_next","_throw","validateCodeStrings","_x","_validateCodeStrings","_callee","inputCodeStrings","errors","tabLabels","rowValues","codeTypes","vvCodes","vrCodes","rrCodes","rvCodes","evCodes","erCodes","validCodes","fileContent","_iterator","_step","codeString","rowMatches","codeMatch","codeType","_i","_arr","code","_i2","_arr2","_code","_iterator2","_step2","_codeString","_codeMatch","_codeType","labelMatch","label","_rowMatches","_iterator3","_step3","_codeString2","driverMatches","_context","match","ok","split","t0","endsWith","parts","trimmedPart","afterAsterisk","substring","add","t1","size","has","rowContent","t2","driverValue","validateCodeStringsForRun","_x3","_validateCodeStringsForRun","_callee3","_iterator4","_step4","_i3","_arr3","_i4","_arr4","_code2","_iterator5","_step5","_codeString3","_codeMatch2","_codeType2","_rowMatches2","_iterator6","_step6","_codeString4","_context3","ownKeys","getOwnPropertySymbols","_objectSpread","_defineProperty","getOwnPropertyDescriptors","defineProperties","toPrimitive","_toPrimitive","_toPropertyKey","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","populateCodeCollection","inputText","codeCollection","paramsString","matchAll","rowNum","rowValue","paramName","paramValue","runCodes","_runCodes","_callee4","currentWorksheetName","assumptionTabs","_loop","finalResult","_context5","processedCodes","createdTabs","tabName","_context4","label1","Label1","Excel","_ref3","sheets","existingSheet","financialsSheet","newSheet","sourceSheetName","sourceCalcsWS","usedRange","lastColIndex","lastColLetter","linkRangeAddress","linkRange","cellValue","colLetter","cellAddress","formula","headerFormatRangeAddress","workbook","worksheets","load","sync","items","find","sheet","getItem","position","copy","warn","getRange","clear","ClearApplyTo","all","getUsedRange","columnCount","columnIndexToLetter","formulas","format","font","color","tabColor","worksheet","_x26","codeIndex","_ref4","codesWS","currentWS","lastUsedRow","pasteRow","firstRow","lastRow","columnD","row","currentWorksheet","rowCount","getLastRow","rowIndex","_ref5","_callee2","sourceRange","_context2","copyFrom","RangeCopyType","_x28","driverAndAssumptionInputs","_x27","tab","_x2","_x4","_driverAndAssumptionInputs","_callee10","calcsPasteRow","worksheetName","_context11","_ref7","_callee7","_context8","_x30","_ref8","_callee8","lastRowRange","_context9","_x31","_ref9","_callee9","determinedLastRow","TARGET_COL","processStartRow","processEndRow","formulaRangeAddress","formulaRange","targetColIndex","formulasUpdated","origFormulas","newFormulas","rowFormulas","cellRefRegex","originalFormula","columnSequence","codeValue","searchRow","searchRange","searchRangeAddress","checkRow","isGreen","cellB","targetRow","driverParam","labelParam","currentCheckRowForInserts","rowParam","rowItems","numNewRows","baseRowForThisG","insertStartAddress","sourceRowNum","targetRowNum","sourceRowRange","targetRowRange","yy","currentRowNum","splitArray","x","valueToWrite","cellToWrite","numValue","_context10","columnLetterToIndex","col","fill","financialsdriver","insert","InsertShiftDirection","down","formats","Number","_x32","getLastUsedRow","_x5","_x6","_getLastUsedRow","_callee11","columnLetter","fullColumn","lastCell","lastRowIndex","_context12","getLastCell","adjustDriversJS","_x7","_x8","_adjustDriversJS","_callee12","START_ROW","DRIVER_CODE_COL","LOOKUP_COL","driverCodeRangeAddress","lookupRangeAddress","driverCodeRange","lookupRange","driverCodeValues","lookupValues","lookupMap","outputValues","foundCount","notFoundCount","driverCode","currentRow","foundRow","targetAddress","targetRangeAddress","targetRange","_context13","Map","set","replaceIndirectsJS","_x9","_x10","_replaceIndirectsJS","_callee13","originalFormulas","referencesToLookup","formulaData","searchStartIndex","upperFormula","indirectStartIndex","parenStartIndex","parenEndIndex","argString","_step5$value","refString","data","_step6$value","_refString","_data","cellText","_i5","_formulaData","currentFormula","loopCount","MAX_LOOPS","_upperFormula","_indirectStartIndex","_parenStartIndex","_parenEndIndex","indString","_argString","directRef","_context14","index","range","rangeError","debugInfo","valueError","populateFinancialsJS","_x11","_x12","_x13","_populateFinancialsJS","_callee14","CALCS_FIRST_ROW","ASSUMPTION_CODE_COL","ASSUMPTION_LINK_COL_B","ASSUMPTION_LINK_COL_D","ASSUMPTION_MONTHS_START_COL","FINANCIALS_CODE_COLUMN","FINANCIALS_TARGET_COL_B","FINANCIALS_TARGET_COL_D","FINANCIALS_ANNUALS_START_COL","FINANCIALS_MONTHS_START_COL","ANNUALS_END_COL","MONTHS_END_COL","GREEN_COLOR","CURRENCY_FORMAT","_assumptionCodes$leng","assumptionCodeRange","financialsSearchCol","financialsUsedRange","financialsLastRow","fallbackRange","lastRowB","financialsCodeMap","financialsCodeRange","_i6","upperCode","tasks","assumptionCodes","_i7","_assumptionCodes$leng2","assumptionRow","linkFormulaB","linkFormulaD","linkFormulaMonths","_upperCode","_i8","_tasks","task","originalTargetRowsAsc","taskAdjustedRows","totalShift","_i9","_tasks2","_task","populateRow","cellD","cellAnnualsStart","cellMonthsStart","codePrefix","formulaJ","actualsRange","numCols","formulasArray","_i10","_tasks3","_task2","_populateRow","sourceAnnuals","destAnnuals","sourceMonths","destMonths","codeColRange","currentCodeValues","modifiedCodeValues","modifiedCount","_i11","originalValue","_context15","addressB","addressD","addressMonths","sort","uniqueRow","tasksAtThisRow","currentAdjustedRowForGroup","bold","italic","indentLevel","formulasR1C1","numberFormat","sumifsError","autoFill","AutoFillType","fillDefault","autofillError","t3","t4","processAssumptionTabs","_x15","_processAssumptionTabs","_callee18","assumptionTabNames","FINANCIALS_SHEET_NAME","AUTOFILL_START_COLUMN","_iterator7","_step7","_loop2","_context20","_context19","_ref11","_callee17","updatedLastRow","finalLastRow","fillRange","_context18","setColumnAFontWhite","applyIndexGrowthCurveJS","deleteGreenRows","_x34","_ref10","_callee16","finSheet","_context17","_x33","_x16","_x17","_x18","_deleteGreenRows","_callee19","startRow","rowsToDelete","cell","_iterator8","_step8","_rowNum","newLastRow","_context21","delete","DeleteShiftDirection","up","_x19","_x20","_x21","_setColumnAFontWhite","_callee20","_context22","fromCharCode","charCodeAt","floor","hideColumnsAndNavigate","_x22","_hideColumnsAndNavigate","_callee22","ACTUALS_START_COL","ACTUALS_END_COL","targetSheetNames","_context24","_ref12","_callee21","hideAttempted","actualsEndIndex","actualsEndMinusOneCol","_iterator9","_step9","sheetName","_iterator10","_step10","_sheetName","_worksheet","_iterator11","_step11","_sheetName2","_worksheet2","_context23","rowHidden","columnHidden","stringify","activate","select","t5","_x35","handleInsertWorksheetsFromBase64","_x23","_handleInsertWorksheetsFromBase","_callee26","base64String","sheetNames","_args28","_context28","_ref14","_callee25","_context27","insertWorksheetsFromBase64","_x37","_x24","_x25","_applyIndexGrowthCurveJS","_callee27","initialLastRow","BEGIN_MARKER","END_MARKER","DATA_COL","OUTPUT_COL_B","OUTPUT_COL_C","OUTPUT_COL_D","CHECK_COL_B","VALUE_COL_A","DRIVER_REF_COL","SUMIF_START_COL","SUMIF_END_COL","SUMPRODUCT_COL","MONTHS_START_COL","LIGHT_BLUE_COLOR","LIGHT_GREEN_COLOR","indexEndRow","indexRows","dataColRangeAddress","formatCheckStartRow","formatCheckEndRow","checkColorRange","_i12","_currentRow","newRowStart","newRowEnd","sourceBlockRange","outputDataBC","outputDataD","sourceValues","_i13","_indexRows","originalRow","rowIndexInBlock","valB","valC","sourceColCRange","sourceColARange","sourceValuesC","sourceValuesA","numSumifCols","sumifFormulas","_i14","_originalRow","_rowIndexInBlock","codeC","valueA","baseFormula","driverCell","driverRangeString","_i15","_originalRow2","dataRangeString","sumproductFormula","_i16","sourceRow","_targetRow","_i17","_indexRows2","_originalRow3","_context29","borders","border","style","contents","buildRowArrayString","valuesRow","formulasRow","formulaCols","_cols","colIndex","valueString","processCodeBlock","startDataRowIndex","endDataRowIndex","codeName","rangeStartRowExcel","blockString","rowArrayString","generateTabString","_generateTabString","_ref","finalResultString","sheetCodeBlocks","lastUsedRowInB","bottomCellInB","lastUsedCellInB","dynamicRangeAddress","loadedRowCount","hasDataInD","manualRowCount","_r","currentBlockStartDataRow","currentBlockCodeName","_r2","dValue","tabLine","getRangeEdge","KeyboardDirection","OfficeExtension","INTERNAL_API_KEYS","performance","now","OPENAI_API_KEY","PINECONE_API_KEY","srcPaths","PINECONE_INDEXES","codes","apiEndpoint","call2trainingdata","call2context","call1context","GPT41","saveConversationHistory","history","localStorage","setItem","callOpenAI","_callOpenAI","messages","model","temperature","errorData","_args3","headers","statusText","choices","content","createEmbedding","_createEmbedding","input","embedding","loadPromptFromFile","_loadPromptFromFile","_callee5","promptKey","paths","path","getSystemPromptFromFile","_getSystemPromptFromFile","_callee6","prompt","_context6","processPrompt","_processPrompt","userInput","systemPrompt","_ref$history","responseContent","parsed","_context7","role","structureDatabasequeries","_structureDatabasequeries","clientprompt","systemStructurePrompt","queryStrings","results","queryString","queryResults","queryVectorDB","queryPrompt","similarityThreshold","indexName","numResults","query","trainingData","call2Context","call1Context","codeOptions","t6","t7","_queryVectorDB","_ref2","_ref2$indexName","_ref2$numResults","_ref2$similarityThres","indexConfig","errorText","matches","cleanMatches","vector","topK","includeMetadata","namespace","score","extractTextFromJson","jsonInput","_jsonData$metadata","jsonData","metadata","_item$metadata","safeJsonForPrompt","readable","_item$metadata2","toFixed","handleFollowUpConversation","_handleFollowUpConversation","currentHistory","mainPromptText","trainingdataCall2","followUpPrompt","responseArray","updatedHistory","savePromptAnalysis","saveTrainingData","handleInitialConversation","_handleInitialConversation","initialCallPrompt","outputArray","initialHistory","handleConversation","_handleConversation","mainPrompt","validationSystemPrompt","validationMainPrompt","validationResults","analysisData","clientRequest","cleanText","validationCorrection","_x14","_validationCorrection","initialResponse","promptAnalysisData","responseString","validationResultsString","correctionPrompt","correctedResponseArray","correctionOutputPath","correctedResponseString","loadedCodeStrings","codeDatabase","lastEditorCursorPosition","loadCodeDatabase","_loadCodeDatabase","lines","showError","initializeAPIKeys","_initializeAPIKeys","configResponse","configText","openaiKeyMatch","pineconeKeyMatch","keysFound","configApiKeys","conversationHistory","showMessage","messageDiv","createElement","padding","margin","borderRadius","textContent","appBody","getElementById","insertBefore","firstChild","remove","errorDiv","setButtonLoading","isLoading","sendButton","loadingAnimation","disabled","newDisplay","display","lastResponse","isResponse","writeToExcel","_writeToExcel","startCol","codeStrings","fullText","getSelectedRange","columnIndex","getRangeByIndexes","appendMessage","isUser","chatLog","welcomeMessage","className","messageContent","appendChild","scrollTop","scrollHeight","handleSend","_handleSend","dbResults","plainTextResults","enhancedPrompt","conversationResult","resetChat","innerHTML","id","welcomeTitle","getTabBlocks","tabBlocks","tabRegex","indices","exec","tag","start","end","blockText","insertSheetsAndRunCodes","_insertSheetsAndRunCodes","codesTextarea","codesToRun","previousCodes","allCodeContentToProcess","runResult","_runResult","financialsSheetExists","validationErrors","errorMsg","worksheetsResponse","worksheetsArrayBuffer","worksheetsUint8Array","worksheetsBinaryString","worksheetsBase64String","currentTabs","previousTabs","previousTabMap","hasAnyChanges","codeRegex","currentTab","currentTag","currentText","previousText","newTabCodes","currentCodes","previousCodesSet","tabHasChanges","codesToAddForThisTab","currentCode","_validationErrors","_errorMsg","codesResponse","codesArrayBuffer","codesUint8Array","codesBinaryString","_chunk","codesBase64String","collection","ErrorCodes","itemNotFound","application","calculationMode","CalculationMode","manual","arrayBuffer","Uint8Array","btoa","block","automatic","insertResponseToEditor","_insertResponseToEditor","responseText","codeStringsToInsert","insertionPoint","tabPrefix","defaultTabString","addDefaultTab","textBefore","textAfter","textToInsert","newCursorPos","focus","setSelectionRange","Office","onReady","info","host","HostType","button","onclick","writeButton","resetButton","generateTabStringButton","editParamsButton","paramsModal","paramsModalForm","closeModalButton","querySelector","applyParamsButton","cancelParamsButton","modalFindInput","modalReplaceInput","modalReplaceAllButton","modalSearchStatus","currentCodeStringRange","currentCodeStringType","modalSearchableElements","resetModalSearchState","querySelectorAll","updateModalSearchStatus","hideParamsModal","codeInfo","cursorPos","textBeforeCursor","textAfterCursor","lastOpenBracket","lastIndexOf","firstCloseBracketAfter","findCodeStringAroundCursor","selectionStart","_parseCodeParameters","paramRegex","lastIndex","parseCodeParameters","paramEntryDiv","inputElement","htmlFor","isLongValue","isLIParam","rows","dataset","paramKey","isOriginalLi","liContainer","originalLiKey","addButton","targetLiKey","event","sourceInput","newValueContainer","newInput","cloneNode","isAddedLi","removeButton","target","parentNode","populateParamsModal","paramValues","isOriginalLI","isAddedLI","addedInput","originalKey","updatedParams","finalValue","newCodeStringContent","newCodeString","searchTerm","replaceTerm","replacementsMade","element","currentValue","escapedSearchTerm","newValue","RegExp","setAPIKeys","parsedHistory","loadConversationHistory","storedCodes","updateCursorPosition","addEventListener","insertToEditorButton","dynamicSuggestionsContainer","backgroundColor","maxHeight","overflowY","zIndex","nextSibling","updateSuggestionPosition","rect","getBoundingClientRect","width","offsetWidth","top","bottom","scrollY","left","scrollX","highlightedSuggestionIndex","currentSuggestions","updateHighlight","newIndex","suggestionItems","classList","scrollIntoView","oninput","isTrusted","cursorPosition","isInsideBrackets","searchStart","char","trimmedSearchTerm","suggestions","suggestionDiv","codeToAdd","insertionPosition","wasAdjusted","nextCloseBracket","nextNumbers","maxNumbers","regex","numberStr","number","parseInt","getMaxDriverNumbers","rowPart","existingNumberStr","pipePart","newNumber","replacement","textAfterInsertion","textBeforeFinal","tempSearchStart","searchTermToRemove","firstNewlineIndexInSuffix","remainderOfOriginalLine","subsequentLines","newText","onmouseover","showSuggestionsForTerm","onkeydown","preventDefault","click","ctrlKey","altKey","metaKey","contains","activeElement","URL"],"sourceRoot":""}