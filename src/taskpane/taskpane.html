<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Projectify Task Pane</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- SheetJS -->
    <script type="text/javascript" src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Mammoth.js for Word document processing -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js"></script>
    
    <!-- Google Sign-In Library -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- PDF.js for PDF document processing -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>


    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"/>

    <!-- Modular CSS Structure -->
    <!-- 1. Variables and Design Tokens (must be first) -->
    <link href="styles/variables.css" rel="stylesheet" type="text/css" />
    
    <!-- 2. Reset and Base Styles -->
    <link href="styles/reset.css" rel="stylesheet" type="text/css" />
    <link href="styles/base.css" rel="stylesheet" type="text/css" />
    
    <!-- 3. Typography -->
    <link href="styles/typography.css" rel="stylesheet" type="text/css" />
    
    <!-- 4. Layout Utilities -->
    <link href="styles/layout.css" rel="stylesheet" type="text/css" />
    <link href="styles/utilities.css" rel="stylesheet" type="text/css" />
    
    <!-- 5. Components -->
    <link href="styles/components/buttons.css" rel="stylesheet" type="text/css" />
    <link href="styles/components/forms.css" rel="stylesheet" type="text/css" />
    <link href="styles/components/header-footer.css" rel="stylesheet" type="text/css" />
    <link href="styles/components/slide-menu.css" rel="stylesheet" type="text/css" />
    <link href="styles/components/voice-input.css" rel="stylesheet" type="text/css" />
    <link href="styles/components/loading-animation.css" rel="stylesheet" type="text/css" />
    <link href="styles/modals.css" rel="stylesheet" type="text/css" />
    
    <!-- 6. View-Specific Styles (most specific, loaded last) -->

    <link href="styles/views/login.css" rel="stylesheet" type="text/css" />
    <link href="styles/views/authentication.css" rel="stylesheet" type="text/css" />
    <link href="styles/client-mode.css" rel="stylesheet" type="text/css" />
    <link href="styles/developer-mode.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-Fabric" dir="ltr">
    <div id="sideload-msg" class="ms-Rule ms-font-xl">
        <p>Please <a target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/sideload-office-add-ins-for-testing" rel="noopener">sideload</a> your add-in to see app body.</p>
    </div>



    <!-- Authentication View (shown by default, JavaScript will redirect authenticated users) -->
    <div id="authentication-view" class="ms-welcome__main" style="display: flex; justify-content: center; align-items: center; flex-direction: column; height: 100vh;">
        <div class="auth-container">

            
            <div class="auth-content">
                <div class="auth-brand">
                    <img src="../../assets/logo-filled.png" alt="EBITDAI" class="auth-logo" style="width: 64px; height: 64px; margin: 0 auto 16px;">
                    <h2 class="auth-subtitle">AI-Powered Financial Modeling for Excel</h2>
                    <p class="auth-description">Build comprehensive 3-statement models, DCF analyses, and LBO models in minutes instead of hours.</p>
                </div>
                
                <div class="auth-actions">
                    <button id="google-signin-button" class="google-signin-btn">
                        <div class="google-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24">
                                <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                            </svg>
                        </div>
                        <span>Get started by signing in with Google</span>
                    </button>
                    

                </div>
                
                <div class="auth-terms">
                    <p>By signing in, you agree to our <a href="https://ebitdai.co/terms" class="auth-link">Terms of Service</a> and <a href="https://ebitdai.co/privacy" class="auth-link">Privacy Policy</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Subscription Welcome View (shown when user has 0 credits) -->
    <div id="subscription-welcome-view" class="ms-welcome__main" style="display: none; justify-content: center; align-items: center; flex-direction: column; height: 100vh;">
        <div class="auth-container">
            <div class="auth-content">
                <div class="auth-brand">
                    <img src="../../assets/logo-filled.png" alt="EBITDAI" class="auth-logo" style="width: 64px; height: 64px; margin: 0 auto 16px;">
                    <h1 class="auth-title" style="font-size: 28px; font-weight: 600; margin-bottom: 12px;">Welcome to EBITDAI!</h1>
                    <p class="auth-description" style="font-size: 18px; margin-bottom: 24px;">To continue, please choose a subscription to begin your free trial at <a href="https://ebitdai.co/credits" target="_blank" class="auth-link" style="color: #0066cc; text-decoration: underline;">ebitdai.co/credits</a></p>
                </div>
                
                <div class="subscription-benefits" style="margin: 32px 0; text-align: left;">
                    <h3 style="font-size: 20px; margin-bottom: 16px; font-weight: 600;">What you get with EBITDAI:</h3>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                            <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right: 12px; flex-shrink: 0; margin-top: 2px;">
                                <path fill="#34A853" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <span>Build comprehensive 3-statement financial models in minutes</span>
                        </li>
                        <li style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                            <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right: 12px; flex-shrink: 0; margin-top: 2px;">
                                <path fill="#34A853" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <span>Generate DCF analyses and LBO models instantly</span>
                        </li>
                        <li style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                            <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right: 12px; flex-shrink: 0; margin-top: 2px;">
                                <path fill="#34A853" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <span>Access to all AI-powered financial modeling tools</span>
                        </li>
                        <li style="margin-bottom: 12px; display: flex; align-items: flex-start;">
                            <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right: 12px; flex-shrink: 0; margin-top: 2px;">
                                <path fill="#34A853" d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                            <span>Free trial credits to explore all features</span>
                        </li>
                    </ul>
                </div>
                
                <div class="auth-actions">
                    <a href="https://ebitdai.co/credits" target="_blank" class="ms-Button ms-Button--primary" style="width: 100%; padding: 12px 24px; font-size: 16px; text-decoration: none; display: inline-block; text-align: center;">
                        <span class="ms-Button-label">Choose Your Plan</span>
                    </a>
                    
                    <button id="subscription-refresh-credits" class="ms-Button ms-Button--hero" style="width: 100%; margin-top: 12px; padding: 12px 24px; font-size: 16px;">
                        <span class="ms-Button-icon" style="margin-right: 8px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                        </span>
                        <span class="ms-Button-label">Refresh Credits</span>
                    </button>
                    
                    <button id="subscription-sign-out" class="ms-Button" style="width: 100%; margin-top: 12px; padding: 10px 24px;">
                        <span class="ms-Button-label">Sign Out</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <main id="app-body" class="ms-welcome__main" style="display: none;">
        <button id="back-to-client-dev-button" class="ms-Button back-to-menu-button">
            <span class="ms-Button-label">← Back to Client Mode</span>
        </button>
        


        
        <div class="container">
            <!-- Chat Interface -->
            <div id="chat-log" class="chat-log">
                <div id="welcome-message" class="welcome-message">
                    <!-- Welcome message removed for dev mode -->
                </div>
            </div>
            <div class="input-area">
                <div class="dev-input-bar" id="dev-input-bar">
                    <!-- Normal Input Mode -->
                    <div id="normal-input-mode-dev" class="input-mode">
                        <div class="left-controls">
                            <input type="file" id="file-input-dev" accept=".xlsx,.xls,.xlsm,.csv,.doc,.docx,.pdf,.txt" multiple style="display: none;">
                            <button id="attach-file-dev" class="ms-Button ms-Button--icon attachment-button" title="Attach Excel, CSV, Word, PDF, or Text file">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="plus-icon">
                                    <path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                </svg>
                            </button>
                        </div>
                        <textarea id="user-input" placeholder="Enter your request here..." rows="1"></textarea>
                        <div class="right-controls">
                            <button id="voice-input-dev" class="ms-Button ms-Button--icon voice-button" title="Voice input">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="microphone-icon">
                                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" fill="currentColor"/>
                                    <path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    <path d="M12 19v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 23h8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button id="send" class="ms-Button ms-Button--primary">
                                <span class="ms-Button-label">Send</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Voice Recording Mode -->
                    <div id="voice-recording-mode-dev" class="input-mode" style="display: none;">
                        <div class="voice-waveform-container">
                            <canvas id="voice-waveform-dev" class="voice-waveform"></canvas>
                            <div id="voice-recording-timer-dev" class="voice-recording-timer">00:00</div>
                        </div>
                        <div class="voice-recording-controls">
                            <button id="cancel-voice-recording-dev" class="ms-Button ms-Button--icon voice-control-button" title="Cancel recording">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="cancel-icon">
                                    <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button id="accept-voice-recording-dev" class="ms-Button ms-Button--icon voice-control-button" title="Send for transcription">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="check-icon">
                                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Transcription Loading Mode -->
                    <div id="transcription-loading-mode-dev" class="input-mode" style="display: none;">
                        <div class="transcription-loading-content">
                            <div class="transcription-spinner"></div>
                            <span class="transcription-loading-text">Transcribing...</span>
                        </div>
                    </div>
                </div>
                
                <!-- Attached Files Container for Developer Mode -->
                <div id="attached-files-container-dev" class="attached-files-container" style="display: none;">
                    <div class="attached-files-header">
                        <span class="attached-files-count-dev">0 files attached</span>
                        <button id="clear-all-attachments-dev" class="clear-all-button" title="Clear all attachments">Clear all</button>
                    </div>
                    <div id="attached-files-list-dev" class="attached-files-list">
                        <!-- File items will be dynamically added here -->
                    </div>
                </div>
                
                <div id="loading-animation" class="loading-animation"></div>
                <button id="write-to-excel" class="ms-Button">
                    <span class="ms-Button-label">Write Response to Excel</span>
                </button>
                <button id="insert-to-editor" class="ms-Button">
                    <span class="ms-Button-label">Insert to Editor</span>
                </button>
                <button id="reset-chat" class="ms-Button">
                    <span class="ms-Button-label">Reset Chat</span>
                </button>
                <button id="add-to-training-queue" class="ms-Button">
                    <span class="ms-Button-label">Add to Training Data Queue</span>
                </button>
                <button id="clear-training-data-que-button" class="ms-Button">
                    <span class="ms-Button-label">Clear Training Data Queue</span>
                </button>
                <button id="attach-actuals-button" class="ms-Button">
                    <span class="ms-Button-label">Attach Actuals</span>
                </button>
            </div>

            <!-- Code Area -->
            <div class="code-area">
                <div class="code-header">
                    <h2>Codes</h2>
                    <button id="fullscreen-toggle" class="fullscreen-toggle" title="Toggle fullscreen">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                    </button>
                </div>
                <!-- >>> REMOVED: Main search and replace UI container <<< -->
                <!--
                <div class="search-replace-container">
                    <input type="text" id="search-input" placeholder="Search Codes">
                    <input type="text" id="replace-input" placeholder="Replace With">
                    <button id="find-next-button" class="ms-Button">
                        <span class="ms-Button-label">Find Next</span>
                    </button>
                    <button id="replace-button" class="ms-Button">
                        <span class="ms-Button-label">Replace</span>
                    </button>
                    <button id="replace-all-button" class="ms-Button">
                        <span class="ms-Button-label">Replace All</span>
                    </button>
                    <div class="search-options">
                        <input type="checkbox" id="search-selection-only">
                        <label for="search-selection-only">Selection Only</label>
                    </div>
                    <button id="clear-search-button" class="ms-Button">
                        <span class="ms-Button-label">Clear</span>
                    </button>
                    <span id="search-status" class="search-status"></span>
                </div>
                -->
                <textarea id="codes-textarea" rows="15" placeholder="Code strings will appear here after generation or can be pasted..."></textarea>
                <div id="dynamic-suggestions-container" class="code-suggestions"></div>
                <div class="code-area-buttons">
                    <button id="edit-code-params-button" class="ms-Button">
                        <span class="ms-Button-label">Edit Params</span>
                    </button>
                    <button id="insert-and-run" class="ms-Button ms-Button--primary">
                        <span class="ms-Button-label">Run Codes</span>
                    </button>
                    <button id="generate-tab-string-button" class="ms-Button">
                        <span class="ms-Button-label">Generate Tab Index</span>
                    </button>
                    <button id="ai-editor-button" class="ms-Button">
                        <span class="ms-Button-label">🤖 AI Editor</span>
                    </button>
                    <button id="restore-backup-button" class="ms-Button" style="display: none;">
                        <span class="ms-Button-label">↶ Restore Backup</span>
                    </button>
                </div>
            </div>

            <!-- Code Parameters Modal -->
            <div id="code-params-modal" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>Edit Code Parameters</h2>
                    <div class="modal-find-replace">
                        <input type="text" id="modal-find-input" placeholder="Find in Params">
                        <input type="text" id="modal-replace-input" placeholder="Replace With">
                        <button id="modal-replace-all-button" class="ms-Button">Replace All</button>
                        <span id="modal-search-status"></span>
                    </div>
                    <form id="code-params-modal-form">
                        <!-- Parameters will be populated here by JS -->
                    </form>
                    <div class="modal-actions">
                        <button id="apply-code-params-button" class="ms-Button ms-Button--primary">Apply</button>
                        <button id="cancel-code-params-button" class="ms-Button">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Training Data Modal -->
            <div id="training-data-modal" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>Edit Training Data</h2>
                    <div class="modal-find-replace">
                        <input type="text" id="training-find-input" placeholder="Find in Training Data">
                        <input type="text" id="training-replace-input" placeholder="Replace With">
                        <button id="training-replace-all-button" class="ms-Button">Replace All</button>
                        <span id="training-search-status"></span>
                    </div>
                    <div class="training-data-form">
                        <div class="training-field">
                            <label for="training-user-input">Client Message:</label>
                            <textarea id="training-user-input" rows="4" placeholder="Enter the client's original message... (Ctrl+V or right-click to paste)"></textarea>
                            <small style="color: #666; font-size: 12px; margin-top: 5px; display: block;">
                                Tip: You can paste text using Ctrl+V (Windows) or Cmd+V (Mac), or right-click and select Paste
                            </small>
                        </div>
                        <div class="training-field">
                            <label for="training-ai-response">AI Response:</label>
                            <textarea id="training-ai-response" rows="8" placeholder="Enter the AI's response... (Ctrl+V or right-click to paste)"></textarea>
                            <small style="color: #666; font-size: 12px; margin-top: 5px; display: block;">
                                Tip: You can paste text using Ctrl+V (Windows) or Cmd+V (Mac), or right-click and select Paste
                            </small>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button id="save-training-data-button" class="ms-Button ms-Button--primary">Add to Queue</button>
                        <button id="cancel-training-data-button" class="ms-Button">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- AI Editor Modal -->
            <div id="ai-editor-modal" class="modal">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>🤖 AI Editor</h2>
                    <div class="ai-editor-content">
                        <p>Describe the changes you want to make to the code. The AI will analyze the current code content and apply your requested modifications.</p>
                        <div class="ai-editor-input">
                            <label for="ai-editor-instructions">What changes would you like to make?</label>
                            <textarea id="ai-editor-instructions" rows="4" placeholder="Example: change all CONST-E codes to SPREAD-E, or add validation to all formulas, etc."></textarea>
                        </div>
                        <div class="ai-editor-options">
                            <label>
                                <input type="checkbox" id="ai-editor-backup-option" checked>
                                Keep backup of original content (enables restore button)
                            </label>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button id="ai-editor-execute-button" class="ms-Button ms-Button--primary">🤖 Apply Changes</button>
                        <button id="ai-editor-cancel-button" class="ms-Button">Cancel</button>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Client Mode View with Sidebar -->
    <div id="client-mode-view" class="ms-welcome__main" style="display: none;">
        <!-- Fixed Header -->
        <header class="fixed-header">
            <button id="hamburger-menu" class="hamburger-button" aria-label="Menu">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="hamburger-icon">
                    <path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            
            <div class="header-center">
                <h1 class="header-title" id="header-title-link" style="cursor: pointer;">
                    <span class="title-white">EBITD</span><span class="title-red">AI</span>
                </h1>
            </div>
            
            <div class="header-right">
                <label class="mode-label">Mode:</label>
                <select id="mode-dropdown" class="mode-dropdown">
                    <option value="one-shot">One-shot</option>
                    <option value="limited-guidance">Limited Guidance</option>
                    <option value="full-guidance">Full Guidance</option>
                </select>
                <button id="compose-new-message" class="compose-button" title="Start a new conversation">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="compose-icon">
                        <path d="M20.71 4.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83zM3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Profile Modal -->
        <div id="profile-modal" class="modal-overlay" style="display: none;">
            <div class="profile-modal-content">
                <div class="profile-modal-header">
                    <h2>Profile</h2>
                    <button class="modal-close-button" aria-label="Close">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                
                <div class="profile-modal-body">
                    <!-- User Info (moved from sidebar) -->
                    <div id="profile-user-info" class="profile-user-section">
                        <div class="profile-avatar-container">
                            <img id="profile-user-avatar" class="profile-avatar" alt="User Avatar">
                            <div id="profile-user-initials" class="profile-initials"></div>
                        </div>
                        
                        <div class="profile-details">
                            <div id="profile-user-name" class="profile-name">Loading...</div>
                            <div id="profile-user-email" class="profile-email">Loading...</div>
                        </div>
                    </div>
                    
                    <div class="profile-actions">
                        <button id="profile-sign-out-button" class="profile-sign-out-button">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="signout-icon">
                                <path d="M16 17l5-5-5-5M19.8 12H9M10 3H5a2 2 0 00-2 2v14a2 2 0 002 2h5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                            </svg>
                            <span>Sign Out</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide-out Menu -->
        <div id="slide-menu" class="slide-menu">
            <div class="slide-menu-header">
                <h2>Menu</h2>
                <button id="close-menu" class="close-menu-button" aria-label="Close menu">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            
            <nav class="slide-menu-nav">
                <button class="menu-item" data-action="chat">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu-icon">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    <span>Chat</span>
                </button>
                
                <button class="menu-item" data-action="plans">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu-icon">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14M22 4L12 14.01l-3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    <span>Plans</span>
                </button>
                
                <button class="menu-item" data-action="developer" style="display: none !important; visibility: hidden !important;">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu-icon">
                        <path d="M16 18l6-6-6-6M8 6l-6 6 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    <span>Developer Mode</span>
                </button>
                
                <button class="menu-item" data-action="account">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu-icon">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    <span>Account</span>
                </button>
                
                <div class="back-to-home">
                    <button class="menu-item" data-action="home">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu-icon">
                            <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                        <span>Close Menu</span>
                    </button>
                </div>
            </nav>
        </div>
        
        <!-- Account Modal -->
        <div id="account-modal" class="modal-overlay" style="display: none; position: fixed; inset: 0; z-index: 10002; background: rgba(0,0,0,0.25); align-items: center; justify-content: center;">
            <div class="modal-content account-modal-content">
                <div class="modal-header">
                    <h2>Account</h2>
                    <button class="modal-close-button" aria-label="Close modal">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="account-info">
                        <div class="user-avatar">
                            <span id="user-avatar-text-modal">U</span>
                        </div>
                        <div class="user-details">
                            <div id="user-email-modal" class="user-email">user@example.com</div>
                            <div class="user-status">Signed in</div>
                        </div>
                    </div>

                    <div class="account-stats">
                        <div class="account-stat">
                            <span class="stat-label">Credits</span>
                            <span id="user-credits-modal" class="stat-value">--</span>
                        </div>
                        <div class="account-stat">
                            <span class="stat-label">Subscription</span>
                            <span id="user-subscription-modal" class="stat-value">--</span>
                        </div>
                    </div>
                    
                    <button id="refresh-account-button" class="refresh-account-button">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="refresh-icon">
                            <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                        <span>Refresh</span>
                    </button>
                    
                    <button id="logout-button-modal" class="logout-button">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="logout-icon">
                            <path d="M16 17l5-5-5-5M19.8 12H9M10 3H5a2 2 0 00-2 2v14a2 2 0 002 2h5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        </svg>
                        <span>Sign Out</span>
                    </button>
                </div>
            </div>
        </div>



        <!-- Main Content Area -->
        <div class="main-content">
            <!-- Chat Container - Holds welcome screen OR chat messages -->
            <div id="client-chat-container">
                <!-- Welcome Screen - Shows instructions -->
                <div class="welcome-section">
                    <h2 class="welcome-title">What do you want to model?</h2>
                    <div class="welcome-steps">
                        <div class="step-item">
                            <span class="step-number">1</span>
                            <span class="step-text">Describe your revenue, pricing, expenses, financing, and other key assumptions.</span>
                        </div>
                        <div class="step-item">
                            <span class="step-number">2</span>
                            <span class="step-text">We'll create a professional Excel model for you</span>
                        </div>
                    </div>
                </div>

                <!-- Chat Messages - Hidden initially, shown when conversation starts -->
                <div id="chat-log-client">
                    <!-- Messages will be added here dynamically -->
                </div>
            </div>
                
            <!-- Input Area - Fixed at bottom above footer -->
            <div class="client-input-area-wrapper">
                <div class="chatgpt-input-bar">
                    <div class="input-mode">
                        <div class="left-controls">
                            <input type="file" id="file-input-client" accept=".xlsx,.xls,.xlsm,.csv,.doc,.docx,.pdf,.txt" multiple style="display: none;">
                            <button id="attach-file-client" class="attachment-button" title="Attach file">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="plus-icon">
                                    <path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                </svg>
                            </button>
                        </div>
                        <textarea id="user-input-client" placeholder="Describe your business" rows="1"></textarea>
                        <div class="right-controls">
                            <button id="voice-input-client" class="voice-button" title="Voice input">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="microphone-icon">
                                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" fill="currentColor"/>
                                    <path d="M19 10v2a7 7 0 0 1-14 0v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                    <path d="M12 19v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 23h8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button id="send-client" class="send-button">
                                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="send-icon">
                                    <path d="M12 6.5L17.5 12L16.09 13.41L13 10.33V17.5H11V10.33L7.91 13.41L6.5 12L12 6.5Z" fill="currentColor"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Voice Recording Mode -->
                <div id="voice-recording-mode" class="input-mode" style="display: none;">
                    <div class="voice-waveform-container">
                        <canvas id="voice-waveform" class="voice-waveform"></canvas>
                        <div id="voice-recording-timer" class="voice-recording-timer">00:00</div>
                    </div>
                    <div class="voice-recording-controls">
                       <button id="cancel-voice-recording" class="ms-Button ms-Button--icon voice-control-button" title="Cancel recording">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="cancel-icon">
                                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                         </button>
                        <button id="stop-voice-recording" class="ms-Button ms-Button--primary voice-stop-button" title="Stop recording">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="stop-icon">
                                <rect x="6" y="6" width="12" height="12" fill="currentColor"/>
                            </svg>
                            <span>Stop Recording</span>
                        </button>
                    </div>
                </div>
                
                <!-- Transcription Loading Mode -->
                <div id="transcription-loading-mode" class="input-mode" style="display: none;">
                    <div class="transcription-loading-content">
                        <div class="loading-spinner"></div>
                        <div class="transcription-loading-text">Transcribing your audio...</div>
                    </div>
                </div>
                
                <!-- Attached Files Container for Client Mode (animated) -->
                <div id="attached-files-container" class="attached-files-container" style="display: none;">
                    <div class="attached-files-header">
                        <span class="attached-files-count">0 files attached</span>
                        <button id="clear-all-attachments" class="clear-all-button" title="Clear all attachments">Clear all</button>
                    </div>
                    <div id="attached-files-list" class="attached-files-list">
                        <!-- File items will be dynamically added here -->
                    </div>
                </div>
                <div id="loading-animation-client" class="hidden"></div>
            </div>

                <!-- Subscription Panel -->
                <div id="subscription-panel" style="display: none;">
                    <div class="subscription-container">
                        <div class="subscription-header">
                            <h2 class="subscription-title">Choose Your Plan</h2>
                            <p class="subscription-description">Select the perfect plan for your financial modeling needs</p>
                        </div>

                        <div class="subscription-plans">
                            <!-- Starter Plan -->
                            <div class="plan-card">
                                <div class="plan-header">
                                    <h3 class="plan-name">Starter</h3>
                                    <div class="plan-price">
                                        <span class="price-amount">$29</span>
                                        <span class="price-period">/month</span>
                                    </div>
                                    <p class="plan-description">Perfect for individual analysts and small teams</p>
                                </div>
                                <div class="plan-content">
                                    <ul class="plan-features">
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>5 AI model generations per month</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Basic financial templates</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Excel integration</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Email support</span>
                                        </li>
                                    </ul>
                                    <button class="plan-button">Get Started</button>
                                </div>
                            </div>

                            <!-- Professional Plan -->
                            <div class="plan-card popular">
                                <div class="popular-badge">Most Popular</div>
                                <div class="plan-header">
                                    <h3 class="plan-name">Professional</h3>
                                    <div class="plan-price">
                                        <span class="price-amount">$79</span>
                                        <span class="price-period">/month</span>
                                    </div>
                                    <p class="plan-description">For growing teams and complex models</p>
                                </div>
                                <div class="plan-content">
                                    <ul class="plan-features">
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>25 AI model generations per month</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Advanced financial templates</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Excel & Google Sheets integration</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Priority support</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Custom model training</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Team collaboration</span>
                                        </li>
                                    </ul>
                                    <button class="plan-button popular-button">Get Started</button>
                                </div>
                            </div>

                            <!-- Unlimited Plan -->
                            <div class="plan-card">
                                <div class="plan-header">
                                    <h3 class="plan-name">Unlimited</h3>
                                    <div class="plan-price">
                                        <span class="price-amount">$199</span>
                                        <span class="price-period">/month</span>
                                    </div>
                                    <p class="plan-description">For large organizations with advanced needs</p>
                                </div>
                                <div class="plan-content">
                                    <ul class="plan-features">
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Unlimited AI model generations</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>All financial templates</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Full platform integration</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>24/7 dedicated support</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Custom model training</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>Advanced team management</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>API access</span>
                                        </li>
                                        <li class="feature-item">
                                            <svg class="feature-check" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z" fill="currentColor"/>
                                            </svg>
                                            <span>On-premise deployment</span>
                                        </li>
                                    </ul>
                                    
                                    <div class="api-key-section">
                                        <label for="claude-api-key" class="api-key-label">Claude API Key (Optional)</label>
                                        <input type="password" id="claude-api-key" class="api-key-input" placeholder="Enter your Claude API key...">
                                        <p class="api-key-note">Use your own Claude API key for enhanced performance and unlimited usage</p>
                                    </div>
                                    
                                    <button class="plan-button">Get Started</button>
                                </div>
                            </div>
                        </div>

                        <div class="subscription-footer">
                            <p>All plans include a 14-day free trial. No credit card required.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Fixed Footer -->
        <footer class="fixed-footer">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="https://ebitdai.co/terms" class="footer-link" id="terms-link" target="_blank">Terms of Service</a>
                    <span class="footer-separator">•</span>
                    <a href="https://ebitdai.co/privacy" class="footer-link" id="privacy-link" target="_blank">Privacy Policy</a>
                </div>
                
                <!-- Removed footer center subscription display -->
                
                <div class="footer-right">
                    <!-- Sign-in button removed -->
                </div>
            </div>
        </footer>
    </div>

    <!-- JavaScript Dependencies -->
    <!-- Webpack will automatically inject the bundled JavaScript files here -->

</body>

</html>